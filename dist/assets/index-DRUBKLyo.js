import{j as e,u as le,a as H,b as W,Q as Vs,c as Ks}from"./query-vendor-pbB2OxY9.js";import{a as _s,r as N,u as ye,b as zs,L as Qs,c as Pt,R as Ie,B as Ws,d as Hs,e as ae,N as Js}from"./react-vendor-Bc501dib.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}})();var vt={},Mt=_s;vt.createRoot=Mt.createRoot,vt.hydrateRoot=Mt.hydrateRoot;function ss(t,s){return function(){return t.apply(s,arguments)}}const{toString:Gs}=Object.prototype,{getPrototypeOf:Et}=Object,{iterator:lt,toStringTag:as}=Symbol,ot=(t=>s=>{const a=Gs.call(s);return t[a]||(t[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Se=t=>(t=t.toLowerCase(),s=>ot(s)===t),it=t=>s=>typeof s===t,{isArray:Be}=Array,Te=it("undefined");function ze(t){return t!==null&&!Te(t)&&t.constructor!==null&&!Te(t.constructor)&&he(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const ns=Se("ArrayBuffer");function Ys(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&ns(t.buffer),s}const Xs=it("string"),he=it("function"),rs=it("number"),Qe=t=>t!==null&&typeof t=="object",Zs=t=>t===!0||t===!1,Ze=t=>{if(ot(t)!=="object")return!1;const s=Et(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(as in t)&&!(lt in t)},ea=t=>{if(!Qe(t)||ze(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},ta=Se("Date"),sa=Se("File"),aa=Se("Blob"),na=Se("FileList"),ra=t=>Qe(t)&&he(t.pipe),la=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||he(t.append)&&((s=ot(t))==="formdata"||s==="object"&&he(t.toString)&&t.toString()==="[object FormData]"))},oa=Se("URLSearchParams"),[ia,da,ca,ma]=["ReadableStream","Request","Response","Headers"].map(Se),ua=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function We(t,s,{allOwnKeys:a=!1}={}){if(t===null||typeof t>"u")return;let r,n;if(typeof t!="object"&&(t=[t]),Be(t))for(r=0,n=t.length;r<n;r++)s.call(null,t[r],r,t);else{if(ze(t))return;const l=a?Object.getOwnPropertyNames(t):Object.keys(t),o=l.length;let d;for(r=0;r<o;r++)d=l[r],s.call(null,t[d],d,t)}}function ls(t,s){if(ze(t))return null;s=s.toLowerCase();const a=Object.keys(t);let r=a.length,n;for(;r-- >0;)if(n=a[r],s===n.toLowerCase())return n;return null}const De=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,os=t=>!Te(t)&&t!==De;function wt(){const{caseless:t,skipUndefined:s}=os(this)&&this||{},a={},r=(n,l)=>{const o=t&&ls(a,l)||l;Ze(a[o])&&Ze(n)?a[o]=wt(a[o],n):Ze(n)?a[o]=wt({},n):Be(n)?a[o]=n.slice():(!s||!Te(n))&&(a[o]=n)};for(let n=0,l=arguments.length;n<l;n++)arguments[n]&&We(arguments[n],r);return a}const xa=(t,s,a,{allOwnKeys:r}={})=>(We(s,(n,l)=>{a&&he(n)?t[l]=ss(n,a):t[l]=n},{allOwnKeys:r}),t),pa=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),ga=(t,s,a,r)=>{t.prototype=Object.create(s.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),a&&Object.assign(t.prototype,a)},ha=(t,s,a,r)=>{let n,l,o;const d={};if(s=s||{},t==null)return s;do{for(n=Object.getOwnPropertyNames(t),l=n.length;l-- >0;)o=n[l],(!r||r(o,t,s))&&!d[o]&&(s[o]=t[o],d[o]=!0);t=a!==!1&&Et(t)}while(t&&(!a||a(t,s))&&t!==Object.prototype);return s},fa=(t,s,a)=>{t=String(t),(a===void 0||a>t.length)&&(a=t.length),a-=s.length;const r=t.indexOf(s,a);return r!==-1&&r===a},ya=t=>{if(!t)return null;if(Be(t))return t;let s=t.length;if(!rs(s))return null;const a=new Array(s);for(;s-- >0;)a[s]=t[s];return a},ba=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&Et(Uint8Array)),ja=(t,s)=>{const r=(t&&t[lt]).call(t);let n;for(;(n=r.next())&&!n.done;){const l=n.value;s.call(t,l[0],l[1])}},Na=(t,s)=>{let a;const r=[];for(;(a=t.exec(s))!==null;)r.push(a);return r},va=Se("HTMLFormElement"),wa=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,r,n){return r.toUpperCase()+n}),qt=(({hasOwnProperty:t})=>(s,a)=>t.call(s,a))(Object.prototype),ka=Se("RegExp"),is=(t,s)=>{const a=Object.getOwnPropertyDescriptors(t),r={};We(a,(n,l)=>{let o;(o=s(n,l,t))!==!1&&(r[l]=o||n)}),Object.defineProperties(t,r)},Sa=t=>{is(t,(s,a)=>{if(he(t)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const r=t[a];if(he(r)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},Ca=(t,s)=>{const a={},r=n=>{n.forEach(l=>{a[l]=!0})};return Be(t)?r(t):r(String(t).split(s)),a},Aa=()=>{},Pa=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function Ea(t){return!!(t&&he(t.append)&&t[as]==="FormData"&&t[lt])}const Da=t=>{const s=new Array(10),a=(r,n)=>{if(Qe(r)){if(s.indexOf(r)>=0)return;if(ze(r))return r;if(!("toJSON"in r)){s[n]=r;const l=Be(r)?[]:{};return We(r,(o,d)=>{const m=a(o,n+1);!Te(m)&&(l[d]=m)}),s[n]=void 0,l}}return r};return a(t,0)},Ra=Se("AsyncFunction"),Fa=t=>t&&(Qe(t)||he(t))&&he(t.then)&&he(t.catch),ds=((t,s)=>t?setImmediate:s?((a,r)=>(De.addEventListener("message",({source:n,data:l})=>{n===De&&l===a&&r.length&&r.shift()()},!1),n=>{r.push(n),De.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",he(De.postMessage)),Ia=typeof queueMicrotask<"u"?queueMicrotask.bind(De):typeof process<"u"&&process.nextTick||ds,Oa=t=>t!=null&&he(t[lt]),S={isArray:Be,isArrayBuffer:ns,isBuffer:ze,isFormData:la,isArrayBufferView:Ys,isString:Xs,isNumber:rs,isBoolean:Zs,isObject:Qe,isPlainObject:Ze,isEmptyObject:ea,isReadableStream:ia,isRequest:da,isResponse:ca,isHeaders:ma,isUndefined:Te,isDate:ta,isFile:sa,isBlob:aa,isRegExp:ka,isFunction:he,isStream:ra,isURLSearchParams:oa,isTypedArray:ba,isFileList:na,forEach:We,merge:wt,extend:xa,trim:ua,stripBOM:pa,inherits:ga,toFlatObject:ha,kindOf:ot,kindOfTest:Se,endsWith:fa,toArray:ya,forEachEntry:ja,matchAll:Na,isHTMLForm:va,hasOwnProperty:qt,hasOwnProp:qt,reduceDescriptors:is,freezeMethods:Sa,toObjectSet:Ca,toCamelCase:wa,noop:Aa,toFiniteNumber:Pa,findKey:ls,global:De,isContextDefined:os,isSpecCompliantForm:Ea,toJSONObject:Da,isAsyncFn:Ra,isThenable:Fa,setImmediate:ds,asap:Ia,isIterable:Oa};function X(t,s,a,r,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),a&&(this.config=a),r&&(this.request=r),n&&(this.response=n,this.status=n.status?n.status:null)}S.inherits(X,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:S.toJSONObject(this.config),code:this.code,status:this.status}}});const cs=X.prototype,ms={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{ms[t]={value:t}});Object.defineProperties(X,ms);Object.defineProperty(cs,"isAxiosError",{value:!0});X.from=(t,s,a,r,n,l)=>{const o=Object.create(cs);S.toFlatObject(t,o,function(p){return p!==Error.prototype},f=>f!=="isAxiosError");const d=t&&t.message?t.message:"Error",m=s==null&&t?t.code:s;return X.call(o,d,m,a,r,n),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",l&&Object.assign(o,l),o};const Ma=null;function kt(t){return S.isPlainObject(t)||S.isArray(t)}function us(t){return S.endsWith(t,"[]")?t.slice(0,-2):t}function Lt(t,s,a){return t?t.concat(s).map(function(n,l){return n=us(n),!a&&l?"["+n+"]":n}).join(a?".":""):s}function qa(t){return S.isArray(t)&&!t.some(kt)}const La=S.toFlatObject(S,{},null,function(s){return/^is[A-Z]/.test(s)});function dt(t,s,a){if(!S.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,a=S.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(C,E){return!S.isUndefined(E[C])});const r=a.metaTokens,n=a.visitor||p,l=a.dots,o=a.indexes,m=(a.Blob||typeof Blob<"u"&&Blob)&&S.isSpecCompliantForm(s);if(!S.isFunction(n))throw new TypeError("visitor must be a function");function f(i){if(i===null)return"";if(S.isDate(i))return i.toISOString();if(S.isBoolean(i))return i.toString();if(!m&&S.isBlob(i))throw new X("Blob is not supported. Use a Buffer instead.");return S.isArrayBuffer(i)||S.isTypedArray(i)?m&&typeof Blob=="function"?new Blob([i]):Buffer.from(i):i}function p(i,C,E){let h=i;if(i&&!E&&typeof i=="object"){if(S.endsWith(C,"{}"))C=r?C:C.slice(0,-2),i=JSON.stringify(i);else if(S.isArray(i)&&qa(i)||(S.isFileList(i)||S.endsWith(C,"[]"))&&(h=S.toArray(i)))return C=us(C),h.forEach(function(A,g){!(S.isUndefined(A)||A===null)&&s.append(o===!0?Lt([C],g,l):o===null?C:C+"[]",f(A))}),!1}return kt(i)?!0:(s.append(Lt(E,C,l),f(i)),!1)}const b=[],c=Object.assign(La,{defaultVisitor:p,convertValue:f,isVisitable:kt});function u(i,C){if(!S.isUndefined(i)){if(b.indexOf(i)!==-1)throw Error("Circular reference detected in "+C.join("."));b.push(i),S.forEach(i,function(h,k){(!(S.isUndefined(h)||h===null)&&n.call(s,h,S.isString(k)?k.trim():k,C,c))===!0&&u(h,C?C.concat(k):[k])}),b.pop()}}if(!S.isObject(t))throw new TypeError("data must be an object");return u(t),s}function Tt(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return s[r]})}function Dt(t,s){this._pairs=[],t&&dt(t,this,s)}const xs=Dt.prototype;xs.append=function(s,a){this._pairs.push([s,a])};xs.toString=function(s){const a=s?function(r){return s.call(this,r,Tt)}:Tt;return this._pairs.map(function(n){return a(n[0])+"="+a(n[1])},"").join("&")};function Ta(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ps(t,s,a){if(!s)return t;const r=a&&a.encode||Ta;S.isFunction(a)&&(a={serialize:a});const n=a&&a.serialize;let l;if(n?l=n(s,a):l=S.isURLSearchParams(s)?s.toString():new Dt(s,a).toString(r),l){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class Bt{constructor(){this.handlers=[]}use(s,a,r){return this.handlers.push({fulfilled:s,rejected:a,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){S.forEach(this.handlers,function(r){r!==null&&s(r)})}}const gs={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ba=typeof URLSearchParams<"u"?URLSearchParams:Dt,Ua=typeof FormData<"u"?FormData:null,$a=typeof Blob<"u"?Blob:null,Va={isBrowser:!0,classes:{URLSearchParams:Ba,FormData:Ua,Blob:$a},protocols:["http","https","file","blob","url","data"]},Rt=typeof window<"u"&&typeof document<"u",St=typeof navigator=="object"&&navigator||void 0,Ka=Rt&&(!St||["ReactNative","NativeScript","NS"].indexOf(St.product)<0),_a=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",za=Rt&&window.location.href||"http://localhost",Qa=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Rt,hasStandardBrowserEnv:Ka,hasStandardBrowserWebWorkerEnv:_a,navigator:St,origin:za},Symbol.toStringTag,{value:"Module"})),pe={...Qa,...Va};function Wa(t,s){return dt(t,new pe.classes.URLSearchParams,{visitor:function(a,r,n,l){return pe.isNode&&S.isBuffer(a)?(this.append(r,a.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...s})}function Ha(t){return S.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function Ja(t){const s={},a=Object.keys(t);let r;const n=a.length;let l;for(r=0;r<n;r++)l=a[r],s[l]=t[l];return s}function hs(t){function s(a,r,n,l){let o=a[l++];if(o==="__proto__")return!0;const d=Number.isFinite(+o),m=l>=a.length;return o=!o&&S.isArray(n)?n.length:o,m?(S.hasOwnProp(n,o)?n[o]=[n[o],r]:n[o]=r,!d):((!n[o]||!S.isObject(n[o]))&&(n[o]=[]),s(a,r,n[o],l)&&S.isArray(n[o])&&(n[o]=Ja(n[o])),!d)}if(S.isFormData(t)&&S.isFunction(t.entries)){const a={};return S.forEachEntry(t,(r,n)=>{s(Ha(r),n,a,0)}),a}return null}function Ga(t,s,a){if(S.isString(t))try{return(s||JSON.parse)(t),S.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(a||JSON.stringify)(t)}const He={transitional:gs,adapter:["xhr","http","fetch"],transformRequest:[function(s,a){const r=a.getContentType()||"",n=r.indexOf("application/json")>-1,l=S.isObject(s);if(l&&S.isHTMLForm(s)&&(s=new FormData(s)),S.isFormData(s))return n?JSON.stringify(hs(s)):s;if(S.isArrayBuffer(s)||S.isBuffer(s)||S.isStream(s)||S.isFile(s)||S.isBlob(s)||S.isReadableStream(s))return s;if(S.isArrayBufferView(s))return s.buffer;if(S.isURLSearchParams(s))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let d;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Wa(s,this.formSerializer).toString();if((d=S.isFileList(s))||r.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return dt(d?{"files[]":s}:s,m&&new m,this.formSerializer)}}return l||n?(a.setContentType("application/json",!1),Ga(s)):s}],transformResponse:[function(s){const a=this.transitional||He.transitional,r=a&&a.forcedJSONParsing,n=this.responseType==="json";if(S.isResponse(s)||S.isReadableStream(s))return s;if(s&&S.isString(s)&&(r&&!this.responseType||n)){const o=!(a&&a.silentJSONParsing)&&n;try{return JSON.parse(s,this.parseReviver)}catch(d){if(o)throw d.name==="SyntaxError"?X.from(d,X.ERR_BAD_RESPONSE,this,null,this.response):d}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pe.classes.FormData,Blob:pe.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};S.forEach(["delete","get","head","post","put","patch"],t=>{He.headers[t]={}});const Ya=S.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Xa=t=>{const s={};let a,r,n;return t&&t.split(`
`).forEach(function(o){n=o.indexOf(":"),a=o.substring(0,n).trim().toLowerCase(),r=o.substring(n+1).trim(),!(!a||s[a]&&Ya[a])&&(a==="set-cookie"?s[a]?s[a].push(r):s[a]=[r]:s[a]=s[a]?s[a]+", "+r:r)}),s},Ut=Symbol("internals");function Ve(t){return t&&String(t).trim().toLowerCase()}function et(t){return t===!1||t==null?t:S.isArray(t)?t.map(et):String(t)}function Za(t){const s=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=a.exec(t);)s[r[1]]=r[2];return s}const en=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function xt(t,s,a,r,n){if(S.isFunction(r))return r.call(this,s,a);if(n&&(s=a),!!S.isString(s)){if(S.isString(r))return s.indexOf(r)!==-1;if(S.isRegExp(r))return r.test(s)}}function tn(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,a,r)=>a.toUpperCase()+r)}function sn(t,s){const a=S.toCamelCase(" "+s);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+a,{value:function(n,l,o){return this[r].call(this,s,n,l,o)},configurable:!0})})}let fe=class{constructor(s){s&&this.set(s)}set(s,a,r){const n=this;function l(d,m,f){const p=Ve(m);if(!p)throw new Error("header name must be a non-empty string");const b=S.findKey(n,p);(!b||n[b]===void 0||f===!0||f===void 0&&n[b]!==!1)&&(n[b||m]=et(d))}const o=(d,m)=>S.forEach(d,(f,p)=>l(f,p,m));if(S.isPlainObject(s)||s instanceof this.constructor)o(s,a);else if(S.isString(s)&&(s=s.trim())&&!en(s))o(Xa(s),a);else if(S.isObject(s)&&S.isIterable(s)){let d={},m,f;for(const p of s){if(!S.isArray(p))throw TypeError("Object iterator must return a key-value pair");d[f=p[0]]=(m=d[f])?S.isArray(m)?[...m,p[1]]:[m,p[1]]:p[1]}o(d,a)}else s!=null&&l(a,s,r);return this}get(s,a){if(s=Ve(s),s){const r=S.findKey(this,s);if(r){const n=this[r];if(!a)return n;if(a===!0)return Za(n);if(S.isFunction(a))return a.call(this,n,r);if(S.isRegExp(a))return a.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,a){if(s=Ve(s),s){const r=S.findKey(this,s);return!!(r&&this[r]!==void 0&&(!a||xt(this,this[r],r,a)))}return!1}delete(s,a){const r=this;let n=!1;function l(o){if(o=Ve(o),o){const d=S.findKey(r,o);d&&(!a||xt(r,r[d],d,a))&&(delete r[d],n=!0)}}return S.isArray(s)?s.forEach(l):l(s),n}clear(s){const a=Object.keys(this);let r=a.length,n=!1;for(;r--;){const l=a[r];(!s||xt(this,this[l],l,s,!0))&&(delete this[l],n=!0)}return n}normalize(s){const a=this,r={};return S.forEach(this,(n,l)=>{const o=S.findKey(r,l);if(o){a[o]=et(n),delete a[l];return}const d=s?tn(l):String(l).trim();d!==l&&delete a[l],a[d]=et(n),r[d]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const a=Object.create(null);return S.forEach(this,(r,n)=>{r!=null&&r!==!1&&(a[n]=s&&S.isArray(r)?r.join(", "):r)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,a])=>s+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...a){const r=new this(s);return a.forEach(n=>r.set(n)),r}static accessor(s){const r=(this[Ut]=this[Ut]={accessors:{}}).accessors,n=this.prototype;function l(o){const d=Ve(o);r[d]||(sn(n,o),r[d]=!0)}return S.isArray(s)?s.forEach(l):l(s),this}};fe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);S.reduceDescriptors(fe.prototype,({value:t},s)=>{let a=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(r){this[a]=r}}});S.freezeMethods(fe);function pt(t,s){const a=this||He,r=s||a,n=fe.from(r.headers);let l=r.data;return S.forEach(t,function(d){l=d.call(a,l,n.normalize(),s?s.status:void 0)}),n.normalize(),l}function fs(t){return!!(t&&t.__CANCEL__)}function Ue(t,s,a){X.call(this,t??"canceled",X.ERR_CANCELED,s,a),this.name="CanceledError"}S.inherits(Ue,X,{__CANCEL__:!0});function ys(t,s,a){const r=a.config.validateStatus;!a.status||!r||r(a.status)?t(a):s(new X("Request failed with status code "+a.status,[X.ERR_BAD_REQUEST,X.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function an(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function nn(t,s){t=t||10;const a=new Array(t),r=new Array(t);let n=0,l=0,o;return s=s!==void 0?s:1e3,function(m){const f=Date.now(),p=r[l];o||(o=f),a[n]=m,r[n]=f;let b=l,c=0;for(;b!==n;)c+=a[b++],b=b%t;if(n=(n+1)%t,n===l&&(l=(l+1)%t),f-o<s)return;const u=p&&f-p;return u?Math.round(c*1e3/u):void 0}}function rn(t,s){let a=0,r=1e3/s,n,l;const o=(f,p=Date.now())=>{a=p,n=null,l&&(clearTimeout(l),l=null),t(...f)};return[(...f)=>{const p=Date.now(),b=p-a;b>=r?o(f,p):(n=f,l||(l=setTimeout(()=>{l=null,o(n)},r-b)))},()=>n&&o(n)]}const nt=(t,s,a=3)=>{let r=0;const n=nn(50,250);return rn(l=>{const o=l.loaded,d=l.lengthComputable?l.total:void 0,m=o-r,f=n(m),p=o<=d;r=o;const b={loaded:o,total:d,progress:d?o/d:void 0,bytes:m,rate:f||void 0,estimated:f&&d&&p?(d-o)/f:void 0,event:l,lengthComputable:d!=null,[s?"download":"upload"]:!0};t(b)},a)},$t=(t,s)=>{const a=t!=null;return[r=>s[0]({lengthComputable:a,total:t,loaded:r}),s[1]]},Vt=t=>(...s)=>S.asap(()=>t(...s)),ln=pe.hasStandardBrowserEnv?((t,s)=>a=>(a=new URL(a,pe.origin),t.protocol===a.protocol&&t.host===a.host&&(s||t.port===a.port)))(new URL(pe.origin),pe.navigator&&/(msie|trident)/i.test(pe.navigator.userAgent)):()=>!0,on=pe.hasStandardBrowserEnv?{write(t,s,a,r,n,l,o){if(typeof document>"u")return;const d=[`${t}=${encodeURIComponent(s)}`];S.isNumber(a)&&d.push(`expires=${new Date(a).toUTCString()}`),S.isString(r)&&d.push(`path=${r}`),S.isString(n)&&d.push(`domain=${n}`),l===!0&&d.push("secure"),S.isString(o)&&d.push(`SameSite=${o}`),document.cookie=d.join("; ")},read(t){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function dn(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function cn(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function bs(t,s,a){let r=!dn(s);return t&&(r||a==!1)?cn(t,s):s}const Kt=t=>t instanceof fe?{...t}:t;function Oe(t,s){s=s||{};const a={};function r(f,p,b,c){return S.isPlainObject(f)&&S.isPlainObject(p)?S.merge.call({caseless:c},f,p):S.isPlainObject(p)?S.merge({},p):S.isArray(p)?p.slice():p}function n(f,p,b,c){if(S.isUndefined(p)){if(!S.isUndefined(f))return r(void 0,f,b,c)}else return r(f,p,b,c)}function l(f,p){if(!S.isUndefined(p))return r(void 0,p)}function o(f,p){if(S.isUndefined(p)){if(!S.isUndefined(f))return r(void 0,f)}else return r(void 0,p)}function d(f,p,b){if(b in s)return r(f,p);if(b in t)return r(void 0,f)}const m={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:d,headers:(f,p,b)=>n(Kt(f),Kt(p),b,!0)};return S.forEach(Object.keys({...t,...s}),function(p){const b=m[p]||n,c=b(t[p],s[p],p);S.isUndefined(c)&&b!==d||(a[p]=c)}),a}const js=t=>{const s=Oe({},t);let{data:a,withXSRFToken:r,xsrfHeaderName:n,xsrfCookieName:l,headers:o,auth:d}=s;if(s.headers=o=fe.from(o),s.url=ps(bs(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),d&&o.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),S.isFormData(a)){if(pe.hasStandardBrowserEnv||pe.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(S.isFunction(a.getHeaders)){const m=a.getHeaders(),f=["content-type","content-length"];Object.entries(m).forEach(([p,b])=>{f.includes(p.toLowerCase())&&o.set(p,b)})}}if(pe.hasStandardBrowserEnv&&(r&&S.isFunction(r)&&(r=r(s)),r||r!==!1&&ln(s.url))){const m=n&&l&&on.read(l);m&&o.set(n,m)}return s},mn=typeof XMLHttpRequest<"u",un=mn&&function(t){return new Promise(function(a,r){const n=js(t);let l=n.data;const o=fe.from(n.headers).normalize();let{responseType:d,onUploadProgress:m,onDownloadProgress:f}=n,p,b,c,u,i;function C(){u&&u(),i&&i(),n.cancelToken&&n.cancelToken.unsubscribe(p),n.signal&&n.signal.removeEventListener("abort",p)}let E=new XMLHttpRequest;E.open(n.method.toUpperCase(),n.url,!0),E.timeout=n.timeout;function h(){if(!E)return;const A=fe.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),w={data:!d||d==="text"||d==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:A,config:t,request:E};ys(function(q){a(q),C()},function(q){r(q),C()},w),E=null}"onloadend"in E?E.onloadend=h:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(h)},E.onabort=function(){E&&(r(new X("Request aborted",X.ECONNABORTED,t,E)),E=null)},E.onerror=function(g){const w=g&&g.message?g.message:"Network Error",O=new X(w,X.ERR_NETWORK,t,E);O.event=g||null,r(O),E=null},E.ontimeout=function(){let g=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const w=n.transitional||gs;n.timeoutErrorMessage&&(g=n.timeoutErrorMessage),r(new X(g,w.clarifyTimeoutError?X.ETIMEDOUT:X.ECONNABORTED,t,E)),E=null},l===void 0&&o.setContentType(null),"setRequestHeader"in E&&S.forEach(o.toJSON(),function(g,w){E.setRequestHeader(w,g)}),S.isUndefined(n.withCredentials)||(E.withCredentials=!!n.withCredentials),d&&d!=="json"&&(E.responseType=n.responseType),f&&([c,i]=nt(f,!0),E.addEventListener("progress",c)),m&&E.upload&&([b,u]=nt(m),E.upload.addEventListener("progress",b),E.upload.addEventListener("loadend",u)),(n.cancelToken||n.signal)&&(p=A=>{E&&(r(!A||A.type?new Ue(null,t,E):A),E.abort(),E=null)},n.cancelToken&&n.cancelToken.subscribe(p),n.signal&&(n.signal.aborted?p():n.signal.addEventListener("abort",p)));const k=an(n.url);if(k&&pe.protocols.indexOf(k)===-1){r(new X("Unsupported protocol "+k+":",X.ERR_BAD_REQUEST,t));return}E.send(l||null)})},xn=(t,s)=>{const{length:a}=t=t?t.filter(Boolean):[];if(s||a){let r=new AbortController,n;const l=function(f){if(!n){n=!0,d();const p=f instanceof Error?f:this.reason;r.abort(p instanceof X?p:new Ue(p instanceof Error?p.message:p))}};let o=s&&setTimeout(()=>{o=null,l(new X(`timeout ${s} of ms exceeded`,X.ETIMEDOUT))},s);const d=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(f=>{f.unsubscribe?f.unsubscribe(l):f.removeEventListener("abort",l)}),t=null)};t.forEach(f=>f.addEventListener("abort",l));const{signal:m}=r;return m.unsubscribe=()=>S.asap(d),m}},pn=function*(t,s){let a=t.byteLength;if(a<s){yield t;return}let r=0,n;for(;r<a;)n=r+s,yield t.slice(r,n),r=n},gn=async function*(t,s){for await(const a of hn(t))yield*pn(a,s)},hn=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:a,value:r}=await s.read();if(a)break;yield r}}finally{await s.cancel()}},_t=(t,s,a,r)=>{const n=gn(t,s);let l=0,o,d=m=>{o||(o=!0,r&&r(m))};return new ReadableStream({async pull(m){try{const{done:f,value:p}=await n.next();if(f){d(),m.close();return}let b=p.byteLength;if(a){let c=l+=b;a(c)}m.enqueue(new Uint8Array(p))}catch(f){throw d(f),f}},cancel(m){return d(m),n.return()}},{highWaterMark:2})},zt=64*1024,{isFunction:Xe}=S,fn=(({Request:t,Response:s})=>({Request:t,Response:s}))(S.global),{ReadableStream:Qt,TextEncoder:Wt}=S.global,Ht=(t,...s)=>{try{return!!t(...s)}catch{return!1}},yn=t=>{t=S.merge.call({skipUndefined:!0},fn,t);const{fetch:s,Request:a,Response:r}=t,n=s?Xe(s):typeof fetch=="function",l=Xe(a),o=Xe(r);if(!n)return!1;const d=n&&Xe(Qt),m=n&&(typeof Wt=="function"?(i=>C=>i.encode(C))(new Wt):async i=>new Uint8Array(await new a(i).arrayBuffer())),f=l&&d&&Ht(()=>{let i=!1;const C=new a(pe.origin,{body:new Qt,method:"POST",get duplex(){return i=!0,"half"}}).headers.has("Content-Type");return i&&!C}),p=o&&d&&Ht(()=>S.isReadableStream(new r("").body)),b={stream:p&&(i=>i.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(i=>{!b[i]&&(b[i]=(C,E)=>{let h=C&&C[i];if(h)return h.call(C);throw new X(`Response type '${i}' is not supported`,X.ERR_NOT_SUPPORT,E)})});const c=async i=>{if(i==null)return 0;if(S.isBlob(i))return i.size;if(S.isSpecCompliantForm(i))return(await new a(pe.origin,{method:"POST",body:i}).arrayBuffer()).byteLength;if(S.isArrayBufferView(i)||S.isArrayBuffer(i))return i.byteLength;if(S.isURLSearchParams(i)&&(i=i+""),S.isString(i))return(await m(i)).byteLength},u=async(i,C)=>{const E=S.toFiniteNumber(i.getContentLength());return E??c(C)};return async i=>{let{url:C,method:E,data:h,signal:k,cancelToken:A,timeout:g,onDownloadProgress:w,onUploadProgress:O,responseType:q,headers:v,withCredentials:B="same-origin",fetchOptions:D}=js(i),M=s||fetch;q=q?(q+"").toLowerCase():"text";let P=xn([k,A&&A.toAbortSignal()],g),T=null;const x=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let R;try{if(O&&f&&E!=="get"&&E!=="head"&&(R=await u(v,h))!==0){let _=new a(C,{method:"POST",body:h,duplex:"half"}),G;if(S.isFormData(h)&&(G=_.headers.get("content-type"))&&v.setContentType(G),_.body){const[se,oe]=$t(R,nt(Vt(O)));h=_t(_.body,zt,se,oe)}}S.isString(B)||(B=B?"include":"omit");const y=l&&"credentials"in a.prototype,K={...D,signal:P,method:E.toUpperCase(),headers:v.normalize().toJSON(),body:h,duplex:"half",credentials:y?B:void 0};T=l&&new a(C,K);let Q=await(l?M(T,D):M(C,K));const ue=p&&(q==="stream"||q==="response");if(p&&(w||ue&&x)){const _={};["status","statusText","headers"].forEach(xe=>{_[xe]=Q[xe]});const G=S.toFiniteNumber(Q.headers.get("content-length")),[se,oe]=w&&$t(G,nt(Vt(w),!0))||[];Q=new r(_t(Q.body,zt,se,()=>{oe&&oe(),x&&x()}),_)}q=q||"text";let $=await b[S.findKey(b,q)||"text"](Q,i);return!ue&&x&&x(),await new Promise((_,G)=>{ys(_,G,{data:$,headers:fe.from(Q.headers),status:Q.status,statusText:Q.statusText,config:i,request:T})})}catch(y){throw x&&x(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new X("Network Error",X.ERR_NETWORK,i,T),{cause:y.cause||y}):X.from(y,y&&y.code,i,T)}}},bn=new Map,Ns=t=>{let s=t&&t.env||{};const{fetch:a,Request:r,Response:n}=s,l=[r,n,a];let o=l.length,d=o,m,f,p=bn;for(;d--;)m=l[d],f=p.get(m),f===void 0&&p.set(m,f=d?new Map:yn(s)),p=f;return f};Ns();const Ft={http:Ma,xhr:un,fetch:{get:Ns}};S.forEach(Ft,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const Jt=t=>`- ${t}`,jn=t=>S.isFunction(t)||t===null||t===!1;function Nn(t,s){t=S.isArray(t)?t:[t];const{length:a}=t;let r,n;const l={};for(let o=0;o<a;o++){r=t[o];let d;if(n=r,!jn(r)&&(n=Ft[(d=String(r)).toLowerCase()],n===void 0))throw new X(`Unknown adapter '${d}'`);if(n&&(S.isFunction(n)||(n=n.get(s))))break;l[d||"#"+o]=n}if(!n){const o=Object.entries(l).map(([m,f])=>`adapter ${m} `+(f===!1?"is not supported by the environment":"is not available in the build"));let d=a?o.length>1?`since :
`+o.map(Jt).join(`
`):" "+Jt(o[0]):"as no adapter specified";throw new X("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return n}const vs={getAdapter:Nn,adapters:Ft};function gt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Ue(null,t)}function Gt(t){return gt(t),t.headers=fe.from(t.headers),t.data=pt.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),vs.getAdapter(t.adapter||He.adapter,t)(t).then(function(r){return gt(t),r.data=pt.call(t,t.transformResponse,r),r.headers=fe.from(r.headers),r},function(r){return fs(r)||(gt(t),r&&r.response&&(r.response.data=pt.call(t,t.transformResponse,r.response),r.response.headers=fe.from(r.response.headers))),Promise.reject(r)})}const ws="1.13.1",ct={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{ct[t]=function(r){return typeof r===t||"a"+(s<1?"n ":" ")+t}});const Yt={};ct.transitional=function(s,a,r){function n(l,o){return"[Axios v"+ws+"] Transitional option '"+l+"'"+o+(r?". "+r:"")}return(l,o,d)=>{if(s===!1)throw new X(n(o," has been removed"+(a?" in "+a:"")),X.ERR_DEPRECATED);return a&&!Yt[o]&&(Yt[o]=!0,console.warn(n(o," has been deprecated since v"+a+" and will be removed in the near future"))),s?s(l,o,d):!0}};ct.spelling=function(s){return(a,r)=>(console.warn(`${r} is likely a misspelling of ${s}`),!0)};function vn(t,s,a){if(typeof t!="object")throw new X("options must be an object",X.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let n=r.length;for(;n-- >0;){const l=r[n],o=s[l];if(o){const d=t[l],m=d===void 0||o(d,l,t);if(m!==!0)throw new X("option "+l+" must be "+m,X.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new X("Unknown option "+l,X.ERR_BAD_OPTION)}}const tt={assertOptions:vn,validators:ct},Ae=tt.validators;let Fe=class{constructor(s){this.defaults=s||{},this.interceptors={request:new Bt,response:new Bt}}async request(s,a){try{return await this._request(s,a)}catch(r){if(r instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(s,a){typeof s=="string"?(a=a||{},a.url=s):a=s||{},a=Oe(this.defaults,a);const{transitional:r,paramsSerializer:n,headers:l}=a;r!==void 0&&tt.assertOptions(r,{silentJSONParsing:Ae.transitional(Ae.boolean),forcedJSONParsing:Ae.transitional(Ae.boolean),clarifyTimeoutError:Ae.transitional(Ae.boolean)},!1),n!=null&&(S.isFunction(n)?a.paramsSerializer={serialize:n}:tt.assertOptions(n,{encode:Ae.function,serialize:Ae.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),tt.assertOptions(a,{baseUrl:Ae.spelling("baseURL"),withXsrfToken:Ae.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let o=l&&S.merge(l.common,l[a.method]);l&&S.forEach(["delete","get","head","post","put","patch","common"],i=>{delete l[i]}),a.headers=fe.concat(o,l);const d=[];let m=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(a)===!1||(m=m&&C.synchronous,d.unshift(C.fulfilled,C.rejected))});const f=[];this.interceptors.response.forEach(function(C){f.push(C.fulfilled,C.rejected)});let p,b=0,c;if(!m){const i=[Gt.bind(this),void 0];for(i.unshift(...d),i.push(...f),c=i.length,p=Promise.resolve(a);b<c;)p=p.then(i[b++],i[b++]);return p}c=d.length;let u=a;for(;b<c;){const i=d[b++],C=d[b++];try{u=i(u)}catch(E){C.call(this,E);break}}try{p=Gt.call(this,u)}catch(i){return Promise.reject(i)}for(b=0,c=f.length;b<c;)p=p.then(f[b++],f[b++]);return p}getUri(s){s=Oe(this.defaults,s);const a=bs(s.baseURL,s.url,s.allowAbsoluteUrls);return ps(a,s.params,s.paramsSerializer)}};S.forEach(["delete","get","head","options"],function(s){Fe.prototype[s]=function(a,r){return this.request(Oe(r||{},{method:s,url:a,data:(r||{}).data}))}});S.forEach(["post","put","patch"],function(s){function a(r){return function(l,o,d){return this.request(Oe(d||{},{method:s,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Fe.prototype[s]=a(),Fe.prototype[s+"Form"]=a(!0)});let wn=class ks{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(l){a=l});const r=this;this.promise.then(n=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](n);r._listeners=null}),this.promise.then=n=>{let l;const o=new Promise(d=>{r.subscribe(d),l=d}).then(n);return o.cancel=function(){r.unsubscribe(l)},o},s(function(l,o,d){r.reason||(r.reason=new Ue(l,o,d),a(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const a=this._listeners.indexOf(s);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const s=new AbortController,a=r=>{s.abort(r)};return this.subscribe(a),s.signal.unsubscribe=()=>this.unsubscribe(a),s.signal}static source(){let s;return{token:new ks(function(n){s=n}),cancel:s}}};function kn(t){return function(a){return t.apply(null,a)}}function Sn(t){return S.isObject(t)&&t.isAxiosError===!0}const Ct={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Ct).forEach(([t,s])=>{Ct[s]=t});function Ss(t){const s=new Fe(t),a=ss(Fe.prototype.request,s);return S.extend(a,Fe.prototype,s,{allOwnKeys:!0}),S.extend(a,s,null,{allOwnKeys:!0}),a.create=function(n){return Ss(Oe(t,n))},a}const ie=Ss(He);ie.Axios=Fe;ie.CanceledError=Ue;ie.CancelToken=wn;ie.isCancel=fs;ie.VERSION=ws;ie.toFormData=dt;ie.AxiosError=X;ie.Cancel=ie.CanceledError;ie.all=function(s){return Promise.all(s)};ie.spread=kn;ie.isAxiosError=Sn;ie.mergeConfig=Oe;ie.AxiosHeaders=fe;ie.formToJSON=t=>hs(S.isHTMLForm(t)?new FormData(t):t);ie.getAdapter=vs.getAdapter;ie.HttpStatusCode=Ct;ie.default=ie;const{Axios:mr,AxiosError:ur,CanceledError:xr,isCancel:pr,CancelToken:gr,VERSION:hr,all:fr,Cancel:yr,isAxiosError:br,spread:jr,toFormData:Nr,AxiosHeaders:vr,HttpStatusCode:wr,formToJSON:kr,getAdapter:Sr,mergeConfig:Cr}=ie,L=ie.create({baseURL:"http://localhost:3000/api",headers:{"Content-Type":"application/json"}});L.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));L.interceptors.response.use(t=>t,t=>{var s,a,r;return((s=t.response)==null?void 0:s.status)===401&&!((r=(a=t.config)==null?void 0:a.url)!=null&&r.includes("/auth/login"))&&(localStorage.removeItem("token"),window.location.pathname!=="/login"&&(window.location.href="/login")),Promise.reject(t)});const Cs=N.createContext(void 0),Cn=({children:t})=>{const[s,a]=N.useState(null),[r,n]=N.useState(!0);N.useEffect(()=>{localStorage.getItem("token")?l():n(!1)},[]);const l=async()=>{try{const m=await L.get("/auth/me");m.data.status==="success"&&a({...m.data.data.user,userId:m.data.data.user.id})}catch(m){console.error("Failed to fetch user:",m),localStorage.removeItem("token")}finally{n(!1)}},o=async(m,f)=>{var p,b;try{const c=await L.post("/auth/login",{email:m,password:f});if(c.data.status==="success"){const u=c.data.data.token,i=c.data.data.user;localStorage.setItem("token",u),a({...i,userId:i.id})}else throw new Error(c.data.message||"Login failed")}catch(c){throw(b=(p=c.response)==null?void 0:p.data)!=null&&b.message?new Error(c.response.data.message):c.message?c:new Error("Login failed. Please try again.")}},d=()=>{localStorage.removeItem("token"),a(null),window.location.href="/login"};return e.jsx(Cs.Provider,{value:{user:s,loading:r,login:o,logout:d,isAuthenticated:!!s},children:t})},re=()=>{const t=N.useContext(Cs);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},An=()=>{const[t,s]=N.useState(""),[a,r]=N.useState(""),[n,l]=N.useState(""),[o,d]=N.useState(!1),{login:m,isAuthenticated:f,loading:p}=re(),b=ye();N.useEffect(()=>{!p&&f&&b("/dashboard",{replace:!0})},[f,p,b]);const c=async u=>{var i;if(u.preventDefault(),l(""),!t.trim()){l("Please enter your email address");return}if(!a.trim()){l("Please enter your password");return}d(!0);try{await m(t.trim(),a),b("/dashboard",{replace:!0})}catch(C){let E="Login failed. Please check your credentials.";C.response?E=((i=C.response.data)==null?void 0:i.message)||C.message||E:C.request?E="Unable to connect to server. Please check your connection.":E=C.message||E,l(E)}finally{d(!1)}};return p?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"min-h-screen flex overflow-hidden",children:[e.jsxs("div",{className:"w-full lg:w-1/2 relative flex items-center justify-center min-h-screen",style:{backgroundImage:"url('/login-bg.jpeg')",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"}),e.jsxs("div",{className:"relative z-10 w-full max-w-md px-8 py-12",children:[e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-orange-500 text-5xl font-bold tracking-tight mb-2",style:{fontFamily:"Arial, sans-serif",lineHeight:"1.1"},children:"PRIME"}),e.jsxs("div",{className:"flex flex-col mb-2",children:[e.jsx("div",{className:"h-1 w-24 bg-orange-500 mb-1"}),e.jsx("div",{className:"h-0.5 w-24 bg-orange-500"})]}),e.jsx("div",{className:"text-white text-xl font-light tracking-wider mb-1",children:"ACADEMY"}),e.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"SINCE 2013"})]}),e.jsx("p",{className:"text-white text-lg font-light",children:"Digital Art With Excellence"})]}),n&&e.jsx("div",{className:"mb-6 p-4 bg-red-500 bg-opacity-90 text-white rounded-lg text-sm",children:n}),e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsx("div",{children:e.jsx("input",{id:"email",type:"email",value:t,onChange:u=>s(u.target.value),required:!0,className:"w-full px-4 py-3 bg-white bg-opacity-10 border border-white border-opacity-30 rounded-lg text-white placeholder-white placeholder-opacity-70 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent backdrop-blur-sm",placeholder:"Enter your email",style:{color:"white"}})}),e.jsx("div",{children:e.jsx("input",{id:"password",type:"password",value:a,onChange:u=>r(u.target.value),required:!0,className:"w-full px-4 py-3 bg-white bg-opacity-10 border border-white border-opacity-30 rounded-lg text-white placeholder-white placeholder-opacity-70 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent backdrop-blur-sm",placeholder:"Enter your password",style:{color:"white"}})}),e.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 px-4 bg-white text-black font-semibold rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-transparent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?"Signing in...":"Sign In"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-white text-opacity-80 text-sm",children:"Enter your registered email and password to continue"})})]})]}),e.jsx("div",{className:"hidden lg:flex lg:w-1/2 bg-white relative overflow-hidden",children:e.jsxs("div",{className:"w-full h-full p-12 flex flex-col justify-center",children:[e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-6xl font-bold text-black leading-tight mb-2",children:"A Journey of 12 Years"}),e.jsx("h2",{className:"text-6xl font-bold text-black leading-tight",children:"A Legacy of Pride"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mt-8",children:[e.jsx("div",{className:"border-4 border-red-600 rounded-lg overflow-hidden bg-gray-200 aspect-square shadow-lg",style:{backgroundImage:"url('/login-page.jpeg')",backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full h-full bg-black bg-opacity-20"})}),e.jsx("div",{className:"border-4 border-red-600 rounded-lg overflow-hidden bg-gray-200 aspect-square shadow-lg",style:{backgroundImage:"url('/login-page.jpeg')",backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full h-full bg-black bg-opacity-20"})}),e.jsx("div",{className:"border-4 border-red-600 rounded-lg overflow-hidden bg-gray-200 aspect-square shadow-lg col-span-2",style:{backgroundImage:"url('/login-page.jpeg')",backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full h-full bg-black bg-opacity-20"})})]})]})})]})},J=({children:t})=>{var d;const{user:s,logout:a}=re(),r=zs(),[n,l]=N.useState(!0),o=[{name:"Dashboard",href:"/dashboard",icon:"ðŸ "},{name:"Batches",href:"/batches",icon:"ðŸ“š"},{name:"Students",href:"/students",icon:"ðŸ‘¥"},{name:"Faculty",href:"/faculty",icon:"ðŸ‘¨â€ðŸ«"},{name:"Employees",href:"/employees",icon:"ðŸ’¼"},{name:"Attendance",href:"/attendance",icon:"âœ…"},...(s==null?void 0:s.role)!=="student"?[{name:"My Attendance",href:"/student-attendance",icon:"ðŸ“¸"}]:[],{name:"Payments",href:"/payments",icon:"ðŸ’°"},{name:"Portfolios",href:"/portfolios",icon:"ðŸ“"},{name:"Reports",href:"/reports",icon:"ðŸ“Š"},{name:"Approvals",href:"/approvals",icon:"âœ“"},{name:"Leave Management",href:"/leaves",icon:"ðŸ–ï¸"},{name:"Batch Extensions",href:"/batch-extensions",icon:"â±ï¸"},{name:"Users",href:"/users",icon:"ðŸ‘¤"},...(s==null?void 0:s.role)==="superadmin"?[{name:"Roles",href:"/roles",icon:"ðŸ”"}]:[]];return e.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[e.jsxs("aside",{className:`${n?"w-64":"w-20"} bg-white shadow-lg transition-all duration-300 ease-in-out fixed h-screen overflow-y-auto z-50`,children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n&&e.jsx("h1",{className:"text-xl font-bold text-orange-600",children:"Prime Academy"}),e.jsx("button",{onClick:()=>l(!n),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),e.jsx("nav",{className:"space-y-2 pb-24",children:o.map(m=>{const f=r.pathname===m.href||m.href!=="/dashboard"&&r.pathname.startsWith(m.href);return e.jsxs(Qs,{to:m.href,className:`flex items-center px-4 py-3 rounded-lg transition-colors ${f?"bg-orange-100 text-orange-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,title:n?"":m.name,children:[e.jsx("span",{className:"text-xl mr-3 flex-shrink-0",children:m.icon}),n&&e.jsx("span",{className:"text-sm whitespace-nowrap",children:m.name})]},m.name)})})]}),n&&s&&e.jsxs("div",{className:"sticky bottom-0 left-0 right-0 p-4 border-t border-gray-200 bg-white mt-auto",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("div",{className:"font-semibold text-gray-900 truncate",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.role})]}),e.jsx("button",{onClick:a,className:"w-full px-4 py-2 text-sm font-medium text-white bg-orange-600 rounded-lg hover:bg-orange-700 transition-colors",children:"Logout"})]})]}),e.jsxs("div",{className:`flex-1 ${n?"ml-64":"ml-20"} transition-all duration-300 min-h-screen`,children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[!n&&e.jsx("button",{onClick:()=>l(!0),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:((d=o.find(m=>r.pathname===m.href||m.href!=="/dashboard"&&r.pathname.startsWith(m.href)))==null?void 0:d.name)||"Dashboard"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:!n&&s&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-gray-700",children:[s.name," (",s.role,")"]}),e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-white bg-orange-600 rounded-lg hover:bg-orange-700 transition-colors",children:"Logout"})]})})]})}),e.jsx("main",{className:"p-6 bg-gray-50 min-h-[calc(100vh-4rem)]",children:t})]})]})},Xt=()=>{const{user:t}=re(),s=ye(),r=[{name:"Batches",path:"/batches",icon:"ðŸ“š",description:"Manage training batches"},{name:"Students",path:"/students",icon:"ðŸ‘¥",description:"Manage students"},{name:"Faculty",path:"/faculty",icon:"ðŸ‘¨â€ðŸ«",description:"Manage faculty members"},{name:"Employees",path:"/employees",icon:"ðŸ’¼",description:"Manage employees"},{name:"Attendance",path:"/attendance",icon:"âœ…",description:"Track attendance"},...(t==null?void 0:t.role)!=="student"?[{name:"My Attendance",path:"/student-attendance",icon:"ðŸ“¸",description:"Punch in/out with photo and fingerprint"}]:[],{name:"Payments",path:"/payments",icon:"ðŸ’°",description:"Manage payments"},{name:"Portfolios",path:"/portfolios",icon:"ðŸ“",description:"Student portfolios"},{name:"Reports",path:"/reports",icon:"ðŸ“Š",description:"View reports"},{name:"Approvals",path:"/approvals",icon:"âœ“",description:"Manage approvals"},{name:"Leave Management",path:"/leaves",icon:"ðŸ–ï¸",description:"Manage leave requests for all users"},{name:"Batch Extensions",path:"/batch-extensions",icon:"â±ï¸",description:"Manage batch extensions"},{name:"Users",path:"/users",icon:"ðŸ‘¤",description:"Manage users"}];return e.jsx(J,{children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),e.jsxs("p",{className:"mt-2 text-gray-600",children:["Welcome back, ",t==null?void 0:t.name,"!"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(n=>e.jsxs("div",{onClick:()=>s(n.path),className:"bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow border border-gray-200 hover:border-orange-500",children:[e.jsx("div",{className:"text-4xl mb-4",children:n.icon}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:n.name}),e.jsx("p",{className:"text-sm text-gray-600",children:n.description})]},n.path))})]})})};var At=(t=>(t.IN_PROGRESS="in_progress",t.COMPLETED="completed",t))(At||{});const st={createCompletion:async t=>(await L.post("/software-completions",t)).data,getCompletions:async t=>(await L.get("/software-completions",{params:t})).data,updateCompletion:async(t,s)=>(await L.patch(`/software-completions/${t}`,s)).data},ge={getAllBatches:async()=>(await L.get("/batches")).data,getBatchById:async t=>(await L.get(`/batches/${t}`)).data,createBatch:async t=>(await L.post("/batches",t)).data,updateBatch:async(t,s)=>(await L.put(`/batches/${t}`,s)).data,deleteBatch:async t=>(await L.delete(`/batches/${t}`)).data,suggestCandidates:async t=>(await L.get(`/batches/${t}/candidates/suggest`)).data},Pe={getAllStudents:async()=>(await L.get("/reports/all-students")).data,createEnrollment:async t=>(await L.post("/enrollments",t)).data,completeEnrollment:async t=>(await L.post("/students/enroll",t)).data,bulkEnrollStudents:async t=>{const s=new FormData;return s.append("file",t),(await L.post("/students/bulk-enroll",s,{headers:{"Content-Type":"multipart/form-data"}})).data},downloadEnrollmentTemplate:async()=>(await L.get("/students/template",{responseType:"blob"})).data},Pn=()=>{var g;const{user:t}=re(),s=le(),[a,r]=N.useState(!1),[n,l]=N.useState(null),[o,d]=N.useState(!1),{data:m,isLoading:f}=H({queryKey:["software-completions",t==null?void 0:t.role,t==null?void 0:t.userId],queryFn:()=>st.getCompletions()}),{data:p}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches()}),{data:b}=H({queryKey:["students"],queryFn:()=>Pe.getAllStudents()}),c=W({mutationFn:w=>st.createCompletion(w),onSuccess:()=>{s.invalidateQueries({queryKey:["software-completions"]}),r(!1),alert("Software completion record created successfully!")}}),u=W({mutationFn:({id:w,status:O,endDate:q})=>st.updateCompletion(w,{status:O,endDate:q}),onSuccess:()=>{s.invalidateQueries({queryKey:["software-completions"]}),d(!1),l(null),alert("Software completion record updated successfully!")}}),i=(m==null?void 0:m.data.completions)||[],C=(p==null?void 0:p.data)||[],E=((g=b==null?void 0:b.data)==null?void 0:g.students)||[],h=w=>{const O={[At.IN_PROGRESS]:"bg-blue-100 text-blue-800",[At.COMPLETED]:"bg-green-100 text-green-800"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${O[w]}`,children:w.replace("_"," ").toUpperCase()})},k=w=>{l(w),d(!0)},A=(w,O)=>{n&&u.mutate({id:n.id,status:w,endDate:O})};return e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Software Completion Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Track software completion for students"})]}),((t==null?void 0:t.role)==="faculty"||(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ Add Completion"})]})}),e.jsx("div",{className:"p-6",children:f?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Software"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Faculty"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Start Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"End Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),((t==null?void 0:t.role)==="faculty"||(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(w=>{var O,q,v,B;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:(O=w.student)==null?void 0:O.name}),e.jsx("div",{className:"text-sm text-gray-500",children:(q=w.student)==null?void 0:q.email})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(v=w.batch)==null?void 0:v.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:w.softwareName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(B=w.faculty)==null?void 0:B.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(w.startDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(w.endDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h(w.status)}),((t==null?void 0:t.role)==="faculty"||(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>k(w),className:"text-orange-600 hover:text-orange-900",children:"Update"})})]},w.id)})})]}),i.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No software completion records found"})]})})]})}),a&&e.jsx(En,{onClose:()=>r(!1),onSubmit:w=>c.mutate(w),batches:C,students:E,currentUser:t}),o&&n&&e.jsx(Dn,{completion:n,onClose:()=>{d(!1),l(null)},onSubmit:A})]})},En=({onClose:t,onSubmit:s,batches:a,students:r,currentUser:n})=>{const[l,o]=N.useState({studentId:0,batchId:0,softwareName:"",startDate:"",endDate:"",facultyId:(n==null?void 0:n.role)==="faculty"?n.userId:0}),d=m=>{m.preventDefault(),l.studentId&&l.batchId&&l.softwareName&&l.startDate&&l.endDate&&l.facultyId?s(l):alert("Please fill in all required fields")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Add Software Completion"}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student"}),e.jsxs("select",{value:l.studentId,onChange:m=>o({...l,studentId:parseInt(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select Student"}),r.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch"}),e.jsxs("select",{value:l.batchId,onChange:m=>o({...l,batchId:parseInt(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select Batch"}),a.map(m=>e.jsx("option",{value:m.id,children:m.title},m.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Software Name"}),e.jsx("input",{type:"text",value:l.softwareName,onChange:m=>o({...l,softwareName:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),(n==null?void 0:n.role)!=="faculty"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty"}),e.jsx("input",{type:"number",value:l.facultyId,onChange:m=>o({...l,facultyId:parseInt(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:l.startDate,onChange:m=>o({...l,startDate:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:l.endDate,onChange:m=>o({...l,endDate:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Submit"})]})]})]})})},Dn=({completion:t,onClose:s,onSubmit:a})=>{var m;const[r,n]=N.useState(t.status),[l,o]=N.useState(t.endDate),d=f=>{f.preventDefault(),a(r,l)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Update Software Completion"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Student:"})," ",(m=t.student)==null?void 0:m.name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Software:"})," ",t.softwareName]})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:r,onChange:f=>n(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:l,onChange:f=>o(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Update"})]})]})]})})};var Le=(t=>(t.PENDING="pending",t.APPROVED="approved",t.REJECTED="rejected",t))(Le||{});const ht={createExtension:async t=>(await L.post("/batch-extensions",t)).data,getExtensions:async t=>(await L.get("/batch-extensions",{params:t})).data,approveExtension:async(t,s)=>(await L.post(`/batch-extensions/${t}/approve`,s)).data},Rn=()=>{const{user:t}=re(),s=le(),[a,r]=N.useState(!1),[n,l]=N.useState(null),[o,d]=N.useState(!1),{data:m,isLoading:f}=H({queryKey:["batch-extensions"],queryFn:()=>ht.getExtensions()}),{data:p}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches()}),b=W({mutationFn:A=>ht.createExtension(A),onSuccess:()=>{s.invalidateQueries({queryKey:["batch-extensions"]}),r(!1),alert("Extension request created successfully!")}}),c=W({mutationFn:({id:A,approve:g,rejectionReason:w})=>ht.approveExtension(A,{approve:g,rejectionReason:w}),onSuccess:()=>{s.invalidateQueries({queryKey:["batch-extensions"]}),s.invalidateQueries({queryKey:["batches"]}),d(!1),l(null),alert("Extension request processed successfully!")}}),u=(m==null?void 0:m.data.extensions)||[],i=(p==null?void 0:p.data)||[],C=A=>{const g={[Le.PENDING]:"bg-yellow-100 text-yellow-800",[Le.APPROVED]:"bg-green-100 text-green-800",[Le.REJECTED]:"bg-red-100 text-red-800"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${g[A]}`,children:A.toUpperCase()})},E=(A,g)=>{l(A),d(!0)},h=(A,g)=>{n&&c.mutate({id:n.id,approve:A,rejectionReason:g})},k=A=>(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="admin"&&A.numberOfSessions<=3;return e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Batch Extension Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Request and manage batch time extensions"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ Request Extension"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," Extensions up to 3 sessions can be approved by Admin. Extensions for more than 3 sessions require SuperAdmin approval."]})}),f?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Requested By"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reason"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(A=>{var g,w,O;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:(g=A.batch)==null?void 0:g.title}),e.jsx("div",{className:"text-sm text-gray-500",children:(w=A.batch)==null?void 0:w.software})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`text-sm font-semibold ${A.numberOfSessions>3?"text-red-600":"text-gray-900"}`,children:[A.numberOfSessions," ",A.numberOfSessions>3&&"(Requires SuperAdmin)"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(O=A.requester)==null?void 0:O.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:A.reason||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C(A.status)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[A.status===Le.PENDING&&k(A)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>E(A),className:"text-green-600 hover:text-green-900",children:"Approve"}),e.jsx("button",{onClick:()=>E(A),className:"text-red-600 hover:text-red-900",children:"Reject"})]}),A.status===Le.PENDING&&!k(A)&&e.jsx("span",{className:"text-gray-400",children:"Requires SuperAdmin"})]})]},A.id)})})]}),u.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No extension requests found"})]})]})]})}),a&&e.jsx(Fn,{onClose:()=>r(!1),onSubmit:A=>b.mutate(A),batches:i}),o&&n&&e.jsx(In,{extension:n,onClose:()=>{d(!1),l(null)},onSubmit:h})]})},Fn=({onClose:t,onSubmit:s,batches:a})=>{const[r,n]=N.useState({batchId:0,numberOfSessions:1,reason:""}),l=o=>{o.preventDefault(),r.batchId&&r.numberOfSessions>0?s(r):alert("Please fill in all required fields")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Request Batch Extension"}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch"}),e.jsxs("select",{value:r.batchId,onChange:o=>n({...r,batchId:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select Batch"}),a.map(o=>e.jsx("option",{value:o.id,children:o.title},o.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Sessions"}),e.jsx("input",{type:"number",min:"1",value:r.numberOfSessions,onChange:o=>n({...r,numberOfSessions:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0}),r.numberOfSessions>3&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:"This will require SuperAdmin approval"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason"}),e.jsx("textarea",{value:r.reason,onChange:o=>n({...r,reason:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Submit"})]})]})]})})},In=({extension:t,onClose:s,onSubmit:a})=>{var m;const[r,n]=N.useState(!0),[l,o]=N.useState(""),d=f=>{f.preventDefault(),a(r,r?void 0:l)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:[r?"Approve":"Reject"," Extension Request"]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Batch:"})," ",(m=t.batch)==null?void 0:m.title]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Sessions:"})," ",t.numberOfSessions]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Reason:"})," ",t.reason||"-"]})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",checked:r,onChange:()=>n(!0)}),e.jsx("span",{children:"Approve"})]}),e.jsxs("label",{className:"flex items-center space-x-2 mt-2",children:[e.jsx("input",{type:"radio",checked:!r,onChange:()=>n(!1)}),e.jsx("span",{children:"Reject"})]})]}),!r&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejection Reason"}),e.jsx("textarea",{value:l,onChange:f=>o(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:3,required:!r})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:`px-4 py-2 rounded-lg text-white ${r?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:r?"Approve":"Reject"})]})]})]})})};var Ne=(t=>(t.PENDING="pending",t.APPROVED="approved",t.REJECTED="rejected",t))(Ne||{});const ft={createLeave:async t=>(await L.post("/student-leaves",t)).data,getLeaves:async t=>(await L.get("/student-leaves",{params:t})).data,approveLeave:async(t,s)=>(await L.post(`/student-leaves/${t}/approve`,s)).data},yt={createLeave:async t=>(await L.post("/employee-leaves",t)).data,getLeaves:async t=>(await L.get("/employee-leaves",{params:t})).data,approveLeave:async(t,s)=>(await L.post(`/employee-leaves/${t}/approve`,s)).data},bt={createLeave:async t=>(await L.post("/faculty-leaves",t)).data,getLeaves:async t=>(await L.get("/faculty-leaves",{params:t})).data,approveLeave:async(t,s)=>(await L.post(`/faculty-leaves/${t}/approve`,s)).data},me={getAllUsers:async t=>(await L.get("/users",{params:t})).data,getUser:async t=>(await L.get(`/users/${t}`)).data,createUser:async t=>(await L.post("/auth/register",t)).data,updateUser:async(t,s)=>(await L.put(`/users/${t}`,s)).data,deleteUser:async t=>{await L.delete(`/users/${t}`)},loginAsUser:async t=>(await L.post(`/users/${t}/login-as`)).data,updateStudentProfile:async(t,s)=>(await L.put(`/users/${t}/student-profile`,s)).data},Zt=()=>{var _,G,se,oe,xe,be,I,z,Z,de,ce,ke,je;const{user:t}=re(),s=le(),[a,r]=N.useState(()=>(t==null?void 0:t.role)==="student"?"student":(t==null?void 0:t.role)==="employee"?"employee":(t==null?void 0:t.role)==="faculty"?"faculty":"student"),[n,l]=N.useState(!1),[o,d]=N.useState(!1),[m,f]=N.useState(null),[p,b]=N.useState("all"),{data:c,isLoading:u}=H({queryKey:["student-leaves",p],queryFn:()=>ft.getLeaves(p!=="all"?{status:p}:{}),enabled:a==="student"||(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"}),{data:i,isLoading:C}=H({queryKey:["employee-leaves",p],queryFn:()=>yt.getLeaves(p!=="all"?{status:p}:{}),enabled:a==="employee"||(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"}),{data:E,isLoading:h}=H({queryKey:["faculty-leaves",p],queryFn:()=>bt.getLeaves(p!=="all"?{status:p}:{}),enabled:a==="faculty"||(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"}),{data:k}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches(),enabled:n&&a==="student"&&((t==null?void 0:t.role)==="student"||(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")}),{data:A}=H({queryKey:["students","active"],queryFn:()=>me.getAllUsers({role:"student",isActive:!0}),enabled:n&&a==="student"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")}),{data:g}=H({queryKey:["employees","active"],queryFn:()=>me.getAllUsers({role:"employee",isActive:!0}),enabled:n&&a==="employee"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")}),{data:w}=H({queryKey:["faculty","active"],queryFn:()=>me.getAllUsers({role:"faculty",isActive:!0}),enabled:n&&a==="faculty"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")}),O=W({mutationFn:U=>ft.createLeave(U),onSuccess:()=>{s.invalidateQueries({queryKey:["student-leaves"]}),l(!1),alert("Leave request created successfully!")},onError:U=>{var Y,ee;alert(((ee=(Y=U.response)==null?void 0:Y.data)==null?void 0:ee.message)||"Failed to create leave request")}}),q=W({mutationFn:U=>yt.createLeave(U),onSuccess:()=>{s.invalidateQueries({queryKey:["employee-leaves"]}),l(!1),alert("Leave request created successfully!")},onError:U=>{var Y,ee;alert(((ee=(Y=U.response)==null?void 0:Y.data)==null?void 0:ee.message)||"Failed to create leave request")}}),v=W({mutationFn:U=>bt.createLeave(U),onSuccess:()=>{s.invalidateQueries({queryKey:["faculty-leaves"]}),l(!1),alert("Leave request created successfully!")},onError:U=>{var Y,ee;alert(((ee=(Y=U.response)==null?void 0:Y.data)==null?void 0:ee.message)||"Failed to create leave request")}}),B=W({mutationFn:({id:U,approve:Y,rejectionReason:ee})=>ft.approveLeave(U,{approve:Y,rejectionReason:ee}),onSuccess:()=>{s.invalidateQueries({queryKey:["student-leaves"]}),d(!1),f(null),alert("Leave request updated successfully!")},onError:U=>{var Y,ee;alert(((ee=(Y=U.response)==null?void 0:Y.data)==null?void 0:ee.message)||"Failed to update leave request")}}),D=W({mutationFn:({id:U,approve:Y,rejectionReason:ee})=>yt.approveLeave(U,{approve:Y,rejectionReason:ee}),onSuccess:()=>{s.invalidateQueries({queryKey:["employee-leaves"]}),d(!1),f(null),alert("Leave request updated successfully!")},onError:U=>{var Y,ee;alert(((ee=(Y=U.response)==null?void 0:Y.data)==null?void 0:ee.message)||"Failed to update leave request")}}),M=W({mutationFn:({id:U,approve:Y,rejectionReason:ee})=>bt.approveLeave(U,{approve:Y,rejectionReason:ee}),onSuccess:()=>{s.invalidateQueries({queryKey:["faculty-leaves"]}),d(!1),f(null),alert("Leave request updated successfully!")},onError:U=>{var Y,ee;alert(((ee=(Y=U.response)==null?void 0:Y.data)==null?void 0:ee.message)||"Failed to update leave request")}}),P=U=>{U.preventDefault();const Y=new FormData(U.currentTarget);if(a==="student"){const ee={studentId:(t==null?void 0:t.role)==="student"?(t==null?void 0:t.id)||0:parseInt(Y.get("studentId")),batchId:parseInt(Y.get("batchId")),startDate:Y.get("startDate"),endDate:Y.get("endDate"),reason:Y.get("reason")||void 0};O.mutate(ee)}else if(a==="employee"){const ee={employeeId:(t==null?void 0:t.role)==="employee"?(t==null?void 0:t.id)||0:parseInt(Y.get("employeeId")),startDate:Y.get("startDate"),endDate:Y.get("endDate"),reason:Y.get("reason")||void 0};q.mutate(ee)}else if(a==="faculty"){const ee={facultyId:(t==null?void 0:t.role)==="faculty"?(t==null?void 0:t.id)||0:parseInt(Y.get("facultyId")),startDate:Y.get("startDate"),endDate:Y.get("endDate"),reason:Y.get("reason")||void 0};v.mutate(ee)}},T=U=>{f(U),d(!0)},x=U=>{if(U.preventDefault(),!m)return;const Y=new FormData(U.currentTarget),ee=Y.get("approve")==="true",Ce=Y.get("rejectionReason")||void 0;a==="student"?B.mutate({id:m.id,approve:ee,rejectionReason:Ce}):a==="employee"?D.mutate({id:m.id,approve:ee,rejectionReason:Ce}):a==="faculty"&&M.mutate({id:m.id,approve:ee,rejectionReason:Ce})},R=()=>a==="student"?(c==null?void 0:c.data.leaves)||[]:a==="employee"?(i==null?void 0:i.data.leaves)||[]:a==="faculty"?(E==null?void 0:E.data.leaves)||[]:[],y=()=>a==="student"?u:a==="employee"?C:a==="faculty"?h:!1,K=()=>(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||a==="student"&&(t==null?void 0:t.role)==="student"||a==="employee"&&(t==null?void 0:t.role)==="employee"||a==="faculty"&&(t==null?void 0:t.role)==="faculty",Q=()=>(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin",ue=R(),$=p==="all"?ue:ue.filter(U=>U.status===p);return e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Leave Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage leave requests for all users"})]}),K()&&e.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ Request Leave"})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex -mb-px",children:[((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="student")&&e.jsx("button",{onClick:()=>r("student"),className:`px-6 py-3 text-sm font-medium ${a==="student"?"border-b-2 border-orange-500 text-orange-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Student Leaves"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="employee")&&e.jsx("button",{onClick:()=>r("employee"),className:`px-6 py-3 text-sm font-medium ${a==="employee"?"border-b-2 border-orange-500 text-orange-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Employee Leaves"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="faculty")&&e.jsx("button",{onClick:()=>r("faculty"),className:`px-6 py-3 text-sm font-medium ${a==="faculty"?"border-b-2 border-orange-500 text-orange-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Faculty Leaves"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4 flex gap-2",children:[e.jsx("button",{onClick:()=>b("all"),className:`px-4 py-2 rounded-lg text-sm font-medium ${p==="all"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"All"}),e.jsx("button",{onClick:()=>b(Ne.PENDING),className:`px-4 py-2 rounded-lg text-sm font-medium ${p===Ne.PENDING?"bg-yellow-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Pending"}),e.jsx("button",{onClick:()=>b(Ne.APPROVED),className:`px-4 py-2 rounded-lg text-sm font-medium ${p===Ne.APPROVED?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Approved"}),e.jsx("button",{onClick:()=>b(Ne.REJECTED),className:`px-4 py-2 rounded-lg text-sm font-medium ${p===Ne.REJECTED?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Rejected"})]}),y()?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):$.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No leave requests found"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[a==="student"&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),a==="employee"&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),a==="faculty"&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Faculty"}),a==="student"&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Start Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"End Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reason"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),Q()&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$.map(U=>{var Y,ee,Ce,Me,qe,$e,Je,Ge;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[a==="student"&&e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((Y=U.student)==null?void 0:Y.name)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:(ee=U.student)==null?void 0:ee.email})]}),a==="employee"&&e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((Ce=U.employee)==null?void 0:Ce.name)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:(Me=U.employee)==null?void 0:Me.email})]}),a==="faculty"&&e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((qe=U.faculty)==null?void 0:qe.name)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:($e=U.faculty)==null?void 0:$e.email})]}),a==="student"&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:((Je=U.batch)==null?void 0:Je.title)||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(U.startDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(U.endDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:U.reason||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${U.status===Ne.APPROVED?"bg-green-100 text-green-800":U.status===Ne.REJECTED?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:U.status})}),Q()&&U.status===Ne.PENDING&&e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("button",{onClick:()=>T(U),className:"text-green-600 hover:text-green-900 mr-3",children:"Approve"}),e.jsx("button",{onClick:()=>T(U),className:"text-red-600 hover:text-red-900",children:"Reject"})]}),Q()&&U.status!==Ne.PENDING&&e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[((Ge=U.approver)==null?void 0:Ge.name)&&`By ${U.approver.name}`,U.approvedAt&&` on ${new Date(U.approvedAt).toLocaleDateString()}`]})]},U.id)})})]})})]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Request Leave"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:P,children:[a==="student"&&e.jsxs(e.Fragment,{children:[((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student *"}),e.jsxs("select",{name:"studentId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",disabled:!((_=A==null?void 0:A.data)!=null&&_.users),children:[e.jsx("option",{value:"",children:(G=A==null?void 0:A.data)!=null&&G.users?"Select Student":"Loading..."}),(oe=(se=A==null?void 0:A.data)==null?void 0:se.users)==null?void 0:oe.map(U=>e.jsxs("option",{value:U.id,children:[U.name," (",U.email,")"]},U.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch *"}),e.jsxs("select",{name:"batchId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select Batch"}),(xe=k==null?void 0:k.data)==null?void 0:xe.map(U=>e.jsx("option",{value:U.id,children:U.title},U.id))]})]})]}),a==="employee"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee *"}),e.jsxs("select",{name:"employeeId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",disabled:!((be=g==null?void 0:g.data)!=null&&be.users),children:[e.jsx("option",{value:"",children:(I=g==null?void 0:g.data)!=null&&I.users?"Select Employee":"Loading..."}),(Z=(z=g==null?void 0:g.data)==null?void 0:z.users)==null?void 0:Z.map(U=>e.jsxs("option",{value:U.id,children:[U.name," (",U.email,")"]},U.id))]})]}),a==="faculty"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty *"}),e.jsxs("select",{name:"facultyId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",disabled:!((de=w==null?void 0:w.data)!=null&&de.users),children:[e.jsx("option",{value:"",children:(ce=w==null?void 0:w.data)!=null&&ce.users?"Select Faculty":"Loading..."}),(je=(ke=w==null?void 0:w.data)==null?void 0:ke.users)==null?void 0:je.map(U=>e.jsxs("option",{value:U.id,children:[U.name," (",U.email,")"]},U.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",name:"startDate",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),e.jsx("input",{type:"date",name:"endDate",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason"}),e.jsx("textarea",{name:"reason",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:a==="student"&&O.isPending||a==="employee"&&q.isPending||a==="faculty"&&v.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:O.isPending||q.isPending||v.isPending?"Submitting...":"Submit Request"}),e.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),o&&m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:m.status===Ne.PENDING?"Approve/Reject Leave":"Leave Details"}),e.jsx("button",{onClick:()=>{d(!1),f(null)},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),m.status===Ne.PENDING?e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action *"}),e.jsxs("select",{name:"approve",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"true",children:"Approve"}),e.jsx("option",{value:"false",children:"Reject"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejection Reason (if rejecting)"}),e.jsx("textarea",{name:"rejectionReason",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:a==="student"&&B.isPending||a==="employee"&&D.isPending||a==="faculty"&&M.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:B.isPending||D.isPending||M.isPending?"Processing...":"Submit"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),f(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:m.status})]}),m.rejectionReason&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Rejection Reason"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:m.rejectionReason})]}),m.approver&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Approved By"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:m.approver.name})]}),e.jsx("button",{onClick:()=>{d(!1),f(null)},className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Close"})]})]})})]})},On=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Mn=()=>{const{user:t}=re(),s=ye(),a=le(),[r,n]=N.useState(null),[l,o]=N.useState(!1),[d,m]=N.useState(!1),[f,p]=N.useState(!1),[b,c]=N.useState({}),[u,i]=N.useState(!1),{data:C,isLoading:E}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches()}),h=W({mutationFn:({id:M,data:P})=>ge.updateBatch(M,P),onSuccess:()=>{a.invalidateQueries({queryKey:["batches"]}),m(!1),n(null),c({}),i(!1),alert("Batch updated successfully!")},onError:M=>{var P,T;alert(((T=(P=M.response)==null?void 0:P.data)==null?void 0:T.message)||"Failed to update batch")}}),k=W({mutationFn:M=>ge.deleteBatch(M),onSuccess:()=>{a.invalidateQueries({queryKey:["batches"]}),p(!1),n(null),alert("Batch deleted successfully!")},onError:M=>{var P,T;alert(((T=(P=M.response)==null?void 0:P.data)==null?void 0:T.message)||"Failed to delete batch")}}),A=(C==null?void 0:C.data)||[],g=M=>{n(M),o(!0)},w=M=>{n(M),c(M.schedule||{}),i(!1),m(!0)},O=M=>{c(P=>{if(P[M]){const T={...P};return delete T[M],T}else return{...P,[M]:{startTime:"",endTime:""}}})},q=(M,P,T)=>{c(x=>{const R={...x};return u?Object.keys(x).forEach(y=>{R[y]={...x[y],[P]:T}}):R[M]={...x[M],[P]:T},R})},v=M=>{n(M),p(!0)},B=()=>{r&&k.mutate(r.id)},D=M=>{if(M.preventDefault(),!r)return;const P=new FormData(M.currentTarget),T={title:P.get("title")||void 0,software:P.get("software")||void 0,mode:P.get("mode")||void 0,startDate:P.get("startDate")||void 0,endDate:P.get("endDate")||void 0,maxCapacity:P.get("maxCapacity")?parseInt(P.get("maxCapacity")):void 0,status:P.get("status")||void 0,schedule:Object.keys(b).length>0?Object.fromEntries(Object.entries(b).filter(([x,R])=>R.startTime&&R.endTime)):void 0};h.mutate({id:r.id,data:T})};return E?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Batch Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage training batches"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("button",{onClick:()=>s("/batches/create"),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ Create Batch"})]})}),e.jsx("div",{className:"p-6",children:A.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No batches found"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(M=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:M.title}),M.software&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Software:"})," ",M.software]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Mode:"})," ",M.mode]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Start:"})," ",new Date(M.startDate).toLocaleDateString()]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"End:"})," ",new Date(M.endDate).toLocaleDateString()]}),M.maxCapacity&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Capacity:"})," ",M.maxCapacity]}),M.status&&e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-semibold ${M.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:M.status}),e.jsxs("div",{className:"mt-4 flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>g(M),className:"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600 transition-colors",title:"View Batch",children:"ðŸ‘ï¸ View"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(M),className:"px-3 py-1 bg-orange-500 text-white rounded text-sm hover:bg-orange-600 transition-colors",title:"Edit Batch",children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>v(M),className:"px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600 transition-colors",title:"Delete Batch",children:"ðŸ—‘ï¸ Delete"})]})]})]},M.id))})})]})}),l&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Batch Details"}),e.jsx("button",{onClick:()=>{o(!1),n(null)},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.title})]}),r.software&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Software"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.software})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mode"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:r.mode})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(r.startDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(r.endDate).toLocaleDateString()})]})]}),r.maxCapacity&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Max Capacity"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.maxCapacity})]}),r.status&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx("span",{className:`inline-block mt-1 px-2 py-1 rounded text-xs font-semibold ${r.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:r.status})]}),r.schedule&&Object.keys(r.schedule).length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule"}),e.jsx("div",{className:"space-y-2",children:Object.entries(r.schedule).map(([M,P])=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:M}),e.jsxs("span",{className:"text-sm text-gray-600",children:[P.startTime," - ",P.endTime]})]},M))})]}),r.enrollments&&r.enrollments.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enrolled Students"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.enrollments.length})]}),r.assignedFaculty&&r.assignedFaculty.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Faculty"}),e.jsx("div",{className:"mt-1",children:r.assignedFaculty.map(M=>e.jsxs("p",{className:"text-sm text-gray-900",children:[M.name," (",M.email,")"]},M.id))})]}),r.createdAt&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created At"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(r.createdAt).toLocaleString()})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>{o(!1),n(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Close"})})]})}),d&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Edit Batch"}),e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),e.jsx("input",{type:"text",name:"title",defaultValue:r.title,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Software"}),e.jsx("input",{type:"text",name:"software",defaultValue:r.software||"",placeholder:"e.g., Adobe Photoshop, Figma",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode *"}),e.jsxs("select",{name:"mode",defaultValue:r.mode,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"online",children:"Online"}),e.jsx("option",{value:"offline",children:"Offline"}),e.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",name:"startDate",defaultValue:r.startDate.split("T")[0],required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),e.jsx("input",{type:"date",name:"endDate",defaultValue:r.endDate.split("T")[0],required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Capacity"}),e.jsx("input",{type:"number",name:"maxCapacity",min:"1",defaultValue:r.maxCapacity||"",placeholder:"e.g., 30",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"status",defaultValue:r.status||"active",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Schedule (Optional)"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select days and set start/end times for each day"}),e.jsxs("div",{className:"mb-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:M=>i(M.target.checked),className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Apply same time to all selected days"})]}),e.jsx("p",{className:"ml-6 mt-1 text-xs text-gray-600",children:"When enabled, changing time on any day will update all selected days"})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:On.map(M=>{const P=!!b[M],T=b[M]||{startTime:"",endTime:""};return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:P,onChange:()=>O(M),className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:M})]})}),P&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-2 pl-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Start Time"}),e.jsx("input",{type:"time",value:T.startTime,onChange:x=>q(M,"startTime",x.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"End Time"}),e.jsx("input",{type:"time",value:T.endTime,onChange:x=>q(M,"endTime",x.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"})]})]})]},M)})})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",disabled:h.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:h.isPending?"Updating...":"Update"}),e.jsx("button",{type:"button",onClick:()=>{m(!1),n(null),c({}),i(!1)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),f&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Delete Batch"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["Are you sure you want to delete ",e.jsx("strong",{children:r.title}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:B,disabled:k.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors disabled:opacity-50",children:k.isPending?"Deleting...":"Delete"}),e.jsx("button",{onClick:()=>{p(!1),n(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})})]})},qn=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ln=()=>{const{user:t}=re(),s=ye(),a=le(),[r,n]=N.useState({}),[l,o]=N.useState(!1),[d,m]=N.useState([]),[f,p]=N.useState(!1),[b,c]=N.useState([]),[u,i]=N.useState(!1),[C,E]=N.useState(""),[h,k]=N.useState([]),{data:A}=H({queryKey:["students"],queryFn:()=>Pe.getAllStudents()}),g=W({mutationFn:async P=>{const T=await ge.createBatch(P);if(d.length>0&&T.data.batch){const x=d.map(R=>Pe.createEnrollment({studentId:R,batchId:T.data.batch.id,enrollmentDate:new Date().toISOString().split("T")[0],status:"active"}).catch(y=>(console.error(`Failed to enroll student ${R}:`,y),null)));await Promise.all(x)}return T},onSuccess:()=>{a.invalidateQueries({queryKey:["batches"]}),a.invalidateQueries({queryKey:["students"]}),alert("Batch created successfully!"),s("/batches")},onError:P=>{var T,x;alert(((x=(T=P.response)==null?void 0:T.data)==null?void 0:x.message)||"Failed to create batch")}}),w=P=>{n(T=>{if(T[P]){const x={...T};return delete x[P],x}else return{...T,[P]:{startTime:"",endTime:""}}})},O=(P,T,x)=>{n(R=>{const y={...R};return l?Object.keys(R).forEach(K=>{y[K]={...R[K],[T]:x}}):y[P]={...R[P],[T]:x},y})},q=P=>{P.preventDefault();const T=new FormData(P.currentTarget),x=h.length>0?h.join(", "):void 0,R={title:T.get("title"),software:x,mode:T.get("mode"),startDate:T.get("startDate"),endDate:T.get("endDate"),maxCapacity:T.get("maxCapacity")?parseInt(T.get("maxCapacity")):void 0,status:T.get("status")||"active",schedule:Object.keys(r).length>0?Object.fromEntries(Object.entries(r).filter(([y,K])=>K.startTime&&K.endTime)):void 0};g.mutate(R)},v=async()=>{var y,K;const P=document.querySelector("form");if(!P)return;const T=new FormData(P),x=h.length>0?h.join(", "):void 0,R=T.get("startDate");if(!x||!R){alert("Please select software and enter start date first to get suggestions");return}try{const Q={title:"TEMP_FOR_SUGGESTIONS",software:x,mode:T.get("mode")||"online",startDate:R,endDate:T.get("endDate")||R,maxCapacity:100},ue=await ge.createBatch(Q);if(ue.data.batch){const $=await ge.suggestCandidates(ue.data.batch.id);c($.data.candidates),p(!0);try{await ge.deleteBatch(ue.data.batch.id)}catch(_){console.error("Failed to delete temp batch:",_)}}}catch(Q){alert(((K=(y=Q.response)==null?void 0:y.data)==null?void 0:K.message)||"Failed to get suggestions")}},B=P=>{m(T=>T.includes(P)?T.filter(x=>x!==P):[...T,P])},D=P=>{(P.status==="available"||P.status==="fees_overdue")&&B(P.studentId)},M=(A==null?void 0:A.data.students)||[];return(t==null?void 0:t.role)!=="admin"&&(t==null?void 0:t.role)!=="superadmin"?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg p-6",children:[e.jsx("p",{className:"text-red-600",children:"You don't have permission to create batches."}),e.jsx("button",{onClick:()=>s("/batches"),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Back to Batches"})]})})}):e.jsx(J,{children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Create New Batch"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Fill in the details to create a new training batch"})]}),e.jsx("button",{onClick:()=>s("/batches"),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"â† Back"})]})}),e.jsx("div",{className:"p-8",children:e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Batch Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"title",required:!0,placeholder:"e.g., Digital Art Fundamentals - Batch 1",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Software"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-4 max-h-48 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:["Photoshop","Illustrator","InDesign","After Effects","Premiere Pro","Figma","Sketch","Blender","Maya","3ds Max","Cinema 4D","Lightroom","CorelDRAW","AutoCAD","SolidWorks","Revit","SketchUp","Unity","Unreal Engine","DaVinci Resolve","Final Cut Pro","Procreate","Affinity Designer","Affinity Photo","Canva Pro","Other"].map(P=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",checked:P==="Other"?u:h.includes(P),onChange:T=>{P==="Other"?i(T.target.checked):T.target.checked?k(x=>[...x,P]):k(x=>x.filter(R=>R!==P))},className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:P})]},P))})}),u&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Specify Other Software"}),e.jsx("input",{type:"text",value:C,onChange:P=>{const T=P.target.value;if(E(T),T.trim()){const x=T.split(",").map(R=>R.trim()).filter(R=>R);k(R=>[...R.filter(K=>["Photoshop","Illustrator","InDesign","After Effects","Premiere Pro","Figma","Sketch","Blender","Maya","3ds Max","Cinema 4D","Lightroom","CorelDRAW","AutoCAD","SolidWorks","Revit","SketchUp","Unity","Unreal Engine","DaVinci Resolve","Final Cut Pro","Procreate","Affinity Designer","Affinity Photo","Canva Pro"].includes(K)),...x])}else k(x=>x.filter(R=>["Photoshop","Illustrator","InDesign","After Effects","Premiere Pro","Figma","Sketch","Blender","Maya","3ds Max","Cinema 4D","Lightroom","CorelDRAW","AutoCAD","SolidWorks","Revit","SketchUp","Unity","Unreal Engine","DaVinci Resolve","Final Cut Pro","Procreate","Affinity Designer","Affinity Photo","Canva Pro"].includes(R)))},placeholder:"Enter software names (comma separated)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),h.length>0&&e.jsxs("p",{className:"mt-2 text-xs text-gray-600",children:["Selected: ",h.join(", ")]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mode ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"mode",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select mode"}),e.jsx("option",{value:"online",children:"Online"}),e.jsx("option",{value:"offline",children:"Offline"}),e.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Start Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"startDate",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["End Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"endDate",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Capacity"}),e.jsx("input",{type:"number",name:"maxCapacity",min:"1",placeholder:"e.g., 30",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Maximum number of students allowed in this batch"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{name:"status",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add Students (Optional)"}),e.jsx("button",{type:"button",onClick:v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700 transition-colors",children:"Get Suggested Students"})]}),f&&b.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Suggested Students (based on software)"}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-2",children:b.map(P=>e.jsx("div",{className:`p-2 rounded border cursor-pointer ${P.status==="available"?"bg-green-50 border-green-300 hover:bg-green-100":P.status==="fees_overdue"?"bg-yellow-50 border-yellow-300 hover:bg-yellow-100":"bg-gray-50 border-gray-300 opacity-50"}`,onClick:()=>D(P),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:P.name}),e.jsxs("span",{className:"text-xs text-gray-600 ml-2",children:["(",P.email,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded ${P.status==="available"?"bg-green-200 text-green-800":P.status==="fees_overdue"?"bg-yellow-200 text-yellow-800":"bg-gray-200 text-gray-800"}`,children:P.statusMessage}),e.jsx("input",{type:"checkbox",checked:d.includes(P.studentId),onChange:()=>B(P.studentId),disabled:P.status==="busy",className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"})]})]})},P.studentId))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Students to Enroll"}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-lg p-3 space-y-2",children:M.map(P=>e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.includes(P.id),onChange:()=>B(P.id),className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500 mr-3"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:P.name}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",P.email,")"]})]})]},P.id))}),d.length>0&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[d.length," student(s) selected"]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Schedule (Optional)"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select days and set start/end times for each day"}),e.jsxs("div",{className:"mb-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:P=>o(P.target.checked),className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Apply same time to all selected days"})]}),e.jsx("p",{className:"ml-6 mt-1 text-xs text-gray-600",children:"When enabled, changing time on any day will update all selected days"})]}),e.jsx("div",{className:"space-y-4",children:qn.map(P=>{const T=!!r[P],x=r[P]||{startTime:"",endTime:""};return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:()=>w(P),className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700",children:P})]})}),T&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3 pl-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Start Time"}),e.jsx("input",{type:"time",value:x.startTime,onChange:R=>O(P,"startTime",R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"End Time"}),e.jsx("input",{type:"time",value:x.endTime,onChange:R=>O(P,"endTime",R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"})]})]})]},P)})})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"submit",disabled:g.isPending,className:"flex-1 px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g.isPending?"Creating...":"Create Batch"}),e.jsx("button",{type:"button",onClick:()=>s("/batches"),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})})]})})})},mt={getAllFaculty:async()=>(await L.get("/users",{params:{role:"faculty"}})).data,createFacultyProfile:async t=>(await L.post("/faculty",t)).data,updateFacultyProfile:async(t,s)=>(await L.put(`/users/${t}/faculty-profile`,s)).data},ut={uploadFile:async t=>{const s=new FormData;return s.append("files",t),(await L.post("/upload",s,{headers:{"Content-Type":"multipart/form-data"}})).data},uploadMultipleFiles:async t=>{const s=new FormData;return t.forEach(r=>{s.append("files",r)}),(await L.post("/upload",s,{headers:{"Content-Type":"multipart/form-data"}})).data}},Tn=()=>{var O,q;const{user:t}=re(),s=ye(),a=le(),[r,n]=N.useState(null),[l,o]=N.useState(!1),[d,m]=N.useState(!1),[f,p]=N.useState(null),[b,c]=N.useState(!1),{data:u,isLoading:i,error:C}=H({queryKey:["faculty"],queryFn:()=>mt.getAllFaculty(),retry:1}),E=W({mutationFn:v=>me.deleteUser(v),onSuccess:()=>{a.invalidateQueries({queryKey:["faculty"]}),o(!1),n(null),alert("Faculty deleted successfully!")},onError:v=>{var B,D;alert(((D=(B=v.response)==null?void 0:B.data)==null?void 0:D.message)||"Failed to delete faculty")}}),h=W({mutationFn:({userId:v,avatarUrl:B})=>me.updateUser(v,{avatarUrl:B}),onSuccess:()=>{a.invalidateQueries({queryKey:["faculty"]}),m(!1),n(null),p(null),alert("Image updated successfully!")},onError:v=>{var B,D;alert(((D=(B=v.response)==null?void 0:B.data)==null?void 0:D.message)||"Failed to update image"),c(!1)}}),k=async v=>{var M,P,T;const B=(M=v.target.files)==null?void 0:M[0];if(!B||!r)return;if(!B.type.startsWith("image/")){alert("Please select an image file");return}if(B.size>5*1024*1024){alert("Image size must be less than 5MB");return}const D=new FileReader;D.onloadend=()=>{p(D.result)},D.readAsDataURL(B),c(!0);try{const x=await ut.uploadFile(B);if(x.data.files.length>0){const R=x.data.files[0].url;h.mutate({userId:r.id,avatarUrl:R})}}catch(x){alert(((T=(P=x.response)==null?void 0:P.data)==null?void 0:T.message)||"Failed to upload image"),c(!1)}},A=(u==null?void 0:u.data.users)||[],g=v=>{n(v),o(!0)},w=()=>{r&&E.mutate(r.id)};return i?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):C?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"bg-white shadow-xl rounded-lg p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600 text-lg mb-4",children:"Error loading faculty data"}),e.jsx("p",{className:"text-gray-500 text-sm",children:((q=(O=C==null?void 0:C.response)==null?void 0:O.data)==null?void 0:q.message)||(C==null?void 0:C.message)||"Unknown error"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Retry"})]})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Faculty Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage faculty members"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("button",{onClick:()=>window.location.href="/faculty/register",className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ New Faculty Registration"})]})}),e.jsx("div",{className:"p-6",children:A.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No faculty members found"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(v=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:v.avatarUrl?e.jsx("img",{src:v.avatarUrl,alt:v.name,className:"h-16 w-16 rounded-full object-cover border-2 border-orange-200",onError:B=>{B.target.src="https://ui-avatars.com/api/?name="+encodeURIComponent(v.name)+"&background=orange&color=fff"}}):e.jsx("div",{className:"h-16 w-16 rounded-full bg-orange-500 flex items-center justify-center text-white font-semibold text-xl",children:v.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:v.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:v.email}),v.phone&&e.jsx("p",{className:"text-sm text-gray-600",children:v.phone})]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${v.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:v.isActive?"Active":"Inactive"})]}),v.facultyProfile&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[v.facultyProfile.expertise&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Expertise:"})," ",v.facultyProfile.expertise]}),v.facultyProfile.availability&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Availability:"})," ",v.facultyProfile.availability]})]}),!v.facultyProfile&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-500 italic",children:"No faculty profile created yet"})}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>{n(v),p(v.avatarUrl||null),m(!0)},className:"w-full px-3 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors",children:"ðŸ“· Update Photo"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>s(`/faculty/${v.id}/edit`),className:"flex-1 px-3 py-2 bg-orange-600 text-white rounded text-sm hover:bg-orange-700 transition-colors",children:"âœï¸ Edit"}),(t==null?void 0:t.role)==="superadmin"&&e.jsx("button",{onClick:()=>g(v),className:"flex-1 px-3 py-2 bg-red-600 text-white rounded text-sm hover:bg-red-700 transition-colors",children:"ðŸ—‘ï¸ Delete"})]})]})]},v.id))})})]})}),l&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Delete Faculty"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["Are you sure you want to delete ",e.jsx("strong",{children:r.name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:w,disabled:E.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors disabled:opacity-50",children:E.isPending?"Deleting...":"Delete"}),e.jsx("button",{onClick:()=>{o(!1),n(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})}),d&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Update Faculty Photo"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"Faculty:"})," ",r.name]}),e.jsx("div",{className:"flex justify-center mb-4",children:f?e.jsx("img",{src:f,alt:"Preview",className:"h-32 w-32 rounded-full object-cover border-4 border-orange-500"}):e.jsx("div",{className:"h-32 w-32 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"No image"})})}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image (JPG, PNG - Max 5MB)"}),e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png",onChange:k,disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{type:"button",onClick:()=>{m(!1),n(null),p(null)},disabled:b,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors disabled:opacity-50",children:b?"Uploading...":"Close"})})]})})]})},Bn=()=>{var f,p;const{id:t}=Pt(),{user:s}=re(),a=ye(),r=le(),{data:n,isLoading:l}=H({queryKey:["faculty",t],queryFn:async()=>(await L.get(`/users/${t}`)).data.data.user,enabled:!!t}),o=W({mutationFn:b=>me.updateUser(Number(t),b),onSuccess:()=>{r.invalidateQueries({queryKey:["faculty",t]}),r.invalidateQueries({queryKey:["faculty"]})}}),d=W({mutationFn:b=>mt.updateFacultyProfile(Number(t),b),onSuccess:()=>{r.invalidateQueries({queryKey:["faculty",t]}),r.invalidateQueries({queryKey:["faculty"]}),alert("Faculty updated successfully!"),a("/faculty")},onError:b=>{var c,u;alert(((u=(c=b.response)==null?void 0:c.data)==null?void 0:u.message)||"Failed to update faculty profile")}});if((s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="superadmin")return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg p-6",children:[e.jsx("p",{className:"text-red-600",children:"You don't have permission to edit faculty."}),e.jsx("button",{onClick:()=>a("/faculty"),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Back to Faculty"})]})})});if(l)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})});if(!n)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg p-6",children:[e.jsx("p",{className:"text-red-600",children:"Faculty not found."}),e.jsx("button",{onClick:()=>a("/faculty"),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Back to Faculty"})]})})});const m=b=>{b.preventDefault();const c=new FormData(b.currentTarget),u={name:c.get("name")||void 0,email:c.get("email")||void 0,phone:c.get("phone")||void 0,isActive:c.get("isActive")==="true"},i={expertise:c.get("expertise")||void 0,availability:c.get("availability")||void 0};o.mutate(u,{onSuccess:()=>{i.expertise||i.availability?d.mutate(i):(alert("Faculty updated successfully!"),a("/faculty"))}})};return e.jsx(J,{children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Edit Faculty"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Update faculty information"})]}),e.jsx("button",{onClick:()=>a("/faculty"),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"â† Back"})]})}),e.jsx("div",{className:"p-8",children:e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),e.jsx("input",{type:"text",name:"name",defaultValue:n.name,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",defaultValue:n.email,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",defaultValue:n.phone||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),e.jsxs("select",{name:"isActive",defaultValue:n.isActive?"true":"false",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Faculty Profile"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expertise"}),e.jsx("textarea",{name:"expertise",rows:4,defaultValue:((f=n.facultyProfile)==null?void 0:f.expertise)||"",placeholder:"e.g., Digital Art, Photoshop, Illustrator, UI/UX Design",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"List the areas of expertise for this faculty member"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Availability"}),e.jsx("textarea",{name:"availability",rows:4,defaultValue:((p=n.facultyProfile)==null?void 0:p.availability)||"",placeholder:"e.g., Monday-Friday, 9 AM - 5 PM",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify the availability schedule for this faculty member"})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"submit",disabled:o.isPending||d.isPending,className:"flex-1 px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:o.isPending||d.isPending?"Saving...":"Save Changes"}),e.jsx("button",{type:"button",onClick:()=>a("/faculty"),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})})]})})})},Un=()=>{const{user:t}=re(),s=ye(),a=le(),[r,n]=N.useState(!1),[l,o]=N.useState(!1),[d,m]=N.useState(!1),[f,p]=N.useState(!1),[b,c]=N.useState(!1),[u,i]=N.useState(null),[C,E]=N.useState(null),[h,k]=N.useState(!1),[A,g]=N.useState(!1),[w,O]=N.useState(null),{data:q,isLoading:v}=H({queryKey:["students"],queryFn:()=>Pe.getAllStudents()}),{data:B}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches()}),{data:D,isLoading:M}=H({queryKey:["student-profile",u==null?void 0:u.id],queryFn:()=>me.getUser(u.id),enabled:!!u&&d}),{data:P}=H({queryKey:["software-completions",u==null?void 0:u.id],queryFn:()=>st.getCompletions({studentId:u==null?void 0:u.id}),enabled:!!u&&d}),T=W({mutationFn:I=>Pe.createEnrollment(I),onSuccess:()=>{a.invalidateQueries({queryKey:["students"]}),a.invalidateQueries({queryKey:["batches"]}),n(!1),alert("Student enrolled successfully!")},onError:I=>{var z,Z;alert(((Z=(z=I.response)==null?void 0:z.data)==null?void 0:Z.message)||"Failed to enroll student. Please check if the enrollment endpoint exists in the backend.")}}),x=W({mutationFn:({userId:I,avatarUrl:z})=>me.updateUser(I,{avatarUrl:z}),onSuccess:()=>{a.invalidateQueries({queryKey:["students"]}),o(!1),i(null),E(null),alert("Image updated successfully!")},onError:I=>{var z,Z;alert(((Z=(z=I.response)==null?void 0:z.data)==null?void 0:Z.message)||"Failed to update image"),k(!1)}}),R=W({mutationFn:I=>me.deleteUser(I),onSuccess:()=>{a.invalidateQueries({queryKey:["students"]}),p(!1),i(null),alert("Student deleted successfully!")},onError:I=>{var z,Z;alert(((Z=(z=I.response)==null?void 0:z.data)==null?void 0:Z.message)||"Failed to delete student")}}),y=W({mutationFn:I=>Pe.bulkEnrollStudents(I),onSuccess:I=>{O(I.data),a.invalidateQueries({queryKey:["students"]}),a.invalidateQueries({queryKey:["batches"]}),g(!1),I.data.failed===0&&(alert(`Successfully enrolled ${I.data.success} student(s)!`),c(!1),O(null))},onError:I=>{var z,Z;g(!1),alert(((Z=(z=I.response)==null?void 0:z.data)==null?void 0:Z.message)||"Failed to bulk enroll students")}}),K=async()=>{var I,z;try{const Z=await Pe.downloadEnrollmentTemplate(),de=window.URL.createObjectURL(Z),ce=document.createElement("a");ce.href=de,ce.download="student_enrollment_template.xlsx",document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),window.URL.revokeObjectURL(de)}catch(Z){alert(((z=(I=Z.response)==null?void 0:I.data)==null?void 0:z.message)||"Failed to download template")}},Q=async I=>{I.preventDefault();const Z=new FormData(I.currentTarget).get("file");if(!Z){alert("Please select a file");return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(Z.type)){alert("Invalid file type. Only Excel files (.xlsx, .xls) and CSV files are allowed.");return}g(!0),O(null),y.mutate(Z)},ue=async I=>{var de,ce,ke;const z=(de=I.target.files)==null?void 0:de[0];if(!z||!u)return;if(!z.type.startsWith("image/")){alert("Please select an image file");return}if(z.size>5*1024*1024){alert("Image size must be less than 5MB");return}const Z=new FileReader;Z.onloadend=()=>{E(Z.result)},Z.readAsDataURL(z),k(!0);try{const je=await ut.uploadFile(z);if(je.data.files.length>0){const U=je.data.files[0].url;x.mutate({userId:u.id,avatarUrl:U})}}catch(je){alert(((ke=(ce=je.response)==null?void 0:ce.data)==null?void 0:ke.message)||"Failed to upload image"),k(!1)}},$=(q==null?void 0:q.data.students)||[],_=(B==null?void 0:B.data)||[],G=I=>{I.preventDefault();const z=new FormData(I.currentTarget),Z={studentId:parseInt(z.get("studentId")),batchId:parseInt(z.get("batchId")),enrollmentDate:z.get("enrollmentDate")||new Date().toISOString().split("T")[0],status:z.get("status")||"active"};T.mutate(Z)},se=I=>{i(I),m(!0)},oe=I=>{s(`/students/${I.id}/edit`)},xe=I=>{i(I),p(!0)},be=()=>{u&&R.mutate(u.id)};return v?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Student Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage students and enrollments"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>s("/students/enroll"),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ New Enrollment"}),e.jsx("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-orange-700 text-white rounded-lg font-semibold hover:bg-orange-800 transition-colors",children:"Enroll Existing Student"}),e.jsx("button",{onClick:K,className:"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors",children:"ðŸ“¥ Download Template"}),e.jsx("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:"ðŸ“¤ Bulk Upload"})]})]})}),e.jsx("div",{className:"p-6",children:$.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No students found"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Photo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined Date"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$.map(I=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:I.avatarUrl?e.jsx("img",{src:I.avatarUrl,alt:I.name,className:"h-12 w-12 rounded-full object-cover border-2 border-gray-200",onError:z=>{z.target.src="https://ui-avatars.com/api/?name="+encodeURIComponent(I.name)+"&background=orange&color=fff"}}):e.jsx("div",{className:"h-12 w-12 rounded-full bg-orange-500 flex items-center justify-center text-white font-semibold text-lg",children:I.name.charAt(0).toUpperCase()})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:I.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:I.phone||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:I.createdAt?new Date(I.createdAt).toLocaleDateString():"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>se(I),className:"text-blue-600 hover:text-blue-900",title:"View Student",children:"ðŸ‘ï¸ View"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{i(I),E(I.avatarUrl||null),o(!0)},className:"text-blue-600 hover:text-blue-900",title:"Update Photo",children:"ðŸ“· Photo"}),e.jsx("button",{onClick:()=>oe(I),className:"text-orange-600 hover:text-orange-900",title:"Edit Student",children:"âœï¸ Edit"}),(t==null?void 0:t.role)==="superadmin"&&e.jsx("button",{onClick:()=>xe(I),className:"text-red-600 hover:text-red-900",title:"Delete Student",children:"ðŸ—‘ï¸ Delete"})]})]})})]},I.id))})]})})})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Enroll Student in Batch"}),e.jsxs("form",{onSubmit:G,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student *"}),e.jsxs("select",{name:"studentId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a student"}),$.map(I=>e.jsxs("option",{value:I.id,children:[I.name," (",I.email,")"]},I.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch *"}),e.jsxs("select",{name:"batchId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a batch"}),_.map(I=>e.jsxs("option",{value:I.id,children:[I.title," ",I.software?`- ${I.software}`:""," (",I.mode,")"]},I.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enrollment Date *"}),e.jsx("input",{type:"date",name:"enrollmentDate",required:!0,defaultValue:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"status",defaultValue:"active",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," This enrollment form requires a backend endpoint at ",e.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"POST /api/enrollments"}),". If the endpoint doesn't exist, you may need to create it in the backend."]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:T.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:T.isPending?"Enrolling...":"Enroll Student"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),l&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Update Student Photo"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"Student:"})," ",u.name]}),e.jsx("div",{className:"flex justify-center mb-4",children:C?e.jsx("img",{src:C,alt:"Preview",className:"h-32 w-32 rounded-full object-cover border-4 border-orange-500"}):e.jsx("div",{className:"h-32 w-32 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"No image"})})}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image (JPG, PNG - Max 5MB)"}),e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png",onChange:ue,disabled:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{type:"button",onClick:()=>{o(!1),i(null),E(null)},disabled:h,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors disabled:opacity-50",children:h?"Uploading...":"Close"})})]})}),d&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Student Profile"}),e.jsx("button",{onClick:()=>{m(!1),i(null)},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),M?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center mb-6",children:(()=>{var Z;const I=((Z=D==null?void 0:D.data.user.studentProfile)==null?void 0:Z.photoUrl)||(D==null?void 0:D.data.user.avatarUrl)||u.avatarUrl,z=(D==null?void 0:D.data.user.name)||u.name;return I?e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:I,alt:z,className:"w-40 h-40 rounded-full object-cover border-4 border-orange-500 shadow-lg mx-auto",onError:de=>{de.target.src="https://ui-avatars.com/api/?name="+encodeURIComponent(z)+"&background=orange&color=fff&size=160"}}),e.jsx("p",{className:"mt-3 text-sm font-medium text-gray-700",children:"Student Photo"})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-40 h-40 rounded-full bg-orange-500 flex items-center justify-center text-white font-bold text-4xl mx-auto shadow-lg",children:z.charAt(0).toUpperCase()}),e.jsx("p",{className:"mt-3 text-sm font-medium text-gray-700",children:"No Photo Available"})]})})()}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 font-medium",children:(D==null?void 0:D.data.user.name)||u.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(D==null?void 0:D.data.user.email)||u.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(D==null?void 0:D.data.user.phone)||u.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx("p",{className:"mt-1",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${D!=null&&D.data.user.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:D!=null&&D.data.user.isActive?"Active":"Inactive"})})]}),(D==null?void 0:D.data.user.createdAt)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Joined Date"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(D.data.user.createdAt).toLocaleDateString()})]}),(D==null?void 0:D.data.user.updatedAt)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Updated"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(D.data.user.updatedAt).toLocaleDateString()})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"Profile Details"}),D!=null&&D.data.user.studentProfile?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:D.data.user.studentProfile.dob?new Date(D.data.user.studentProfile.dob).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enrollment Date"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:D.data.user.studentProfile.enrollmentDate?new Date(D.data.user.studentProfile.enrollmentDate).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Profile Status"}),e.jsx("p",{className:"mt-1",children:D.data.user.studentProfile.status?e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold capitalize ${D.data.user.studentProfile.status==="active"?"bg-green-100 text-green-800":D.data.user.studentProfile.status==="completed"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:D.data.user.studentProfile.status}):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Profile Photo URL"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 break-all",children:D.data.user.studentProfile.photoUrl||"-"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:D.data.user.studentProfile.address||"-"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Software List"}),D.data.user.studentProfile.softwareList&&D.data.user.studentProfile.softwareList.length>0?e.jsx("div",{className:"mt-1 flex flex-wrap gap-2",children:D.data.user.studentProfile.softwareList.map((I,z)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-medium",children:I},z))}):e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"-"})]}),D.data.user.studentProfile.documents&&Object.keys(D.data.user.studentProfile.documents).length>0&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Documents"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 max-h-60 overflow-y-auto",children:e.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap",children:JSON.stringify(D.data.user.studentProfile.documents,null,2)})})]}),D.data.user.studentProfile.createdAt&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Profile Created"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(D.data.user.studentProfile.createdAt).toLocaleDateString()})]}),D.data.user.studentProfile.updatedAt&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Profile Updated"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(D.data.user.studentProfile.updatedAt).toLocaleDateString()})]})]}):e.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-500",children:"No student profile information available."})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"Software Completions"}),P!=null&&P.data.completions&&P.data.completions.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Software"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Start Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"End Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Faculty"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.data.completions.map(I=>{var z,Z;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:I.softwareName}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:((z=I.batch)==null?void 0:z.title)||`Batch ${I.batchId}`}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:new Date(I.startDate).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:new Date(I.endDate).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${I.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:I.status==="completed"?"Completed":"In Progress"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:((Z=I.faculty)==null?void 0:Z.name)||"-"})]},I.id)})})]})}):e.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-500",children:"No software completions found for this student."})})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>{m(!1),i(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Close"})})]})}),f&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Delete Student"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["Are you sure you want to delete ",e.jsx("strong",{children:u.name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:be,disabled:R.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors disabled:opacity-50",children:R.isPending?"Deleting...":"Delete"}),e.jsx("button",{onClick:()=>{p(!1),i(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Bulk Student Enrollment"}),w?e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:`p-4 rounded-lg mb-4 ${w.failed===0?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Upload Results:"}),e.jsxs("p",{className:"text-green-700 font-medium",children:["âœ“ Successfully enrolled: ",w.success," student(s)"]}),w.failed>0&&e.jsxs("p",{className:"text-red-700 font-medium mt-1",children:["âœ— Failed: ",w.failed," student(s)"]})]}),w.errors.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold text-red-700 mb-2",children:"Errors:"}),e.jsx("div",{className:"max-h-40 overflow-y-auto border border-red-200 rounded p-3 bg-red-50",children:w.errors.map((I,z)=>e.jsxs("div",{className:"text-sm text-red-700 mb-1",children:["Row ",I.row,": ",I.error]},z))})]}),e.jsx("button",{onClick:()=>{c(!1),O(null)},className:"w-full px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors",children:"Close"})]}):e.jsxs("form",{onSubmit:Q,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Excel File (.xlsx, .xls, or .csv)"}),e.jsx("input",{type:"file",name:"file",accept:".xlsx,.xls,.csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,text/csv",required:!0,disabled:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50"}),e.jsx("p",{className:"mt-2 text-xs text-gray-600",children:"Maximum file size: 10MB. Download the template to see the required format."})]}),e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," Make sure your Excel file follows the template format. Required fields: studentName, email, phone, dateOfAdmission."]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:A,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50",children:A?"Uploading...":"Upload & Enroll"}),e.jsx("button",{type:"button",onClick:()=>{c(!1),O(null)},disabled:A,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors disabled:opacity-50",children:"Cancel"})]})]})]})})]})},$n=()=>{const t=ye(),s=le(),[a,r]=N.useState(1),n=4,[l,o]=N.useState(!1),[d,m]=N.useState(""),[f,p]=N.useState([]),[b,c]=N.useState([]),{data:u}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches()}),i=W({mutationFn:g=>Pe.completeEnrollment(g),onSuccess:()=>{s.invalidateQueries({queryKey:["students"]}),s.invalidateQueries({queryKey:["batches"]}),alert("Student enrolled successfully!"),t("/students")},onError:g=>{var w,O;alert(((O=(w=g.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to enroll student. Please check all required fields.")}}),C=(u==null?void 0:u.data)||[];N.useEffect(()=>{if(f.length>0){const g=new Date;g.setHours(0,0,0,0);const w=C.filter(O=>{const q=new Date(O.startDate);if(q.setHours(0,0,0,0),q<g)return!1;if(O.software){const v=O.software.toLowerCase();return f.some(B=>v.includes(B.toLowerCase())||B.toLowerCase().includes(v))}return!1});c(w)}else c([])},[f,C]);const E=(g,w)=>{p(w?O=>[...O,g]:O=>O.filter(q=>q!==g))},h=g=>{g.preventDefault();const w=new FormData(g.currentTarget);let q=w.getAll("softwaresIncluded").filter(D=>D!=="Other");l&&d.trim()&&q.push(d.trim());const v=q.length>0?q.join(", "):void 0,B={studentName:w.get("studentName"),email:w.get("email"),phone:w.get("phone"),whatsappNumber:w.get("whatsappNumber")||void 0,dateOfAdmission:w.get("dateOfAdmission"),localAddress:w.get("localAddress")||void 0,permanentAddress:w.get("permanentAddress")||void 0,emergencyContactNumber:w.get("emergencyContactNumber")||void 0,emergencyName:w.get("emergencyName")||void 0,emergencyRelation:w.get("emergencyRelation")||void 0,courseName:w.get("courseName")||void 0,batchId:w.get("batchId")?parseInt(w.get("batchId")):void 0,softwaresIncluded:v,totalDeal:w.get("totalDeal")?parseFloat(w.get("totalDeal")):void 0,bookingAmount:w.get("bookingAmount")?parseFloat(w.get("bookingAmount")):void 0,balanceAmount:w.get("balanceAmount")?parseFloat(w.get("balanceAmount")):void 0,emiPlan:w.get("emiPlan")==="yes",emiPlanDate:w.get("emiPlanDate")||void 0,complimentarySoftware:w.get("complimentarySoftware")||void 0,complimentaryGift:w.get("complimentaryGift")||void 0,hasReference:w.get("hasReference")==="yes",referenceDetails:w.get("referenceDetails")||void 0,counselorName:w.get("counselorName")||void 0,leadSource:w.get("leadSource")||void 0,walkinDate:w.get("walkinDate")||void 0,masterFaculty:w.get("masterFaculty")||void 0};i.mutate(B)},k=()=>{a<n&&r(a+1)},A=()=>{a>1&&r(a-1)};return e.jsx(J,{children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Student Enrollment Form"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Complete student registration and enrollment"})]}),e.jsx("div",{className:"px-8 py-4 bg-gray-50 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:[1,2,3,4].map(g=>e.jsxs(Ie.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold ${a>=g?"bg-orange-600 text-white":"bg-gray-300 text-gray-600"}`,children:g}),e.jsxs("span",{className:`ml-2 text-sm font-medium ${a>=g?"text-orange-600":"text-gray-500"}`,children:[g===1&&"Basic Info",g===2&&"Contact & Address",g===3&&"Course & Financial",g===4&&"Additional Info"]})]}),g<n&&e.jsx("div",{className:`flex-1 h-1 mx-2 ${a>g?"bg-orange-600":"bg-gray-300"}`})]},g))})}),e.jsx("form",{onSubmit:h,children:e.jsxs("div",{className:"p-8",children:[a===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"studentName",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"email",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"phone",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Number"}),e.jsx("input",{type:"tel",name:"whatsappNumber",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Admission ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"dateOfAdmission",required:!0,defaultValue:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]}),a===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Contact & Address Information"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Local Address"}),e.jsx("textarea",{name:"localAddress",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permanent Address"}),e.jsx("textarea",{name:"permanentAddress",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact Number"}),e.jsx("input",{type:"tel",name:"emergencyContactNumber",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact Name"}),e.jsx("input",{type:"text",name:"emergencyName",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Relation"}),e.jsx("input",{type:"text",name:"emergencyRelation",placeholder:"e.g., Father, Mother, Guardian",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]})]}),a===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Course & Financial Details"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Course Name"}),e.jsx("input",{type:"text",name:"courseName",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Batch"}),b.length>0&&e.jsxs("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:"ðŸ’¡ Suggested Batches (based on your software selection)"}),e.jsx("div",{className:"space-y-2",children:b.map(g=>e.jsx("div",{className:"p-2 bg-white border border-blue-300 rounded hover:bg-blue-50 cursor-pointer",onClick:()=>{const w=document.querySelector('select[name="batchId"]');w&&(w.value=g.id.toString())},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:g.title}),g.software&&e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["- ",g.software]}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",g.mode,") | Starts: ",new Date(g.startDate).toLocaleDateString()]})]}),e.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"Suggested"})]})},g.id))})]}),e.jsxs("select",{name:"batchId",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a batch (optional)"}),b.length>0&&e.jsx("optgroup",{label:"Suggested Batches",children:b.map(g=>e.jsxs("option",{value:g.id,children:[g.title," ",g.software?`- ${g.software}`:""," (",g.mode,") - Starts: ",new Date(g.startDate).toLocaleDateString()]},g.id))}),b.length>0&&C.length>b.length&&e.jsx("optgroup",{label:"All Batches",children:C.filter(g=>!b.some(w=>w.id===g.id)).map(g=>e.jsxs("option",{value:g.id,children:[g.title," ",g.software?`- ${g.software}`:""," (",g.mode,")"]},g.id))}),b.length===0&&C.map(g=>e.jsxs("option",{value:g.id,children:[g.title," ",g.software?`- ${g.software}`:""," (",g.mode,")"]},g.id))]}),b.length>0&&e.jsx("p",{className:"mt-1 text-xs text-blue-600",children:"Batches matching your software selection are shown above"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Softwares Included"}),e.jsx("div",{className:"border border-gray-300 rounded-md p-4 max-h-48 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:["Photoshop","Illustrator","InDesign","After Effects","Premiere Pro","Figma","Sketch","Blender","Maya","3ds Max","Cinema 4D","Lightroom","CorelDRAW","AutoCAD","SolidWorks","Revit","SketchUp","Unity","Unreal Engine","DaVinci Resolve","Final Cut Pro","Procreate","Affinity Designer","Affinity Photo","Canva Pro","Other"].map(g=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",name:"softwaresIncluded",value:g,onChange:w=>{g==="Other"?o(w.target.checked):E(g,w.target.checked)},className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:g})]},g))})}),l&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Specify Other Software"}),e.jsx("input",{type:"text",value:d,onChange:g=>{const w=g.target.value;if(m(w),w.trim()){const O=w.trim();f.includes(O)||p(q=>[...q,O])}},placeholder:"Enter software names (comma separated)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Select all applicable software"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Deal Amount (â‚¹)"}),e.jsx("input",{type:"number",name:"totalDeal",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Booking Amount (â‚¹)"}),e.jsx("input",{type:"number",name:"bookingAmount",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Balance Amount (â‚¹)"}),e.jsx("input",{type:"number",name:"balanceAmount",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EMI Plan"}),e.jsxs("select",{name:"emiPlan",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"no",children:"No"}),e.jsx("option",{value:"yes",children:"Yes"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EMI Plan Date"}),e.jsx("input",{type:"date",name:"emiPlanDate",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]})]}),a===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Additional Information"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complimentary Software"}),e.jsx("input",{type:"text",name:"complimentarySoftware",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complimentary Gift"}),e.jsx("input",{type:"text",name:"complimentaryGift",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Has Reference"}),e.jsxs("select",{name:"hasReference",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"no",children:"No"}),e.jsx("option",{value:"yes",children:"Yes"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Details"}),e.jsx("textarea",{name:"referenceDetails",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Counselor Name"}),e.jsx("input",{type:"text",name:"counselorName",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lead Source"}),e.jsxs("select",{name:"leadSource",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select lead source"}),e.jsx("option",{value:"Walk-in",children:"Walk-in"}),e.jsx("option",{value:"Online",children:"Online"}),e.jsx("option",{value:"Reference",children:"Reference"}),e.jsx("option",{value:"Social Media",children:"Social Media"}),e.jsx("option",{value:"Advertisement",children:"Advertisement"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Walk-in Date"}),e.jsx("input",{type:"date",name:"walkinDate",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Master Faculty"}),e.jsx("input",{type:"text",name:"masterFaculty",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:A,disabled:a===1,className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),a<n?e.jsx("button",{type:"button",onClick:k,className:"px-6 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors",children:"Next"}):e.jsx("button",{type:"submit",disabled:i.isPending,className:"px-6 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:i.isPending?"Submitting...":"Submit Enrollment"})]})]})})]})})})},Vn=()=>{var u,i,C,E,h,k,A,g,w;const{id:t}=Pt(),{user:s}=re(),a=ye(),r=le();console.log("StudentEdit component rendered, id:",t,"user:",s);const{data:n,isLoading:l,error:o}=H({queryKey:["student",t],queryFn:async()=>{var O,q;if(!t)throw new Error("Student ID is required");try{console.log("Fetching student data for ID:",t);const v=await me.getUser(Number(t));if(console.log("User response:",v),(O=v==null?void 0:v.data)!=null&&O.user)return v.data.user;throw new Error("Invalid response structure")}catch(v){throw console.error("Error fetching student data:",v),console.error("Error response:",(q=v.response)==null?void 0:q.data),v}},enabled:!!t&&!!s,retry:1}),[d,m]=N.useState(""),f=W({mutationFn:O=>me.updateUser(Number(t),O),onSuccess:()=>{r.invalidateQueries({queryKey:["student",t]}),r.invalidateQueries({queryKey:["students"]})},onError:O=>{var q,v;alert(((v=(q=O.response)==null?void 0:q.data)==null?void 0:v.message)||"Failed to update user information")}}),p=W({mutationFn:O=>me.updateStudentProfile(Number(t),O),onSuccess:()=>{r.invalidateQueries({queryKey:["student",t]}),r.invalidateQueries({queryKey:["students"]}),r.invalidateQueries({queryKey:["student-profile"]})},onError:O=>{var q,v;alert(((v=(q=O.response)==null?void 0:q.data)==null?void 0:v.message)||"Failed to update student profile")}});if(!s)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})});if((s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="superadmin")return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg p-6",children:[e.jsx("p",{className:"text-red-600",children:"You don't have permission to edit students."}),e.jsx("button",{onClick:()=>a("/students"),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Back to Students"})]})})});if(l)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})});if(o)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg p-6",children:[e.jsxs("p",{className:"text-red-600",children:["Error loading student data: ",o instanceof Error?o.message:"Unknown error"]}),e.jsx("button",{onClick:()=>a("/students"),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Back to Students"})]})})});if(!n)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg p-6",children:[e.jsx("p",{className:"text-red-600",children:"Student not found or data is still loading."}),e.jsxs("p",{className:"text-gray-500 mt-2",children:["ID: ",t]}),e.jsx("button",{onClick:()=>a("/students"),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Back to Students"})]})})});const b=O=>{if(!O)return"";try{const q=new Date(O);if(!isNaN(q.getTime()))return q.toISOString().split("T")[0]}catch(q){console.error("Error parsing date:",q)}return""};Ie.useEffect(()=>{var O;(O=n==null?void 0:n.studentProfile)!=null&&O.softwareList&&Array.isArray(n.studentProfile.softwareList)?m(n.studentProfile.softwareList.join(", ")):m("")},[n]);const c=async O=>{if(O.preventDefault(),!n){alert("Student data is not loaded. Please try again.");return}const q=new FormData(O.currentTarget),v={name:q.get("name")||void 0,email:q.get("email")||void 0,phone:q.get("phone")||void 0,isActive:q.get("isActive")==="true",avatarUrl:q.get("avatarUrl")||void 0},B={dob:q.get("dob")||void 0,address:q.get("address")||void 0,photoUrl:q.get("photoUrl")||void 0,softwareList:d?d.split(",").map(D=>D.trim()).filter(D=>D.length>0):void 0,enrollmentDate:q.get("enrollmentDate")||void 0,status:q.get("profileStatus")||void 0};try{await f.mutateAsync(v),(n!=null&&n.studentProfile||Object.values(B).some(D=>D!==void 0&&D!==""))&&await p.mutateAsync(B),alert("Student updated successfully!"),a("/students")}catch(D){console.error("Error updating student:",D)}};return e.jsx(J,{children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Edit Student"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Update student information"})]}),e.jsx("button",{onClick:()=>a("/students"),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"â† Back"})]})}),e.jsx("div",{className:"p-8",children:e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Student Photo"}),e.jsxs("div",{className:"flex items-center gap-6",children:[(()=>{var v;const O=((v=n==null?void 0:n.studentProfile)==null?void 0:v.photoUrl)||(n==null?void 0:n.avatarUrl),q=(n==null?void 0:n.name)||"Student";return O?e.jsx("img",{src:O,alt:q,className:"w-32 h-32 rounded-full object-cover border-4 border-orange-500 shadow-lg",onError:B=>{B.target.src="https://ui-avatars.com/api/?name="+encodeURIComponent(q)+"&background=orange&color=fff&size=128"}}):e.jsx("div",{className:"w-32 h-32 rounded-full bg-orange-500 flex items-center justify-center text-white font-bold text-3xl shadow-lg",children:q.charAt(0).toUpperCase()})})(),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Avatar URL"}),e.jsx("input",{type:"url",name:"avatarUrl",defaultValue:(n==null?void 0:n.avatarUrl)||"",placeholder:"https://example.com/photo.jpg",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"URL for student's profile photo"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile Photo URL"}),e.jsx("input",{type:"url",name:"photoUrl",defaultValue:((u=n==null?void 0:n.studentProfile)==null?void 0:u.photoUrl)||"",placeholder:"https://example.com/photo.jpg",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Alternative photo URL in student profile"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),e.jsx("input",{type:"text",name:"name",defaultValue:(n==null?void 0:n.name)||"",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",defaultValue:(n==null?void 0:n.email)||"",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",defaultValue:(n==null?void 0:n.phone)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Status *"}),e.jsxs("select",{name:"isActive",defaultValue:n!=null&&n.isActive?"true":"false",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]}),(n==null?void 0:n.createdAt)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Created"}),e.jsx("p",{className:"text-sm text-gray-900 py-3",children:new Date(n.createdAt).toLocaleString()})]}),(n==null?void 0:n.updatedAt)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Updated"}),e.jsx("p",{className:"text-sm text-gray-900 py-3",children:new Date(n.updatedAt).toLocaleString()})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 border-b pb-2",children:"Student Profile Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"dob",defaultValue:b((i=n==null?void 0:n.studentProfile)==null?void 0:i.dob),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enrollment Date"}),e.jsx("input",{type:"date",name:"enrollmentDate",defaultValue:b((C=n==null?void 0:n.studentProfile)==null?void 0:C.enrollmentDate),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile Status"}),e.jsxs("select",{name:"profileStatus",defaultValue:((E=n==null?void 0:n.studentProfile)==null?void 0:E.status)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"on-hold",children:"On Hold"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("textarea",{name:"address",rows:3,defaultValue:((h=n==null?void 0:n.studentProfile)==null?void 0:h.address)||"",placeholder:"Enter full address",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Software List"}),e.jsx("input",{type:"text",value:d,onChange:O=>m(O.target.value),placeholder:"Photoshop, Illustrator, InDesign (comma-separated)",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter software names separated by commas"}),((k=n==null?void 0:n.studentProfile)==null?void 0:k.softwareList)&&Array.isArray(n.studentProfile.softwareList)&&n.studentProfile.softwareList.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:n.studentProfile.softwareList.map((O,q)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:O},q))})]}),((A=n==null?void 0:n.studentProfile)==null?void 0:A.documents)&&Object.keys(n.studentProfile.documents).length>0&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Documents (Read-only)"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:e.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap max-h-40 overflow-y-auto",children:JSON.stringify(n.studentProfile.documents,null,2)})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Documents are managed through the enrollment process"})]}),((g=n==null?void 0:n.studentProfile)==null?void 0:g.createdAt)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile Created"}),e.jsx("p",{className:"text-sm text-gray-900 py-3",children:new Date(n.studentProfile.createdAt).toLocaleString()})]}),((w=n==null?void 0:n.studentProfile)==null?void 0:w.updatedAt)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile Updated"}),e.jsx("p",{className:"text-sm text-gray-900 py-3",children:new Date(n.studentProfile.updatedAt).toLocaleString()})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"submit",disabled:f.isPending||p.isPending,className:"flex-1 px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:f.isPending||p.isPending?"Saving...":"Save All Changes"}),e.jsx("button",{type:"button",onClick:()=>a("/students"),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})})]})})})},rt={getAllEmployees:async()=>(await L.get("/users",{params:{role:"employee",isActive:!0}})).data,getEmployeeProfile:async t=>(await L.get(`/employees/${t}`)).data,createEmployeeProfile:async t=>(await L.post("/employees",t)).data,updateEmployeeProfile:async(t,s)=>(await L.put(`/users/${t}/employee-profile`,s)).data},Kn=()=>{var O,q;const{user:t}=re(),s=ye(),a=le(),[r,n]=N.useState(null),[l,o]=N.useState(!1),[d,m]=N.useState(!1),[f,p]=N.useState(null),[b,c]=N.useState(!1),{data:u,isLoading:i,error:C}=H({queryKey:["employees"],queryFn:()=>rt.getAllEmployees(),retry:1}),E=W({mutationFn:v=>me.deleteUser(v),onSuccess:()=>{a.invalidateQueries({queryKey:["employees"]}),o(!1),n(null),alert("Employee deleted successfully!")},onError:v=>{var B,D;alert(((D=(B=v.response)==null?void 0:B.data)==null?void 0:D.message)||"Failed to delete employee")}}),h=W({mutationFn:({userId:v,avatarUrl:B})=>me.updateUser(v,{avatarUrl:B}),onSuccess:()=>{a.invalidateQueries({queryKey:["employees"]}),m(!1),n(null),p(null),alert("Image updated successfully!")},onError:v=>{var B,D;alert(((D=(B=v.response)==null?void 0:B.data)==null?void 0:D.message)||"Failed to update image"),c(!1)}}),k=async v=>{var M,P,T;const B=(M=v.target.files)==null?void 0:M[0];if(!B||!r)return;if(!B.type.startsWith("image/")){alert("Please select an image file");return}if(B.size>5*1024*1024){alert("Image size must be less than 5MB");return}const D=new FileReader;D.onloadend=()=>{p(D.result)},D.readAsDataURL(B),c(!0);try{const x=await ut.uploadFile(B);if(x.data.files.length>0){const R=x.data.files[0].url;h.mutate({userId:r.id,avatarUrl:R})}}catch(x){alert(((T=(P=x.response)==null?void 0:P.data)==null?void 0:T.message)||"Failed to upload image"),c(!1)}},A=(u==null?void 0:u.data.users)||[],g=v=>{n(v),o(!0)},w=()=>{r&&E.mutate(r.id)};return i?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):C?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"bg-white shadow-xl rounded-lg p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600 text-lg mb-4",children:"Error loading employee data"}),e.jsx("p",{className:"text-gray-500 text-sm",children:((q=(O=C==null?void 0:C.response)==null?void 0:O.data)==null?void 0:q.message)||(C==null?void 0:C.message)||"Unknown error"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Retry"})]})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Employee Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage employees"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("button",{onClick:()=>window.location.href="/employees/register",className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ New Employee Registration"})]})}),e.jsx("div",{className:"p-6",children:A.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No employees found"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Photo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Designation"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(v=>{var B,D;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:v.avatarUrl?e.jsx("img",{src:v.avatarUrl,alt:v.name,className:"h-12 w-12 rounded-full object-cover border-2 border-gray-200",onError:M=>{M.target.src="https://ui-avatars.com/api/?name="+encodeURIComponent(v.name)+"&background=orange&color=fff"}}):e.jsx("div",{className:"h-12 w-12 rounded-full bg-orange-500 flex items-center justify-center text-white font-semibold text-lg",children:v.name.charAt(0).toUpperCase()})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:v.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:v.phone||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:((B=v.employeeProfile)==null?void 0:B.department)||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:((D=v.employeeProfile)==null?void 0:D.designation)||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${v.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:v.isActive?"Active":"Inactive"})}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>{n(v),p(v.avatarUrl||null),m(!0)},className:"text-orange-600 hover:text-orange-900 text-xs",title:"Update Photo",children:"ðŸ“· Photo"}),e.jsx("button",{onClick:()=>s(`/employees/${v.id}/edit`),className:"text-orange-600 hover:text-orange-900 text-xs",title:"Edit Employee",children:"âœï¸ Edit"}),(t==null?void 0:t.role)==="superadmin"&&e.jsx("button",{onClick:()=>g(v),className:"text-red-600 hover:text-red-900 text-xs",title:"Delete Employee",children:"ðŸ—‘ï¸ Delete"})]})})]},v.id)})})]})})})]})}),l&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Delete Employee"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["Are you sure you want to delete ",e.jsx("strong",{children:r.name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:w,disabled:E.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors disabled:opacity-50",children:E.isPending?"Deleting...":"Delete"}),e.jsx("button",{onClick:()=>{o(!1),n(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})}),d&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Update Employee Photo"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"Employee:"})," ",r.name]}),e.jsx("div",{className:"flex justify-center mb-4",children:f?e.jsx("img",{src:f,alt:"Preview",className:"h-32 w-32 rounded-full object-cover border-4 border-orange-500"}):e.jsx("div",{className:"h-32 w-32 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"No image"})})}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image (JPG, PNG - Max 5MB)"}),e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png",onChange:k,disabled:b,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{type:"button",onClick:()=>{m(!1),n(null),p(null)},disabled:b,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors disabled:opacity-50",children:b?"Uploading...":"Close"})})]})})]})},_n=()=>{const t=ye(),s=le(),[a,r]=N.useState(1),n=6,[l,o]=N.useState(null),d=W({mutationFn:async u=>(await L.post("/auth/register",u)).data,onSuccess:u=>{o(u.data.user.id),r(2)},onError:u=>{var i,C;alert(((C=(i=u.response)==null?void 0:i.data)==null?void 0:C.message)||"Failed to create user account")}}),m=W({mutationFn:u=>rt.createEmployeeProfile(u),onSuccess:()=>{s.invalidateQueries({queryKey:["employees"]}),s.invalidateQueries({queryKey:["users"]}),alert("Employee registration completed successfully!"),t("/employees")},onError:u=>{var i,C;alert(((C=(i=u.response)==null?void 0:i.data)==null?void 0:C.message)||"Failed to create employee profile")}}),f=u=>{u.preventDefault();const i=new FormData(u.currentTarget),C={name:i.get("fullName"),email:i.get("email"),phone:i.get("contactNumber"),password:i.get("password"),role:"employee"};d.mutate(C)},p=u=>{u.preventDefault();const i=new FormData(u.currentTarget);if(!l){alert("Please complete user registration first");return}const C=i.getAll("documents"),E={userId:l,employeeId:i.get("employeeId"),gender:i.get("gender")||void 0,dateOfBirth:i.get("dateOfBirth")||void 0,nationality:i.get("nationality")||void 0,maritalStatus:i.get("maritalStatus")||void 0,department:i.get("department")||void 0,designation:i.get("designation")||void 0,dateOfJoining:i.get("dateOfJoining")||void 0,employmentType:i.get("employmentType")||void 0,reportingManager:i.get("reportingManager")||void 0,workLocation:i.get("workLocation")||void 0,bankName:i.get("bankName")||void 0,accountNumber:i.get("accountNumber")||void 0,ifscCode:i.get("ifscCode")||void 0,branch:i.get("branch")||void 0,panNumber:i.get("panNumber")||void 0,city:i.get("city")||void 0,state:i.get("state")||void 0,postalCode:i.get("postalCode")||void 0,address:i.get("address")||void 0,emergencyContactName:i.get("emergencyContactName")||void 0,emergencyRelationship:i.get("emergencyRelationship")||void 0,emergencyPhoneNumber:i.get("emergencyPhoneNumber")||void 0,emergencyAlternatePhone:i.get("emergencyAlternatePhone")||void 0,documentsSubmitted:C.join(", ")||void 0};m.mutate(E)},b=()=>{a<n&&r(a+1)},c=()=>{a>1&&r(a-1)};return e.jsx(J,{children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Employee Registration Form"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Complete employee registration and profile setup"})]}),e.jsx("div",{className:"px-8 py-4 bg-gray-50 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:[1,2,3,4,5,6].map(u=>e.jsxs(Ie.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold ${a>=u?"bg-orange-600 text-white":"bg-gray-300 text-gray-600"}`,children:u}),e.jsxs("span",{className:`ml-1 text-xs font-medium ${a>=u?"text-orange-600":"text-gray-500"}`,children:[u===1&&"Account",u===2&&"Personal",u===3&&"Employment",u===4&&"Bank",u===5&&"Emergency",u===6&&"Documents"]})]}),u<n&&e.jsx("div",{className:`flex-1 h-1 mx-1 ${a>u?"bg-orange-600":"bg-gray-300"}`})]},u))})}),a===1&&e.jsxs("form",{onSubmit:f,className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 1: Create User Account"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"fullName",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"email",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contact Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"contactNumber",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",name:"password",required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:d.isPending,className:"px-6 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:d.isPending?"Creating Account...":"Create Account & Continue"})})]})]}),a>1&&e.jsx("form",{onSubmit:p,children:e.jsxs("div",{className:"p-8",children:[a===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 2: Personal Information"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"employeeId",required:!0,placeholder:"e.g., EMP001",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"gender",value:"male",className:"mr-2"}),e.jsx("span",{children:"Male"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"gender",value:"female",className:"mr-2"}),e.jsx("span",{children:"Female"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"gender",value:"other",className:"mr-2"}),e.jsx("span",{children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"dateOfBirth",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nationality"}),e.jsx("input",{type:"text",name:"nationality",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marital Status"}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"maritalStatus",value:"single",className:"mr-2"}),e.jsx("span",{children:"Single"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"maritalStatus",value:"married",className:"mr-2"}),e.jsx("span",{children:"Married"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"maritalStatus",value:"other",className:"mr-2"}),e.jsx("span",{children:"Other"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{name:"address",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",name:"city",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State/Province"}),e.jsx("input",{type:"text",name:"state",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),e.jsx("input",{type:"text",name:"postalCode",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]}),a===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 3: Employment Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",name:"department",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation / Job Title"}),e.jsx("input",{type:"text",name:"designation",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Joining"}),e.jsx("input",{type:"date",name:"dateOfJoining",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"employmentType",value:"full-time",className:"mr-2"}),e.jsx("span",{children:"Full-Time"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"employmentType",value:"part-time",className:"mr-2"}),e.jsx("span",{children:"Part-Time"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"employmentType",value:"contract",className:"mr-2"}),e.jsx("span",{children:"Contract"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"employmentType",value:"intern",className:"mr-2"}),e.jsx("span",{children:"Intern"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reporting Manager"}),e.jsx("input",{type:"text",name:"reportingManager",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Location"}),e.jsx("input",{type:"text",name:"workLocation",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]}),a===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 4: Bank Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",name:"bankName",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),e.jsx("input",{type:"text",name:"accountNumber",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IFSC / Routing Number"}),e.jsx("input",{type:"text",name:"ifscCode",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),e.jsx("input",{type:"text",name:"branch",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PAN / Tax ID"}),e.jsx("input",{type:"text",name:"panNumber",maxLength:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),a===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 5: Emergency Contact Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",name:"emergencyContactName",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Relationship"}),e.jsx("input",{type:"text",name:"emergencyRelationship",placeholder:"e.g., Father, Mother, Spouse, Guardian",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"emergencyPhoneNumber",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alternate Phone Number"}),e.jsx("input",{type:"tel",name:"emergencyAlternatePhone",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]}),a===6&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 6: Documents & Declaration"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Documents Submitted"}),e.jsx("div",{className:"space-y-2 border border-gray-300 rounded-md p-4",children:["Resume","ID Proof","Previous Salary Payslip","Educational Certificates","Experience Certificates","Relieving letter"].map(u=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"documents",value:u,className:"mr-2"}),e.jsx("span",{children:u})]},u))})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Declaration"}),e.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"I hereby declare that the above information is true and correct to the best of my knowledge."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Signature"}),e.jsx("div",{className:"border-b-2 border-gray-400 h-10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",defaultValue:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",readOnly:!0})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:c,disabled:a===2,className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),a<n?e.jsx("button",{type:"button",onClick:b,className:"px-6 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors",children:"Next"}):e.jsx("button",{type:"submit",disabled:m.isPending,className:"px-6 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:m.isPending?"Submitting...":"Submit Registration"})]})]})})]})})})},zn=()=>{const{id:t}=Pt(),{user:s}=re(),a=ye(),r=le(),[n,l]=N.useState(1),o=4,{data:d,isLoading:m}=H({queryKey:["employee",t],queryFn:async()=>{const h=await L.get(`/users/${t}`),k=await rt.getEmployeeProfile(Number(t));return{user:h.data.data.user,profile:k.data.employeeProfile}},enabled:!!t}),f=W({mutationFn:h=>me.updateUser(Number(t),h),onSuccess:()=>{r.invalidateQueries({queryKey:["employee",t]}),r.invalidateQueries({queryKey:["employees"]})}}),p=W({mutationFn:h=>rt.updateEmployeeProfile(Number(t),h),onSuccess:()=>{r.invalidateQueries({queryKey:["employee",t]}),r.invalidateQueries({queryKey:["employees"]}),alert("Employee updated successfully!"),a("/employees")},onError:h=>{var k,A;alert(((A=(k=h.response)==null?void 0:k.data)==null?void 0:A.message)||"Failed to update employee profile")}});if((s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="superadmin")return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg p-6",children:[e.jsx("p",{className:"text-red-600",children:"You don't have permission to edit employees."}),e.jsx("button",{onClick:()=>a("/employees"),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Back to Employees"})]})})});if(m)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})});if(!d)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg p-6",children:[e.jsx("p",{className:"text-red-600",children:"Employee not found."}),e.jsx("button",{onClick:()=>a("/employees"),className:"mt-4 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Back to Employees"})]})})});const{user:b,profile:c}=d,u=h=>{h.preventDefault();const k=new FormData(h.currentTarget),A={name:k.get("name")||void 0,email:k.get("email")||void 0,phone:k.get("phone")||void 0,isActive:k.get("isActive")==="true"};f.mutate(A,{onSuccess:()=>{l(2)}})},i=h=>{h.preventDefault();const k=new FormData(h.currentTarget),A={employeeId:k.get("employeeId")||void 0,gender:k.get("gender")||void 0,dateOfBirth:k.get("dateOfBirth")||void 0,nationality:k.get("nationality")||void 0,maritalStatus:k.get("maritalStatus")||void 0};p.mutate(A)},C=h=>{h.preventDefault();const k=new FormData(h.currentTarget),A={department:k.get("department")||void 0,designation:k.get("designation")||void 0,dateOfJoining:k.get("dateOfJoining")||void 0,employmentType:k.get("employmentType")||void 0,reportingManager:k.get("reportingManager")||void 0,workLocation:k.get("workLocation")||void 0};p.mutate(A)},E=h=>{h.preventDefault();const k=new FormData(h.currentTarget),A={bankName:k.get("bankName")||void 0,accountNumber:k.get("accountNumber")||void 0,ifscCode:k.get("ifscCode")||void 0,branch:k.get("branch")||void 0,panNumber:k.get("panNumber")||void 0,city:k.get("city")||void 0,state:k.get("state")||void 0,postalCode:k.get("postalCode")||void 0};p.mutate(A)};return e.jsx(J,{children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Edit Employee"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Update employee information"})]}),e.jsx("button",{onClick:()=>a("/employees"),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"â† Back"})]})}),e.jsx("div",{className:"px-8 py-4 bg-gray-50 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:[1,2,3,4].map(h=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold ${n>=h?"bg-orange-600 text-white":"bg-gray-300 text-gray-600"}`,children:h}),e.jsxs("span",{className:"mt-2 text-xs text-gray-600",children:[h===1&&"Basic Info",h===2&&"Personal Info",h===3&&"Employment",h===4&&"Bank Details"]})]}),h<o&&e.jsx("div",{className:`flex-1 h-1 mx-2 ${n>h?"bg-orange-600":"bg-gray-300"}`})]},h))})}),e.jsxs("div",{className:"p-8",children:[n===1&&e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),e.jsx("input",{type:"text",name:"name",defaultValue:b.name,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",defaultValue:b.email,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",defaultValue:b.phone||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),e.jsxs("select",{name:"isActive",defaultValue:b.isActive?"true":"false",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})]}),e.jsx("div",{className:"flex gap-4 pt-6",children:e.jsx("button",{type:"submit",disabled:f.isPending,className:"flex-1 px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:f.isPending?"Saving...":"Save & Continue"})})]}),n===2&&e.jsxs("form",{onSubmit:i,className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee ID *"}),e.jsx("input",{type:"text",name:"employeeId",defaultValue:(c==null?void 0:c.employeeId)||"",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),e.jsxs("select",{name:"gender",defaultValue:(c==null?void 0:c.gender)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"dateOfBirth",defaultValue:c!=null&&c.dateOfBirth?c.dateOfBirth.split("T")[0]:"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nationality"}),e.jsx("input",{type:"text",name:"nationality",defaultValue:(c==null?void 0:c.nationality)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Marital Status"}),e.jsxs("select",{name:"maritalStatus",defaultValue:(c==null?void 0:c.maritalStatus)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"single",children:"Single"}),e.jsx("option",{value:"married",children:"Married"}),e.jsx("option",{value:"divorced",children:"Divorced"}),e.jsx("option",{value:"widowed",children:"Widowed"})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>l(1),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Previous"}),e.jsx("button",{type:"submit",disabled:p.isPending,className:"flex-1 px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:p.isPending?"Saving...":"Save & Continue"})]})]}),n===3&&e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Employment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",name:"department",defaultValue:(c==null?void 0:c.department)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Designation"}),e.jsx("input",{type:"text",name:"designation",defaultValue:(c==null?void 0:c.designation)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Joining"}),e.jsx("input",{type:"date",name:"dateOfJoining",defaultValue:c!=null&&c.dateOfJoining?c.dateOfJoining.split("T")[0]:"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Type"}),e.jsxs("select",{name:"employmentType",defaultValue:(c==null?void 0:c.employmentType)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"full-time",children:"Full-time"}),e.jsx("option",{value:"part-time",children:"Part-time"}),e.jsx("option",{value:"contract",children:"Contract"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reporting Manager"}),e.jsx("input",{type:"text",name:"reportingManager",defaultValue:(c==null?void 0:c.reportingManager)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Work Location"}),e.jsx("input",{type:"text",name:"workLocation",defaultValue:(c==null?void 0:c.workLocation)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>l(2),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Previous"}),e.jsx("button",{type:"submit",disabled:p.isPending,className:"flex-1 px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:p.isPending?"Saving...":"Save & Continue"})]})]}),n===4&&e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Bank Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",name:"bankName",defaultValue:(c==null?void 0:c.bankName)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Number"}),e.jsx("input",{type:"text",name:"accountNumber",defaultValue:(c==null?void 0:c.accountNumber)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IFSC Code"}),e.jsx("input",{type:"text",name:"ifscCode",defaultValue:(c==null?void 0:c.ifscCode)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch"}),e.jsx("input",{type:"text",name:"branch",defaultValue:(c==null?void 0:c.branch)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PAN Number"}),e.jsx("input",{type:"text",name:"panNumber",defaultValue:(c==null?void 0:c.panNumber)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),e.jsx("input",{type:"text",name:"city",defaultValue:(c==null?void 0:c.city)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),e.jsx("input",{type:"text",name:"state",defaultValue:(c==null?void 0:c.state)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Postal Code"}),e.jsx("input",{type:"text",name:"postalCode",defaultValue:(c==null?void 0:c.postalCode)||"",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>l(3),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Previous"}),e.jsx("button",{type:"submit",disabled:p.isPending,className:"flex-1 px-6 py-3 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:p.isPending?"Saving...":"Save & Finish"})]})]})]})]})})})},Qn=()=>{const t=ye(),s=le(),[a,r]=N.useState(1),n=7,[l,o]=N.useState(null),[d,m]=N.useState(!1),[f,p]=N.useState(""),b=W({mutationFn:async h=>(await L.post("/auth/register",h)).data,onSuccess:h=>{o(h.data.user.id),r(2)},onError:h=>{var k,A;alert(((A=(k=h.response)==null?void 0:k.data)==null?void 0:A.message)||"Failed to create user account")}}),c=W({mutationFn:h=>mt.createFacultyProfile(h),onSuccess:()=>{s.invalidateQueries({queryKey:["faculty"]}),s.invalidateQueries({queryKey:["users"]}),alert("Faculty registration completed successfully!"),t("/faculty")},onError:h=>{var k,A;alert(((A=(k=h.response)==null?void 0:k.data)==null?void 0:A.message)||"Failed to create faculty profile")}}),u=h=>{h.preventDefault();const k=new FormData(h.currentTarget),A={name:k.get("fullName"),email:k.get("email"),phone:k.get("contactNumber"),password:k.get("password"),role:"faculty"};b.mutate(A)},i=h=>{h.preventDefault();const k=new FormData(h.currentTarget);if(!l){alert("Please complete user registration first");return}let g=k.getAll("softwareProficiency").filter(v=>v!=="Other");d&&f.trim()&&g.push(f.trim());const w=g.join(", "),O=k.getAll("documents"),q={userId:l,expertise:k.get("expertise")||void 0,availability:k.get("availability")||void 0,softwareProficiency:w||void 0,address:k.get("address")||void 0,emergencyContactName:k.get("emergencyContactName")||void 0,emergencyRelationship:k.get("emergencyRelationship")||void 0,emergencyPhoneNumber:k.get("emergencyPhoneNumber")||void 0,emergencyAlternatePhone:k.get("emergencyAlternatePhone")||void 0,documentsSubmitted:O.join(", ")||void 0};c.mutate(q)},C=()=>{a<n&&r(a+1)},E=()=>{a>1&&r(a-1)};return e.jsx(J,{children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Faculty Registration Form"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Complete faculty registration and profile setup"})]}),e.jsx("div",{className:"px-8 py-4 bg-gray-50 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:[1,2,3,4,5,6,7].map(h=>e.jsxs(Ie.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold ${a>=h?"bg-orange-600 text-white":"bg-gray-300 text-gray-600"}`,children:h}),e.jsxs("span",{className:`ml-1 text-xs font-medium ${a>=h?"text-orange-600":"text-gray-500"}`,children:[h===1&&"Account",h===2&&"Personal",h===3&&"Employment",h===4&&"Software",h===5&&"Bank",h===6&&"Emergency",h===7&&"Documents"]})]}),h<n&&e.jsx("div",{className:`flex-1 h-1 mx-1 ${a>h?"bg-orange-600":"bg-gray-300"}`})]},h))})}),a===1&&e.jsxs("form",{onSubmit:u,className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 1: Create User Account"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"fullName",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"email",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contact Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"contactNumber",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",name:"password",required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:b.isPending,className:"px-6 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:b.isPending?"Creating Account...":"Create Account & Continue"})})]})]}),a>1&&e.jsx("form",{onSubmit:i,children:e.jsxs("div",{className:"p-8",children:[a===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 2: Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"gender",value:"male",className:"mr-2"}),e.jsx("span",{children:"Male"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"gender",value:"female",className:"mr-2"}),e.jsx("span",{children:"Female"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"gender",value:"other",className:"mr-2"}),e.jsx("span",{children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"dateOfBirth",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nationality"}),e.jsx("input",{type:"text",name:"nationality",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marital Status"}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"maritalStatus",value:"single",className:"mr-2"}),e.jsx("span",{children:"Single"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"maritalStatus",value:"married",className:"mr-2"}),e.jsx("span",{children:"Married"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"maritalStatus",value:"other",className:"mr-2"}),e.jsx("span",{children:"Other"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{name:"address",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",name:"city",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State/Province"}),e.jsx("input",{type:"text",name:"state",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),e.jsx("input",{type:"text",name:"postalCode",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]}),a===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 3: Employment Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",name:"department",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation / Job Title"}),e.jsx("input",{type:"text",name:"designation",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Joining"}),e.jsx("input",{type:"date",name:"dateOfJoining",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"employmentType",value:"full-time",className:"mr-2"}),e.jsx("span",{children:"Full-Time"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"employmentType",value:"part-time",className:"mr-2"}),e.jsx("span",{children:"Part-Time"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"employmentType",value:"contract",className:"mr-2"}),e.jsx("span",{children:"Contract"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"employmentType",value:"intern",className:"mr-2"}),e.jsx("span",{children:"Intern"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reporting Manager"}),e.jsx("input",{type:"text",name:"reportingManager",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Location"}),e.jsx("input",{type:"text",name:"workLocation",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expertise / Specialization"}),e.jsx("textarea",{name:"expertise",rows:3,placeholder:"Describe your areas of expertise and specialization",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Availability"}),e.jsx("textarea",{name:"availability",rows:2,placeholder:"e.g., Monday-Friday 9 AM - 5 PM",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),a===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 4: Software Proficiency"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Software Proficiency ",e.jsx("span",{className:"text-gray-500",children:"(Select all applicable)"})]}),e.jsx("div",{className:"border border-gray-300 rounded-md p-4 max-h-64 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:["Photoshop","Illustrator","InDesign","After Effects","Premiere Pro","Figma","Sketch","Blender","Maya","3ds Max","Cinema 4D","Lightroom","CorelDRAW","AutoCAD","SolidWorks","Revit","SketchUp","Unity","Unreal Engine","DaVinci Resolve","Final Cut Pro","Procreate","Affinity Designer","Affinity Photo","Canva Pro","Other"].map(h=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",name:"softwareProficiency",value:h,onChange:k=>{h==="Other"&&m(k.target.checked)},className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:h})]},h))})}),d&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Specify Other Software"}),e.jsx("input",{type:"text",value:f,onChange:h=>p(h.target.value),placeholder:"Enter software names (comma separated)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]}),a===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 5: Bank Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",name:"bankName",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),e.jsx("input",{type:"text",name:"accountNumber",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IFSC / Routing Number"}),e.jsx("input",{type:"text",name:"ifscCode",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),e.jsx("input",{type:"text",name:"branch",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PAN / Tax ID"}),e.jsx("input",{type:"text",name:"panNumber",maxLength:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),a===6&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 6: Emergency Contact Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",name:"emergencyContactName",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Relationship"}),e.jsx("input",{type:"text",name:"emergencyRelationship",placeholder:"e.g., Father, Mother, Spouse, Guardian",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"emergencyPhoneNumber",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alternate Phone Number"}),e.jsx("input",{type:"tel",name:"emergencyAlternatePhone",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]})]}),a===7&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Step 7: Documents & Declaration"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Documents Submitted"}),e.jsx("div",{className:"space-y-2 border border-gray-300 rounded-md p-4",children:["Resume","ID Proof","Previous Salary Payslip","Educational Certificates","Experience Certificates","Relieving letter"].map(h=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"documents",value:h,className:"mr-2"}),e.jsx("span",{children:h})]},h))})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Declaration"}),e.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"I hereby declare that the above information is true and correct to the best of my knowledge."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty Signature"}),e.jsx("div",{className:"border-b-2 border-gray-400 h-10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",defaultValue:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",readOnly:!0})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:E,disabled:a===2,className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),a<n?e.jsx("button",{type:"button",onClick:C,className:"px-6 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors",children:"Next"}):e.jsx("button",{type:"submit",disabled:c.isPending,className:"px-6 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:c.isPending?"Submitting...":"Submit Registration"})]})]})})]})})})},_e={getAllSessions:async t=>(await L.get("/sessions",{params:t})).data,getSession:async t=>(await L.get(`/sessions/${t}`)).data,createSession:async t=>(await L.post("/sessions",t)).data,checkInSession:async t=>(await L.post(`/sessions/${t}/checkin`)).data,checkOutSession:async t=>(await L.post(`/sessions/${t}/checkout`)).data},Re={getSessionAttendance:async t=>(await L.get(`/sessions/${t}/attendance`)).data,markAttendance:async(t,s)=>(await L.post(`/sessions/${t}/attendance`,s)).data,getStudentAttendance:async(t,s)=>(await L.get(`/students/${t}/attendance`,{params:s})).data,punchIn:async t=>(await L.post("/student-attendance/punch-in",t)).data,punchOut:async t=>(await L.post("/student-attendance/punch-out",t)).data,getTodayPunch:async()=>(await L.get("/student-attendance/today")).data,getStudentPunchHistory:async t=>(await L.get("/student-attendance/history",{params:t})).data},Wn=()=>{var R;const{user:t}=re(),s=le(),[a,r]=N.useState(!1),[n,l]=N.useState(null),[o,d]=N.useState(!1),[m,f]=N.useState(""),[p,b]=N.useState(""),[c,u]=N.useState(""),[i,C]=N.useState(""),[E,h]=N.useState(""),{data:k,isLoading:A}=H({queryKey:["sessions",m,p,c],queryFn:()=>_e.getAllSessions({batchId:m?Number(m):void 0,facultyId:p?Number(p):void 0,status:c||void 0})}),{data:g,isLoading:w}=H({queryKey:["attendance",n==null?void 0:n.id],queryFn:()=>Re.getSessionAttendance(n.id),enabled:!!n&&o}),{data:O}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches()}),{data:q}=H({queryKey:["faculty"],queryFn:()=>mt.getAllFaculty()}),v=W({mutationFn:y=>_e.createSession(y),onSuccess:()=>{s.invalidateQueries({queryKey:["sessions"]}),r(!1),alert("Session created successfully!")},onError:y=>{var K,Q;alert(((Q=(K=y.response)==null?void 0:K.data)==null?void 0:Q.message)||"Failed to create session")}}),B=W({mutationFn:y=>_e.checkOutSession(y),onSuccess:()=>{s.invalidateQueries({queryKey:["sessions"]}),alert("Session checked out successfully!")},onError:y=>{var K,Q;alert(((Q=(K=y.response)==null?void 0:K.data)==null?void 0:Q.message)||"Failed to check out session")}}),D=W({mutationFn:y=>_e.checkInSession(y),onSuccess:()=>{s.invalidateQueries({queryKey:["sessions"]}),alert("Session checked in successfully!")},onError:y=>{var K,Q;alert(((Q=(K=y.response)==null?void 0:K.data)==null?void 0:Q.message)||"Failed to check in session")}});let M=(k==null?void 0:k.data.sessions)||[];const P=(O==null?void 0:O.data)||[],T=(q==null?void 0:q.data.users)||[];(i||E)&&(M=M.filter(y=>{const K=new Date(y.date);return!(i&&K<new Date(i)||E&&K>new Date(E))}));const x=y=>{y.preventDefault();const K=new FormData(y.currentTarget),Q={batchId:parseInt(K.get("batchId")),facultyId:parseInt(K.get("facultyId")),date:K.get("date"),startTime:K.get("startTime"),endTime:K.get("endTime"),topic:K.get("topic")||void 0,isBackup:K.get("isBackup")==="true"};v.mutate(Q)};return A?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Session Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage class sessions"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="faculty")&&e.jsx("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ Create Session"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Batch"}),e.jsxs("select",{value:m,onChange:y=>f(y.target.value?Number(y.target.value):""),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"All Batches"}),P.map(y=>e.jsx("option",{value:y.id,children:y.title},y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Faculty"}),e.jsxs("select",{value:p,onChange:y=>b(y.target.value?Number(y.target.value):""),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"All Faculty"}),T.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Status"}),e.jsxs("select",{value:c,onChange:y=>u(y.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:i,onChange:y=>C(y.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:E,onChange:y=>h(y.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:M.length})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:M.filter(y=>y.status==="completed").length})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Ongoing"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:M.filter(y=>y.status==="ongoing").length})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Scheduled"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:M.filter(y=>y.status==="scheduled").length})]})]}),M.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 text-lg",children:"No sessions found"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Try adjusting your filters or create a new session"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Faculty"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Topic"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(y=>{var K,Q;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:new Date(y.date).toLocaleDateString()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-500",children:[y.startTime," - ",y.endTime]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:((K=y.batch)==null?void 0:K.title)||`Batch ${y.batchId}`})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:((Q=y.faculty)==null?void 0:Q.name)||`Faculty ${y.facultyId}`})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-500",children:y.topic||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${y.status==="completed"?"bg-green-100 text-green-800":y.status==="ongoing"?"bg-blue-100 text-blue-800":y.status==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:y.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[y.status==="scheduled"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="faculty")&&e.jsx("button",{onClick:()=>D.mutate(y.id),disabled:D.isPending,className:"px-3 py-1 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors disabled:opacity-50 text-xs",children:"Check In"}),y.status==="ongoing"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="faculty")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>B.mutate(y.id),disabled:B.isPending,className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors disabled:opacity-50 text-xs",children:"Check Out"}),e.jsx("button",{onClick:()=>{l(y),d(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs",children:"View Attendance"})]}),(y.status==="completed"||y.status==="ongoing")&&e.jsx("button",{onClick:()=>{l(y),d(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs",children:"View Attendance"})]})})]},y.id)})})]})})]})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create New Session"}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch *"}),e.jsxs("select",{name:"batchId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a batch"}),P.map(y=>e.jsx("option",{value:y.id,children:y.title},y.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty *"}),e.jsxs("select",{name:"facultyId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a faculty"}),T.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",name:"date",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time *"}),e.jsx("input",{type:"time",name:"startTime",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time *"}),e.jsx("input",{type:"time",name:"endTime",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Topic"}),e.jsx("input",{type:"text",name:"topic",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"isBackup",value:"true",className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Is Backup Session"})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:v.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:v.isPending?"Creating...":"Create"}),e.jsx("button",{type:"button",onClick:()=>r(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),o&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Session Attendance"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[(R=n.batch)==null?void 0:R.title," - ",new Date(n.date).toLocaleDateString()]})]}),e.jsx("button",{onClick:()=>{d(!1),l(null)},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),w?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):g!=null&&g.data.attendances&&g.data.attendances.length>0?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Marked At"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.data.attendances.map(y=>{var K,Q;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((K=y.student)==null?void 0:K.name)||`Student ${y.studentId}`}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((Q=y.student)==null?void 0:Q.email)||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${y.status==="present"||y.status==="manual_present"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.status==="manual_present"?"Present (Manual)":y.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.isManual?"Manual":"Automatic"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.markedAt?new Date(y.markedAt).toLocaleString():"-"})]},y.id)})})]}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:["Total: ",g.data.attendances.length," attendance records"]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No attendance records found for this session"})})]})})]})},Hn=()=>{const{user:t}=re(),s=le(),[a,r]=N.useState(null),[n,l]=N.useState(!1),{data:o}=H({queryKey:["sessions"],queryFn:()=>_e.getAllSessions()}),{data:d,isLoading:m}=H({queryKey:["attendance",a],queryFn:()=>Re.getSessionAttendance(a),enabled:a!==null}),f=W({mutationFn:({sessionId:u,data:i})=>Re.markAttendance(u,i),onSuccess:()=>{s.invalidateQueries({queryKey:["attendance",a]}),l(!1),alert("Attendance marked successfully!")},onError:u=>{var i,C;alert(((C=(i=u.response)==null?void 0:i.data)==null?void 0:C.message)||"Failed to mark attendance")}}),p=(o==null?void 0:o.data.sessions)||[],b=(d==null?void 0:d.data.attendances)||[],c=u=>{if(u.preventDefault(),!a)return;const i=new FormData(u.currentTarget),C={studentId:parseInt(i.get("studentId")),status:i.get("status"),isManual:i.get("isManual")==="true"};f.mutate({sessionId:a,data:C})};return e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Attendance Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Track attendance"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Session"}),e.jsxs("select",{value:a||"",onChange:u=>r(u.target.value?parseInt(u.target.value):null),className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a session"}),p.map(u=>{var i;return e.jsxs("option",{value:u.id,children:[new Date(u.date).toLocaleDateString()," - ",u.startTime," (",((i=u.batch)==null?void 0:i.title)||`Batch ${u.batchId}`,")"]},u.id)})]})]}),a&&e.jsxs(e.Fragment,{children:[((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="faculty")&&e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors",children:"+ Mark Attendance"})}),m?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):b.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No attendance records found for this session"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Marked At"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(u=>{var i,C;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((i=u.student)==null?void 0:i.name)||`Student ${u.studentId}`})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:((C=u.student)==null?void 0:C.email)||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${u.status==="present"||u.status==="manual_present"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:u.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${u.isManual?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:u.isManual?"Manual":"Auto"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:u.markedAt?new Date(u.markedAt).toLocaleString():"-"})})]},u.id)})})]})})]})]})]})}),n&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Mark Attendance"}),e.jsxs("form",{onSubmit:c,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID *"}),e.jsx("input",{type:"number",name:"studentId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),e.jsxs("select",{name:"status",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"present",children:"Present"}),e.jsx("option",{value:"absent",children:"Absent"}),e.jsx("option",{value:"manual_present",children:"Manual Present"})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"isManual",value:"true",className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Manual Marking"})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:f.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:f.isPending?"Marking...":"Mark Attendance"}),e.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})})]})},Jn=()=>{const{user:t}=re(),s=ye(),a=le();Ie.useEffect(()=>{(t==null?void 0:t.role)==="student"&&s("/attendance")},[t,s]);const[r,n]=N.useState(!1),[l,o]=N.useState(null),[d,m]=N.useState(null),[f,p]=N.useState(null),b=N.useRef(null),c=N.useRef(null),u=N.useRef(null),{data:i,isLoading:C}=H({queryKey:["today-punch"],queryFn:()=>Re.getTodayPunch()}),{data:E}=H({queryKey:["punch-history"],queryFn:()=>Re.getStudentPunchHistory()}),h=W({mutationFn:x=>Re.punchIn(x),onSuccess:()=>{a.invalidateQueries({queryKey:["today-punch"]}),a.invalidateQueries({queryKey:["punch-history"]}),o(null),m(null),alert("Punched in successfully!")},onError:x=>{var R,y;alert(((y=(R=x.response)==null?void 0:R.data)==null?void 0:y.message)||"Failed to punch in")}}),k=W({mutationFn:x=>Re.punchOut(x),onSuccess:()=>{a.invalidateQueries({queryKey:["today-punch"]}),a.invalidateQueries({queryKey:["punch-history"]}),o(null),m(null),alert("Punched out successfully!")},onError:x=>{var R,y;alert(((y=(R=x.response)==null?void 0:R.data)==null?void 0:y.message)||"Failed to punch out")}}),A=N.useCallback(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(x=>{p({latitude:x.coords.latitude,longitude:x.coords.longitude}),fetch(`https://api.opencagedata.com/geocode/v1/json?q=${x.coords.latitude}+${x.coords.longitude}&key=YOUR_API_KEY`).then(R=>R.json()).then(R=>{R.results&&R.results.length>0&&p(y=>({...y,address:R.results[0].formatted}))}).catch(()=>{})},x=>{console.error("Error getting location:",x),p({address:"Location access denied"})}):p({address:"Geolocation not supported"})},[]),g=N.useCallback(async()=>{try{const x=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:640,height:480},audio:!1});c.current=x,b.current&&(b.current.srcObject=x,n(!0),A())}catch(x){console.error("Error accessing webcam:",x),alert("Unable to access webcam. Please check permissions.")}},[A]),w=N.useCallback(()=>{c.current&&(c.current.getTracks().forEach(x=>x.stop()),c.current=null),b.current&&(b.current.srcObject=null),n(!1)},[]),O=N.useCallback(()=>{if(b.current&&u.current){const x=b.current,R=u.current,y=R.getContext("2d");if(y){R.width=x.videoWidth,R.height=x.videoHeight,y.drawImage(x,0,0);const K=R.toDataURL("image/jpeg",.8);o(K)}}},[]),q=N.useCallback(async()=>{const x=`FP_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;m(x),alert("Fingerprint captured! (Simulated - connect actual scanner in production)")},[]),v=N.useCallback(()=>{if(!l){alert("Please capture your photo first");return}const x={photo:l,fingerprint:d||void 0,location:f||void 0};h.mutate(x),w()},[l,d,f,h,w]),B=N.useCallback(()=>{if(!l){alert("Please capture your photo first");return}const x={photo:l,fingerprint:d||void 0,location:f||void 0};k.mutate(x),w()},[l,d,f,k,w]);if(Ie.useEffect(()=>()=>{w()},[w]),(t==null?void 0:t.role)==="student")return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"bg-white shadow-xl rounded-lg p-6",children:e.jsx("p",{className:"text-gray-600",children:"Redirecting..."})})})});const D=i==null?void 0:i.data.punch,M=(i==null?void 0:i.data.hasPunchedIn)||!1,P=(i==null?void 0:i.data.hasPunchedOut)||!1,T=(E==null?void 0:E.data.punches)||[];return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"My Attendance"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Punch in and punch out with photo and fingerprint"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Today's Status"}),C?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):D?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Punch In"}),e.jsx("p",{className:"text-lg font-semibold text-green-700",children:D.punchInAt?new Date(D.punchInAt).toLocaleTimeString():"Not punched in"})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${P?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200"}`,children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Punch Out"}),e.jsx("p",{className:`text-lg font-semibold ${P?"text-blue-700":"text-gray-500"}`,children:D.punchOutAt?new Date(D.punchOutAt).toLocaleTimeString():"Not punched out"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Working Hours"}),e.jsx("p",{className:"text-lg font-semibold text-orange-700",children:D.effectiveHours?`${D.effectiveHours.toFixed(2)} hrs`:"-"})]})]}):e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:e.jsx("p",{className:"text-gray-600",children:"No punch record for today"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Capture Photo"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden",style:{aspectRatio:"4/3"},children:[r?e.jsx("video",{ref:b,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("p",{children:"Camera not active"})]})}),e.jsx("canvas",{ref:u,className:"hidden"})]}),e.jsx("div",{className:"flex gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:O,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors",children:"ðŸ“¸ Capture Photo"}),e.jsx("button",{onClick:w,className:"px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors",children:"Stop"})]}):e.jsx("button",{onClick:g,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:"ðŸ“· Start Camera"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden",style:{aspectRatio:"4/3"},children:l?e.jsx("img",{src:l,alt:"Captured",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{children:"No photo captured"})]})})}),l&&e.jsx("button",{onClick:()=>o(null),className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Clear Photo"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Fingerprint Authentication"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Fingerprint Status"}),e.jsx("p",{className:"text-sm font-medium",children:d?"âœ“ Fingerprint captured":"No fingerprint captured"})]}),e.jsx("button",{onClick:q,className:"px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-colors",children:"ðŸ‘† Capture Fingerprint"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Note: Connect a fingerprint scanner device for production use"})]})]}),f&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Location"}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:e.jsx("p",{className:"text-sm text-gray-600",children:f.address||`Lat: ${f.latitude}, Lng: ${f.longitude}`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Actions"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:v,disabled:M||h.isPending||!l,className:"flex-1 px-6 py-4 bg-green-600 text-white rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h.isPending?"Punching In...":M?"âœ“ Already Punched In":"ðŸŸ¢ Punch In"}),e.jsx("button",{onClick:B,disabled:!M||P||k.isPending||!l,className:"flex-1 px-6 py-4 bg-red-600 text-white rounded-lg font-semibold text-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:k.isPending?"Punching Out...":P?"âœ“ Already Punched Out":"ðŸ”´ Punch Out"})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Punch History"}),T.length===0?e.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-500",children:"No punch history available"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Punch In"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Punch Out"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hours"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Photo"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(x=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(x.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x.punchInAt?new Date(x.punchInAt).toLocaleTimeString():"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x.punchOutAt?new Date(x.punchOutAt).toLocaleTimeString():"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x.effectiveHours?`${x.effectiveHours.toFixed(2)} hrs`:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[x.punchInPhoto&&e.jsx("img",{src:x.punchInPhoto,alt:"Punch In",className:"w-12 h-12 rounded object-cover cursor-pointer hover:scale-150 transition-transform",onClick:()=>window.open(x.punchInPhoto,"_blank")}),x.punchOutPhoto&&e.jsx("img",{src:x.punchOutPhoto,alt:"Punch Out",className:"w-12 h-12 rounded object-cover cursor-pointer hover:scale-150 transition-transform",onClick:()=>window.open(x.punchOutPhoto,"_blank")})]})})]},x.id))})]})})]})]})]})})})},jt={getAllPayments:async t=>(await L.get("/payments",{params:t})).data,getPayment:async t=>(await L.get(`/payments/${t}`)).data,createPayment:async t=>(await L.post("/payments",t)).data,updatePayment:async(t,s)=>(await L.put(`/payments/${t}`,s)).data},Gn=()=>{const{user:t}=re(),s=le(),[a,r]=N.useState(!1),[n,l]=N.useState(!1),[o,d]=N.useState(null),{data:m,isLoading:f}=H({queryKey:["payments"],queryFn:()=>jt.getAllPayments()}),{data:p}=H({queryKey:["students"],queryFn:()=>Pe.getAllStudents()}),b=W({mutationFn:h=>jt.createPayment(h),onSuccess:()=>{s.invalidateQueries({queryKey:["payments"]}),r(!1),alert("Payment created successfully!")},onError:h=>{var A,g;const k=((g=(A=h.response)==null?void 0:A.data)==null?void 0:g.message)||h.message||"Failed to create payment";console.error("Payment creation error:",h),alert(`Error: ${k}

Please check:
1. All required fields are filled
2. Database migrations are up to date
3. Backend server logs for details`)}}),c=W({mutationFn:({id:h,data:k})=>jt.updatePayment(h,k),onSuccess:()=>{s.invalidateQueries({queryKey:["payments"]}),l(!1),d(null),alert("Payment updated successfully!")},onError:h=>{var k,A;alert(((A=(k=h.response)==null?void 0:k.data)==null?void 0:A.message)||"Failed to update payment")}}),u=(m==null?void 0:m.data.payments)||[],i=(p==null?void 0:p.data.students)||[],C=h=>{h.preventDefault();const k=new FormData(h.currentTarget),A=parseInt(k.get("studentId")),g=parseFloat(k.get("amount")),w=k.get("dueDate");if(!A||isNaN(A)){alert("Please select a valid student");return}if(!g||isNaN(g)||g<=0){alert("Please enter a valid amount greater than 0");return}if(!w){alert("Please select a due date");return}const O={studentId:A,amount:g,dueDate:w,notes:k.get("notes")||void 0};console.log("Creating payment with data:",O),b.mutate(O)},E=h=>{if(h.preventDefault(),!o)return;const k=new FormData(h.currentTarget),A={status:k.get("status")||void 0,paidDate:k.get("paidDate")||void 0,paymentMethod:k.get("paymentMethod")||void 0,transactionId:k.get("transactionId")||void 0,notes:k.get("notes")||void 0};c.mutate({id:o.id,data:A})};return f?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Payment Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage payments"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ Create Payment"})]})}),e.jsx("div",{className:"p-6",children:u.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No payments found"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paid Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(h=>{var k,A;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((k=h.student)==null?void 0:k.name)||`Student ${h.studentId}`}),e.jsx("div",{className:"text-sm text-gray-500",children:((A=h.student)==null?void 0:A.email)||"-"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:["â‚¹",h.amount.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:h.dueDate?new Date(h.dueDate).toLocaleDateString():"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:h.paidDate?new Date(h.paidDate).toLocaleDateString():"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${h.status==="paid"?"bg-green-100 text-green-800":h.status==="overdue"?"bg-red-100 text-red-800":h.status==="cancelled"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:h.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("button",{onClick:()=>{d(h),l(!0)},className:"text-orange-600 hover:text-orange-900",children:"Update"})})]},h.id)})})]})})})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Payment"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student *"}),e.jsxs("select",{name:"studentId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a student"}),i.map(h=>e.jsxs("option",{value:h.id,children:[h.name," (",h.email,")"]},h.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),e.jsx("input",{type:"number",name:"amount",required:!0,step:"0.01",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Due Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"dueDate",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{name:"notes",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:b.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:b.isPending?"Creating...":"Create"}),e.jsx("button",{type:"button",onClick:()=>r(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),n&&o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Update Payment"}),e.jsxs("form",{onSubmit:E,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"status",defaultValue:o.status,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paid Date"}),e.jsx("input",{type:"date",name:"paidDate",defaultValue:o.paidDate?new Date(o.paidDate).toISOString().split("T")[0]:"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),e.jsxs("select",{name:"paymentMethod",defaultValue:o.paymentMethod||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select method"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"upi",children:"UPI"}),e.jsx("option",{value:"card",children:"Card"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction ID"}),e.jsx("input",{type:"text",name:"transactionId",defaultValue:o.transactionId||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{name:"notes",rows:3,defaultValue:o.notes||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:c.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:c.isPending?"Updating...":"Update"}),e.jsx("button",{type:"button",onClick:()=>{l(!1),d(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})})]})},Nt={getAllPortfolios:async t=>(await L.get("/portfolios",{params:t})).data,getStudentPortfolio:async t=>(await L.get(`/students/${t}/portfolio`)).data,createPortfolio:async(t,s)=>(await L.post(`/students/${t}/portfolio`,s)).data,approvePortfolio:async(t,s)=>(await L.post(`/portfolio/${t}/approve`,s)).data},Yn=()=>{var Q,ue;const{user:t}=re(),s=le(),[a,r]=N.useState(!1),[n,l]=N.useState(null),[o,d]=N.useState(!1),[m,f]=N.useState([""]),[p,b]=N.useState([""]),[c,u]=N.useState(!1),i=N.useRef(!1),C=N.useRef(!1),{data:E,isLoading:h}=H({queryKey:["portfolios"],queryFn:()=>Nt.getAllPortfolios()}),{data:k}=H({queryKey:["students"],queryFn:()=>Pe.getAllStudents()}),{data:A}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches()}),g=W({mutationFn:({studentId:$,data:_})=>Nt.createPortfolio($,_),onSuccess:()=>{s.invalidateQueries({queryKey:["portfolios"]}),r(!1),alert("Portfolio created successfully!")},onError:$=>{var _,G;alert(((G=(_=$.response)==null?void 0:_.data)==null?void 0:G.message)||"Failed to create portfolio")}}),w=W({mutationFn:({id:$,data:_})=>Nt.approvePortfolio($,_),onSuccess:()=>{s.invalidateQueries({queryKey:["portfolios"]}),d(!1),l(null),alert("Portfolio status updated successfully!")},onError:$=>{var _,G;alert(((G=(_=$.response)==null?void 0:_.data)==null?void 0:G.message)||"Failed to update portfolio")}}),O=(E==null?void 0:E.data.portfolios)||[],q=(k==null?void 0:k.data.students)||[],v=(A==null?void 0:A.data)||[],B=$=>{$.preventDefault();const _=new FormData($.currentTarget),G=m.map(I=>I.trim()).filter(I=>I.length>0),se=p.map(I=>I.trim()).filter(I=>I.length>0);if(G.length===0&&se.length===0){alert("Please provide at least one image or video link");return}const oe=G.length>0?G:void 0,xe=se.length>0?se[0]:void 0,be={batchId:parseInt(_.get("batchId")),files:oe,youtubeUrl:xe};g.mutate({studentId:parseInt(_.get("studentId")),data:be})},D=$=>{$.preventDefault(),$.stopPropagation(),!i.current&&(i.current=!0,f(_=>[..._,""]),setTimeout(()=>{i.current=!1},100))},M=$=>{f(_=>_.filter((G,se)=>se!==$))},P=($,_)=>{f(G=>{const se=[...G];return se[$]=_,se})},T=$=>{$.preventDefault(),$.stopPropagation(),!C.current&&(C.current=!0,b(_=>[..._,""]),setTimeout(()=>{C.current=!1},100))},x=$=>{b(_=>_.filter((G,se)=>se!==$))},R=($,_)=>{b(G=>{const se=[...G];return se[$]=_,se})},y=async $=>{var be,I;const _=$.target.files;if(!_||_.length===0)return;const G=50*1024*1024,se=Array.from(_).filter(z=>z.size>G);if(se.length>0){alert(`Some files exceed 50MB limit: ${se.map(z=>z.name).join(", ")}`);return}const oe=["image/jpeg","image/jpg","image/png","image/gif","image/webp"],xe=Array.from(_).filter(z=>!oe.includes(z.type));if(xe.length>0){alert(`Some files are not valid images: ${xe.map(z=>z.name).join(", ")}`);return}u(!0);try{const z=Array.from(_),de=(await ut.uploadMultipleFiles(z)).data.urls;f(ce=>[...ce,...de]),alert(`${z.length} image(s) uploaded successfully!`)}catch(z){alert(((I=(be=z.response)==null?void 0:be.data)==null?void 0:I.message)||"Failed to upload images")}finally{u(!1),$.target.value=""}},K=$=>{if($.preventDefault(),!n)return;const G={approve:new FormData($.currentTarget).get("approve")==="true"};w.mutate({id:n.id,data:G})};return h?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Portfolio Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Student portfolios"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="student")&&e.jsx("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ Create Portfolio"})]})}),e.jsx("div",{className:"p-6",children:O.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No portfolios found"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.map($=>{var _,G;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:((_=$.student)==null?void 0:_.name)||`Student ${$.studentId}`}),e.jsx("p",{className:"text-sm text-gray-600",children:((G=$.batch)==null?void 0:G.title)||`Batch ${$.batchId}`})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${$.status==="approved"?"bg-green-100 text-green-800":$.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:$.status})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Files:"})," ",Object.keys($.files||{}).length]}),$.approvedAt&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Approved: ",new Date($.approvedAt).toLocaleDateString()]})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"||(t==null?void 0:t.role)==="faculty")&&$.status==="pending"&&e.jsx("button",{onClick:()=>{l($),d(!0)},className:"w-full px-3 py-2 bg-orange-600 text-white rounded text-sm hover:bg-orange-700 transition-colors",children:"Review"})]},$.id)})})})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Portfolio"}),e.jsxs("form",{onSubmit:B,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student *"}),e.jsxs("select",{name:"studentId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a student"}),q.map($=>e.jsxs("option",{value:$.id,children:[$.name," (",$.email,")"]},$.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch *"}),e.jsxs("select",{name:"batchId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a batch"}),v.map($=>e.jsx("option",{value:$.id,children:$.title},$.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Images (Max 50MB per file)"}),e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",multiple:!0,onChange:y,disabled:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50"}),c&&e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Uploading images..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload image files (JPG, PNG, GIF, WebP) - Max 50MB per file"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image Links (or enter URLs manually)"}),m.map(($,_)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"url",value:$,onChange:G=>P(_,G.target.value),placeholder:"https://example.com/image.jpg",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"}),m.length>1&&e.jsx("button",{type:"button",onClick:G=>{G.preventDefault(),G.stopPropagation(),M(_)},className:"px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors",children:"Remove"})]},_)),e.jsx("button",{type:"button",onClick:D,className:"mt-2 px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors",children:"+ Add Image Link"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Or enter image URLs manually"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Video Links (YouTube)"}),p.map(($,_)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"url",value:$,onChange:G=>R(_,G.target.value),placeholder:"https://www.youtube.com/watch?v=...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"}),p.length>1&&e.jsx("button",{type:"button",onClick:G=>{G.preventDefault(),G.stopPropagation(),x(_)},className:"px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors",children:"Remove"})]},_)),e.jsx("button",{type:"button",onClick:T,className:"mt-2 px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors",children:"+ Add Video Link"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter YouTube video URLs"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:g.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:g.isPending?"Creating...":"Create"}),e.jsx("button",{type:"button",onClick:()=>{r(!1),f([""]),b([""])},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),o&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Review Portfolio"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Student:"})," ",((Q=n.student)==null?void 0:Q.name)||`Student ${n.studentId}`]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Batch:"})," ",((ue=n.batch)==null?void 0:ue.title)||`Batch ${n.batchId}`]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Files:"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded max-h-40 overflow-y-auto",children:Object.entries(n.files||{}).map(([$,_])=>e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:e.jsxs("a",{href:_,target:"_blank",rel:"noopener noreferrer",className:"text-orange-600 hover:underline",children:[$,": ",_]})},$))})]})]}),e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action *"}),e.jsxs("select",{name:"approve",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"true",children:"Approve"}),e.jsx("option",{value:"false",children:"Reject"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:w.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:w.isPending?"Updating...":"Submit"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),l(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})})]})},Ke={getStudentsWithoutBatch:async()=>(await L.get("/reports/students-without-batch")).data,getBatchAttendance:async(t,s)=>(await L.get("/reports/batch-attendance",{params:{batchId:t,...s}})).data,getPendingPayments:async()=>(await L.get("/reports/pending-payments")).data,getPortfolioStatus:async()=>(await L.get("/reports/portfolio-status")).data,getAllAnalysisReports:async()=>(await L.get("/reports/all-analysis")).data},Xn=()=>{const[t,s]=N.useState(null),[a,r]=N.useState(null),[n,l]=N.useState(""),[o,d]=N.useState(""),{data:m}=H({queryKey:["batches"],queryFn:()=>ge.getAllBatches()}),{data:f,isLoading:p}=H({queryKey:["reports","students-without-batch"],queryFn:()=>Ke.getStudentsWithoutBatch(),enabled:t==="students-without-batch"}),{data:b,isLoading:c}=H({queryKey:["reports","batch-attendance",a,n,o],queryFn:()=>Ke.getBatchAttendance(a,{from:n||void 0,to:o||void 0}),enabled:t==="batch-attendance"&&a!==null}),{data:u,isLoading:i}=H({queryKey:["reports","pending-payments"],queryFn:()=>Ke.getPendingPayments(),enabled:t==="pending-payments"}),{data:C,isLoading:E}=H({queryKey:["reports","portfolio-status"],queryFn:()=>Ke.getPortfolioStatus(),enabled:t==="portfolio-status"}),{data:h,isLoading:k}=H({queryKey:["reports","all-analysis"],queryFn:()=>Ke.getAllAnalysisReports(),enabled:t==="all-analysis"}),A=(m==null?void 0:m.data)||[];return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Reports"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"View reports"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx("button",{onClick:()=>s("all-analysis"),className:`px-4 py-3 rounded-lg font-semibold transition-colors ${t==="all-analysis"?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Analysis"}),e.jsx("button",{onClick:()=>s("students-without-batch"),className:`px-4 py-3 rounded-lg font-semibold transition-colors ${t==="students-without-batch"?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Students Without Batch"}),e.jsx("button",{onClick:()=>s("batch-attendance"),className:`px-4 py-3 rounded-lg font-semibold transition-colors ${t==="batch-attendance"?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Batch Attendance"}),e.jsx("button",{onClick:()=>s("pending-payments"),className:`px-4 py-3 rounded-lg font-semibold transition-colors ${t==="pending-payments"?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Pending Payments"}),e.jsx("button",{onClick:()=>s("portfolio-status"),className:`px-4 py-3 rounded-lg font-semibold transition-colors ${t==="portfolio-status"?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Portfolio Status"})]}),t==="students-without-batch"&&e.jsx("div",{children:p?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined Date"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f==null?void 0:f.data.students.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.phone||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(g.createdAt).toLocaleDateString()})]},g.id))})]}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:["Total: ",(f==null?void 0:f.data.totalCount)||0," students"]})]})}),t==="batch-attendance"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:a||"",onChange:g=>r(g.target.value?parseInt(g.target.value):null),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select a batch"}),A.map(g=>e.jsx("option",{value:g.id,children:g.title},g.id))]}),e.jsx("input",{type:"date",value:n,onChange:g=>l(g.target.value),placeholder:"From Date",className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("input",{type:"date",value:o,onChange:g=>d(g.target.value),placeholder:"To Date",className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),c?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):b!=null&&b.data?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:b.data.batch.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Total Sessions: ",b.data.totalSessions," | Total Attendances: ",b.data.totalAttendances]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Present"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Absent"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.data.studentStatistics.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:["Student ",g.studentId]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.present}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.absent}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.total}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.attendanceRate})]},g.studentId))})]})})]}):e.jsx("p",{className:"text-gray-500 text-center py-12",children:"Select a batch to view attendance report"})]}),t==="pending-payments"&&e.jsx("div",{children:i?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):u!=null&&u.data?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Total Pending"}),e.jsx("p",{className:"font-semibold",children:u.data.summary.totalPending})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Total Amount"}),e.jsxs("p",{className:"font-semibold",children:["â‚¹",u.data.summary.totalPendingAmount]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Overdue"}),e.jsx("p",{className:"font-semibold",children:u.data.summary.overdue.count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Upcoming"}),e.jsx("p",{className:"font-semibold",children:u.data.summary.upcoming.count})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.data.payments.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.student.name}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:["â‚¹",g.amount.toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(g.dueDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${g.isOverdue?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:g.isOverdue?"Overdue":"Pending"})})]},g.id))})]})})]}):null}),t==="portfolio-status"&&e.jsx("div",{children:E?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):C!=null&&C.data?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Total"}),e.jsx("p",{className:"font-semibold",children:C.data.summary.total})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Pending"}),e.jsx("p",{className:"font-semibold",children:C.data.summary.pending})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Approved"}),e.jsx("p",{className:"font-semibold",children:C.data.summary.approved})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Rejected"}),e.jsx("p",{className:"font-semibold",children:C.data.summary.rejected})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Files"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.data.portfolios.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.student.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g.batch.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${g.status==="approved"?"bg-green-100 text-green-800":g.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:g.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Object.keys(g.files||{}).length})]},g.id))})]})})]}):null}),t==="all-analysis"&&e.jsx("div",{children:k?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):h!=null&&h.data?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Generated at: ",new Date(h.data.generatedAt).toLocaleString()]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Students Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:h.data.summary.students.total})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"With Batch"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:h.data.summary.students.withBatch})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Without Batch"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:h.data.summary.students.withoutBatch})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Batches Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Batches"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:h.data.summary.batches.total})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Batches"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:h.data.summary.batches.active})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Ended Batches"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:h.data.summary.batches.ended})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Sessions Summary"}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:h.data.summary.sessions.total})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Payments Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Payments"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:h.data.summary.payments.total})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:h.data.summary.payments.pending})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Amount"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["â‚¹",h.data.summary.payments.totalAmount.toFixed(2)]})]}),e.jsxs("div",{className:"bg-teal-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Paid Amount"}),e.jsxs("p",{className:"text-lg font-bold text-teal-600",children:["â‚¹",h.data.summary.payments.paidAmount.toFixed(2)]})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Amount"}),e.jsxs("p",{className:"text-lg font-bold text-red-600",children:["â‚¹",h.data.summary.payments.pendingAmount.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Portfolios Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Portfolios"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:h.data.summary.portfolios.total})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:h.data.summary.portfolios.pending})]})]})]})]}):null}),!t&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 text-lg mb-4",children:"Select a report type to view"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Available reports: All Analysis, Students Without Batch, Batch Attendance, Pending Payments, Portfolio Status"})]})]})]})})})},es={getAllChangeRequests:async t=>(await L.get("/change-requests",{params:t})).data,getChangeRequest:async t=>(await L.get(`/change-requests/${t}`)).data,approveChangeRequest:async(t,s)=>(await L.post(`/change-requests/${t}/approve`,s)).data},Zn=()=>{var b;const{user:t}=re(),s=le(),[a,r]=N.useState(null),[n,l]=N.useState(!1),{data:o,isLoading:d}=H({queryKey:["change-requests"],queryFn:()=>es.getAllChangeRequests({status:"pending"})}),m=W({mutationFn:({id:c,data:u})=>es.approveChangeRequest(c,u),onSuccess:()=>{s.invalidateQueries({queryKey:["change-requests"]}),l(!1),r(null),alert("Request processed successfully!")},onError:c=>{var u,i;alert(((i=(u=c.response)==null?void 0:u.data)==null?void 0:i.message)||"Failed to process request")}}),f=(o==null?void 0:o.data.changeRequests)||[],p=c=>{if(c.preventDefault(),!a)return;const u=new FormData(c.currentTarget),i={approve:u.get("approve")==="true",rejectionReason:u.get("rejectionReason")||void 0};m.mutate({id:a.id,data:i})};return d?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Approvals"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage approvals"})]})}),e.jsx("div",{className:"p-6",children:f.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No pending approval requests found"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(c=>{var u;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:c.type.replace("_"," ")}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Student: ",((u=c.student)==null?void 0:u.name)||`Student ${c.studentId}`]}),c.batch&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Batch: ",c.batch.title||`Batch ${c.batchId}`]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${c.status==="approved"?"bg-green-100 text-green-800":c.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:c.status})]}),c.reason&&e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",c.reason]})}),c.requestedData&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Requested Data:"}),e.jsx("div",{className:"bg-gray-50 p-2 rounded text-xs",children:JSON.stringify(c.requestedData,null,2)})]}),e.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Created: ",c.createdAt?new Date(c.createdAt).toLocaleDateString():"-"]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&c.status==="pending"&&e.jsx("button",{onClick:()=>{r(c),l(!0)},className:"w-full px-3 py-2 bg-orange-600 text-white rounded text-sm hover:bg-orange-700 transition-colors",children:"Review"})]},c.id)})})})]})}),n&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Review Request"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",a.type.replace("_"," ")]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Student:"})," ",((b=a.student)==null?void 0:b.name)||`Student ${a.studentId}`]}),a.reason&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",a.reason]})]}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action *"}),e.jsxs("select",{name:"approve",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"true",children:"Approve"}),e.jsx("option",{value:"false",children:"Reject"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejection Reason (if rejecting)"}),e.jsx("textarea",{name:"rejectionReason",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:m.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:m.isPending?"Processing...":"Submit"}),e.jsx("button",{type:"button",onClick:()=>{l(!1),r(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})})]})},at={getUserPermissions:async t=>(await L.get(`/users/${t}/permissions`)).data,updateUserPermissions:async(t,s)=>(await L.put(`/users/${t}/permissions`,s)).data,getModules:async()=>(await L.get("/users/modules/list")).data},ve={getAllRoles:async()=>(await L.get("/roles")).data,getRole:async t=>(await L.get(`/roles/${t}`)).data,createRole:async t=>(await L.post("/roles",t)).data,updateRole:async(t,s)=>(await L.put(`/roles/${t}`,s)).data,deleteRole:async t=>{await L.delete(`/roles/${t}`)},assignRoleToUser:async(t,s)=>(await L.post(`/roles/users/${t}/assign`,s)).data,unassignRoleFromUser:async(t,s)=>{await L.delete(`/roles/users/${t}/roles/${s}`)},getUserRoles:async t=>(await L.get(`/roles/users/${t}/roles`)).data},er=["superadmin","admin","faculty","student","employee"];function tr(t){if(!t)return;const s=t.toLowerCase().trim();return er.includes(s)?s:void 0}function ts(t){return tr(t)}const sr=()=>{var It,Ot;const{user:t}=re(),s=le(),[a,r]=N.useState(null),[n,l]=N.useState(!1),[o,d]=N.useState(!1),[m,f]=N.useState(!1),[p,b]=N.useState(!1),[c,u]=N.useState(!1),[i,C]=N.useState(!1),[E,h]=N.useState(!1),[k,A]=N.useState(!1),[g,w]=N.useState(!1),[O,q]=N.useState(!1),[v,B]=N.useState(null),[D,M]=N.useState([]),[P,T]=N.useState([]),[x,R]=N.useState([]),[y,K]=N.useState([]),[Q,ue]=N.useState([]),[$,_]=N.useState([]),{data:G,isLoading:se,error:oe}=H({queryKey:["users"],queryFn:()=>me.getAllUsers(),retry:1}),xe=W({mutationFn:({id:j,data:F})=>me.updateUser(j,F),onSuccess:()=>{s.invalidateQueries({queryKey:["users"]}),d(!1),r(null),alert("User updated successfully!")},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to update user")}}),be=W({mutationFn:j=>me.deleteUser(j),onSuccess:()=>{s.invalidateQueries({queryKey:["users"]}),f(!1),r(null),alert("User deleted successfully!")},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to delete user")}}),I=W({mutationFn:j=>me.createUser(j),onSuccess:()=>{s.invalidateQueries({queryKey:["users"]}),b(!1),alert("User created successfully!")},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to create user")}}),{data:z}=H({queryKey:["user-permissions",a==null?void 0:a.id],queryFn:()=>at.getUserPermissions(a.id),enabled:!!a&&c}),{data:Z}=H({queryKey:["modules"],queryFn:()=>at.getModules(),enabled:c&&(t==null?void 0:t.role)==="superadmin"}),{data:de}=H({queryKey:["user-roles",a==null?void 0:a.id],queryFn:()=>ve.getUserRoles(a.id),enabled:!!a&&i}),{data:ce}=H({queryKey:["roles"],queryFn:()=>ve.getAllRoles(),enabled:(i||E)&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")}),{data:ke}=H({queryKey:["all-roles"],queryFn:()=>ve.getAllRoles(),enabled:(E||p||o)&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")}),{data:je}=H({queryKey:["role",v==null?void 0:v.id],queryFn:()=>ve.getRole(v.id),enabled:!!v&&g});N.useEffect(()=>{de!=null&&de.data.roles&&R(de.data.roles)},[de]),N.useEffect(()=>{ce!=null&&ce.data.roles&&K(ce.data.roles.filter(j=>j.isActive))},[ce]),N.useEffect(()=>{ke!=null&&ke.data.roles&&ue(ke.data.roles)},[ke]),N.useEffect(()=>{if(je!=null&&je.data.role&&g){const j=je.data.role;if(B(j),j.rolePermissions&&P.length>0){const F=P.map(V=>{var we;const te=(we=j.rolePermissions)==null?void 0:we.find($s=>$s.module===V.value);return{module:V.value,canView:(te==null?void 0:te.canView)||!1,canAdd:(te==null?void 0:te.canAdd)||!1,canEdit:(te==null?void 0:te.canEdit)||!1,canDelete:(te==null?void 0:te.canDelete)||!1}});_(F)}}},[je,g,P]),N.useEffect(()=>{Z!=null&&Z.data.modules&&T(Z.data.modules)},[Z]),N.useEffect(()=>{if(c&&P.length>0&&a){const j=(z==null?void 0:z.data.permissions)||[],F=P.map(V=>{const te=j.find(we=>we.module===V.value);return{id:(te==null?void 0:te.id)||0,userId:a.id,module:V.value,canView:(te==null?void 0:te.canView)||!1,canAdd:(te==null?void 0:te.canAdd)||!1,canEdit:(te==null?void 0:te.canEdit)||!1,canDelete:(te==null?void 0:te.canDelete)||!1}});M(F)}},[c,P,z,a]);const U=W({mutationFn:({userId:j,permissions:F})=>at.updateUserPermissions(j,{permissions:F}),onSuccess:()=>{s.invalidateQueries({queryKey:["user-permissions",a==null?void 0:a.id]}),alert("Permissions updated successfully!"),u(!1)},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to update permissions")}}),Y=W({mutationFn:({userId:j,roleId:F})=>ve.assignRoleToUser(j,{roleId:F}),onSuccess:()=>{s.invalidateQueries({queryKey:["user-roles",a==null?void 0:a.id]}),s.invalidateQueries({queryKey:["users"]}),alert("Role assigned successfully!")},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to assign role")}}),ee=W({mutationFn:({userId:j,roleId:F})=>ve.unassignRoleFromUser(j,F),onSuccess:()=>{s.invalidateQueries({queryKey:["user-roles",a==null?void 0:a.id]}),s.invalidateQueries({queryKey:["users"]}),alert("Role unassigned successfully!")},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to unassign role")}}),Ce=W({mutationFn:j=>ve.createRole(j),onSuccess:()=>{s.invalidateQueries({queryKey:["roles"]}),s.invalidateQueries({queryKey:["all-roles"]}),A(!1),_([]),alert("Role created successfully!")},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to create role")}}),Me=W({mutationFn:({id:j,data:F})=>ve.updateRole(j,F),onSuccess:()=>{s.invalidateQueries({queryKey:["roles"]}),s.invalidateQueries({queryKey:["all-roles"]}),s.invalidateQueries({queryKey:["role",v==null?void 0:v.id]}),w(!1),B(null),_([]),alert("Role updated successfully!")},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to update role")}}),qe=W({mutationFn:j=>ve.deleteRole(j),onSuccess:()=>{s.invalidateQueries({queryKey:["roles"]}),s.invalidateQueries({queryKey:["all-roles"]}),q(!1),B(null),alert("Role deleted successfully!")},onError:j=>{var F,V;alert(((V=(F=j.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to delete role")}}),$e=(G==null?void 0:G.data.users)||[],Je=j=>{r(j),d(!0)},Ge=j=>{r(j),f(!0)},As=j=>{r(j),l(!0)},Ps=j=>{if(j.preventDefault(),!a)return;const F=new FormData(j.currentTarget),V={name:F.get("name")||void 0,email:F.get("email")||void 0,phone:F.get("phone")||void 0,role:ts(F.get("role")),isActive:F.get("isActive")==="true"};xe.mutate({id:a.id,data:V})},Es=()=>{a&&be.mutate(a.id)},Ds=j=>{j.preventDefault();const F=new FormData(j.currentTarget),V=ts(F.get("role"));if(!V){alert("Please select a valid role");return}const te={name:F.get("name"),email:F.get("email"),phone:F.get("phone")||void 0,role:V,password:F.get("password")};I.mutate(te)},Rs=j=>{r(j),u(!0)},Fs=j=>{r(j),C(!0)},Is=j=>{a&&Y.mutate({userId:a.id,roleId:j})},Os=j=>{a&&window.confirm("Are you sure you want to unassign this role?")&&ee.mutate({userId:a.id,roleId:j})},Ye=(j,F,V)=>{M(te=>te.map(we=>we.module===j?{...we,[F]:V}:we))},Ms=()=>{if(!a)return;const j=D.map(F=>({module:F.module,canView:F.canView,canAdd:F.canAdd,canEdit:F.canEdit,canDelete:F.canDelete}));U.mutate({userId:a.id,permissions:j})},qs=j=>{j.preventDefault();const F=new FormData(j.currentTarget),V={name:F.get("name"),description:F.get("description")||void 0,permissions:$};Ce.mutate(V)},Ls=j=>{if(j.preventDefault(),!v)return;const F=new FormData(j.currentTarget),V={name:F.get("name"),description:F.get("description")||void 0,isActive:F.get("isActive")==="true",permissions:$};Me.mutate({id:v.id,data:V})},Ts=j=>{B(j),w(!0)},Bs=j=>{B(j),q(!0)},Us=()=>{v&&qe.mutate(v.id)},Ee=(j,F,V)=>{_(te=>te.map(we=>we.module===j?{...we,[F]:V}:we))};return N.useEffect(()=>{if(k&&P.length>0&&$.length===0){const j=P.map(F=>({module:F.value,canView:!1,canAdd:!1,canEdit:!1,canDelete:!1}));_(j)}},[k,P]),se?e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})}):e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-orange-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"User Management"}),e.jsx("p",{className:"mt-2 text-orange-100",children:"Manage all users in the system"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-white text-orange-600 rounded-lg font-semibold hover:bg-orange-50 transition-colors",children:"+ Create User"}),(t==null?void 0:t.role)==="superadmin"&&e.jsx("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-colors",children:"ðŸŽ­ Manage Roles"})]})]})}),e.jsx("div",{className:"p-6",children:se?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):oe?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600 text-lg mb-4",children:"Error loading users"}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:((Ot=(It=oe==null?void 0:oe.response)==null?void 0:It.data)==null?void 0:Ot.message)||(oe==null?void 0:oe.message)||"Unknown error"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Retry"})]}):$e.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No users found"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$e.map(j=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:j.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:j.phone||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${j.role==="superadmin"?"bg-purple-100 text-purple-800":j.role==="admin"?"bg-blue-100 text-blue-800":j.role==="faculty"?"bg-green-100 text-green-800":j.role==="student"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:j.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${j.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:j.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("button",{onClick:()=>As(j),className:"px-2 py-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:"View Profile",children:"ðŸ‘ï¸ View"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Je(j),className:"px-2 py-1 text-orange-600 hover:text-orange-900 hover:bg-orange-50 rounded transition-colors",title:"Edit User",children:"âœï¸ Edit"}),(t==null?void 0:t.role)==="superadmin"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Rs(j),className:"px-2 py-1 text-purple-600 hover:text-purple-900 hover:bg-purple-50 rounded transition-colors",title:"Manage Permissions",children:"ðŸ” Permissions"}),e.jsx("button",{onClick:()=>Fs(j),className:"px-2 py-1 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 rounded transition-colors",title:"Assign Role",children:"ðŸ‘¤ Roles"}),j.id!==t.id&&e.jsx("button",{onClick:()=>Ge(j),className:"px-2 py-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"Delete User",children:"ðŸ—‘ï¸ Delete"})]})]})]})})]},j.id))})]})})})]})}),n&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"User Profile"}),e.jsx("button",{onClick:()=>{l(!1),r(null)},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.isActive?"Active":"Inactive"})]}),a.createdAt&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created At"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(a.createdAt).toLocaleString()})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>{l(!1),r(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Close"})})]})}),o&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Edit User"}),e.jsxs("form",{onSubmit:Ps,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),e.jsx("input",{type:"text",name:"name",defaultValue:a.name,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",name:"email",defaultValue:a.email,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",defaultValue:a.phone||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),e.jsxs("select",{name:"role",defaultValue:a.role,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"faculty",children:"Faculty"}),e.jsx("option",{value:"employee",children:"Employee"}),e.jsx("option",{value:"admin",children:"Admin"}),(t==null?void 0:t.role)==="superadmin"&&e.jsx("option",{value:"superadmin",children:"Superadmin"}),Q.filter(j=>j.isActive&&!j.isSystem).map(j=>e.jsx("option",{value:j.name.toLowerCase(),children:j.name},j.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),e.jsxs("select",{name:"isActive",defaultValue:a.isActive?"true":"false",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:xe.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:xe.isPending?"Updating...":"Update"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),r(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),m&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Delete User"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["Are you sure you want to delete ",e.jsx("strong",{children:a.name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Es,disabled:be.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors disabled:opacity-50",children:be.isPending?"Deleting...":"Delete"}),e.jsx("button",{onClick:()=>{f(!1),r(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Create New User"}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:Ds,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),e.jsx("input",{type:"text",name:"name",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",name:"email",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),e.jsxs("select",{name:"role",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"faculty",children:"Faculty"}),e.jsx("option",{value:"employee",children:"Employee"}),e.jsx("option",{value:"admin",children:"Admin"}),(t==null?void 0:t.role)==="superadmin"&&e.jsx("option",{value:"superadmin",children:"Superadmin"}),Q.filter(j=>j.isActive&&!j.isSystem).map(j=>e.jsx("option",{value:j.name.toLowerCase(),children:j.name},j.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx("input",{type:"password",name:"password",required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:I.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:I.isPending?"Creating...":"Create User"}),e.jsx("button",{type:"button",onClick:()=>b(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),c&&a&&(t==null?void 0:t.role)==="superadmin"&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Manage Permissions - ",a.name]}),e.jsx("button",{onClick:()=>{u(!1),r(null),M([])},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Customize permissions for ",e.jsx("strong",{children:a.name})," (",a.role,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Module"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"View"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Add"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Edit"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Delete"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(j=>{const F=D.find(V=>V.module===j.value);return F?e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.label})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canView,onChange:V=>Ye(F.module,"canView",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canAdd,onChange:V=>Ye(F.module,"canAdd",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canEdit,onChange:V=>Ye(F.module,"canEdit",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canDelete,onChange:V=>Ye(F.module,"canDelete",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})})]},j.value):null})})]})}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx("button",{onClick:Ms,disabled:U.isPending,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-colors disabled:opacity-50",children:U.isPending?"Saving...":"Save Permissions"}),e.jsx("button",{onClick:()=>{u(!1),r(null),M([])},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})}),i&&a&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Assign Roles - ",a.name]}),e.jsx("button",{onClick:()=>{C(!1),r(null),R([])},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Assigned Roles"}),x.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No roles assigned"}):e.jsx("div",{className:"space-y-2",children:x.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:j.name}),j.description&&e.jsx("p",{className:"text-sm text-gray-500",children:j.description})]}),e.jsx("button",{onClick:()=>Os(j.id),disabled:ee.isPending,className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:"Remove"})]},j.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Available Roles"}),y.filter(j=>!x.find(F=>F.id===j.id)).length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"All available roles are assigned"}):e.jsx("div",{className:"space-y-2",children:y.filter(j=>!x.find(F=>F.id===j.id)).map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:j.name}),j.description&&e.jsx("p",{className:"text-sm text-gray-500",children:j.description})]}),e.jsx("button",{onClick:()=>Is(j.id),disabled:Y.isPending,className:"px-3 py-1 bg-indigo-600 text-white rounded text-sm hover:bg-indigo-700 disabled:opacity-50",children:"Assign"})]},j.id))})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>{C(!1),r(null),R([])},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Close"})})]})}),E&&(t==null?void 0:t.role)==="superadmin"&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Custom Role Management"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>A(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors",children:"+ Create Role"}),e.jsx("button",{onClick:()=>{h(!1),ue([])},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Q.map(j=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.name})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-sm text-gray-500",children:j.description||"-"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${j.isSystem?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:j.isSystem?"System":"Custom"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${j.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:j.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:!j.isSystem&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ts(j),className:"text-orange-600 hover:text-orange-900",title:"Edit Role",children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>Bs(j),className:"text-red-600 hover:text-red-900",title:"Delete Role",children:"ðŸ—‘ï¸ Delete"})]})})]},j.id))})]})})]})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Create Custom Role"}),e.jsx("button",{onClick:()=>{A(!1),_([])},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:qs,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name *"}),e.jsx("input",{type:"text",name:"name",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Permissions"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Module"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"View"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Add"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Edit"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Delete"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(j=>{const F=$.find(V=>V.module===j.value);return F?e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.label})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canView,onChange:V=>Ee(F.module,"canView",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canAdd,onChange:V=>Ee(F.module,"canAdd",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canEdit,onChange:V=>Ee(F.module,"canEdit",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canDelete,onChange:V=>Ee(F.module,"canDelete",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})})]},j.value):null})})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:Ce.isPending,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors disabled:opacity-50",children:Ce.isPending?"Creating...":"Create Role"}),e.jsx("button",{type:"button",onClick:()=>{A(!1),_([])},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),g&&v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Edit Role"}),e.jsx("button",{onClick:()=>{w(!1),B(null),_([])},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:Ls,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name *"}),e.jsx("input",{type:"text",name:"name",defaultValue:v.name,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",rows:3,defaultValue:v.description||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),e.jsxs("select",{name:"isActive",defaultValue:v.isActive?"true":"false",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Permissions"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Module"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"View"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Add"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Edit"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Delete"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(j=>{const F=$.find(V=>V.module===j.value);return F?e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.label})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canView,onChange:V=>Ee(F.module,"canView",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canAdd,onChange:V=>Ee(F.module,"canAdd",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canEdit,onChange:V=>Ee(F.module,"canEdit",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:e.jsx("input",{type:"checkbox",checked:F.canDelete,onChange:V=>Ee(F.module,"canDelete",V.target.checked),className:"w-4 h-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})})]},j.value):null})})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:Me.isPending,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors disabled:opacity-50",children:Me.isPending?"Updating...":"Update Role"}),e.jsx("button",{type:"button",onClick:()=>{w(!1),B(null),_([])},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),O&&v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Delete Role"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["Are you sure you want to delete the role ",e.jsx("strong",{children:v.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"mb-4 text-sm text-yellow-600",children:"Note: You cannot delete a role if it is assigned to any users. Please unassign it first."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Us,disabled:qe.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors disabled:opacity-50",children:qe.isPending?"Deleting...":"Delete"}),e.jsx("button",{onClick:()=>{q(!1),B(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})})]})},ar=()=>{const{user:t}=re(),s=le(),[a,r]=N.useState(null),[n,l]=N.useState(!1),[o,d]=N.useState(!1),[m,f]=N.useState(!1),[p,b]=N.useState(!1),[c,u]=N.useState([]),[i,C]=N.useState([]),{data:E,isLoading:h}=H({queryKey:["roles"],queryFn:()=>ve.getAllRoles(),enabled:(t==null?void 0:t.role)==="superadmin"}),{data:k}=H({queryKey:["modules"],queryFn:()=>at.getModules(),enabled:(t==null?void 0:t.role)==="superadmin"});N.useEffect(()=>{k!=null&&k.data.modules&&C(k.data.modules)},[k]),N.useEffect(()=>{if(n&&i.length>0){const x=i.map(R=>({id:0,roleId:0,module:R.value,canView:!1,canAdd:!1,canEdit:!1,canDelete:!1}));u(x)}},[n,i.length]),N.useEffect(()=>{if((o||p)&&i.length>0&&a){const x=(a==null?void 0:a.rolePermissions)||[],R=i.map(y=>{const K=x.find(Q=>Q.module===y.value);return{id:(K==null?void 0:K.id)||0,roleId:a.id,module:y.value,canView:(K==null?void 0:K.canView)||!1,canAdd:(K==null?void 0:K.canAdd)||!1,canEdit:(K==null?void 0:K.canEdit)||!1,canDelete:(K==null?void 0:K.canDelete)||!1}});u(R)}},[o,p,i,a]);const A=W({mutationFn:x=>ve.createRole(x),onSuccess:()=>{s.invalidateQueries({queryKey:["roles"]}),l(!1),u([]),alert("Role created successfully!"),setTimeout(()=>{if(i.length>0){const x=i.map(R=>({id:0,roleId:0,module:R.value,canView:!1,canAdd:!1,canEdit:!1,canDelete:!1}));u(x)}},100)},onError:x=>{var R,y;alert(((y=(R=x.response)==null?void 0:R.data)==null?void 0:y.message)||"Failed to create role")}}),g=W({mutationFn:({id:x,data:R})=>ve.updateRole(x,R),onSuccess:()=>{s.invalidateQueries({queryKey:["roles"]}),d(!1),b(!1),r(null),u([]),alert("Role updated successfully!")},onError:x=>{var R,y;alert(((y=(R=x.response)==null?void 0:R.data)==null?void 0:y.message)||"Failed to update role")}}),w=W({mutationFn:x=>ve.deleteRole(x),onSuccess:()=>{s.invalidateQueries({queryKey:["roles"]}),f(!1),r(null),alert("Role deleted successfully!")},onError:x=>{var R,y;alert(((y=(R=x.response)==null?void 0:R.data)==null?void 0:y.message)||"Failed to delete role")}}),O=x=>{x.preventDefault();const R=new FormData(x.currentTarget),y=c.map(Q=>({module:Q.module,canView:Q.canView,canAdd:Q.canAdd,canEdit:Q.canEdit,canDelete:Q.canDelete})),K={name:R.get("name"),description:R.get("description")||void 0,permissions:y};A.mutate(K)},q=x=>{if(x.preventDefault(),!a)return;const R=new FormData(x.currentTarget),y=c.map(Q=>({module:Q.module,canView:Q.canView,canAdd:Q.canAdd,canEdit:Q.canEdit,canDelete:Q.canDelete})),K={name:R.get("name")||void 0,description:R.get("description")||void 0,isActive:R.get("isActive")==="true",permissions:y};g.mutate({id:a.id,data:K})},v=(x,R,y)=>{u(K=>K.map(Q=>Q.module===x?{...Q,[R]:y}:Q))},B=x=>{r(x),d(!0)},D=x=>{r(x),b(!0)},M=x=>{r(x),f(!0)},P=()=>{if(!a)return;const x=c.map(R=>({module:R.module,canView:R.canView,canAdd:R.canAdd,canEdit:R.canEdit,canDelete:R.canDelete}));g.mutate({id:a.id,data:{permissions:x}})};if((t==null?void 0:t.role)!=="superadmin")return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"bg-white shadow-xl rounded-lg p-6",children:e.jsx("p",{className:"text-red-600",children:"Access denied. Only superadmin can manage roles."})})})});if(h)return e.jsx(J,{children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})})});const T=(E==null?void 0:E.data.roles)||[];return e.jsxs(J,{children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-purple-500 px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Role Management"}),e.jsx("p",{className:"mt-2 text-purple-100",children:"Create and manage custom roles with permissions"})]}),e.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-white text-purple-600 rounded-lg font-semibold hover:bg-purple-50 transition-colors",children:"+ Create Role"})]})}),e.jsx("div",{className:"p-6",children:T.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No roles found"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(x=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.name})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-500",children:x.description||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${x.isSystem?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:x.isSystem?"System":"Custom"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${x.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>B(x),disabled:x.isSystem,className:"text-orange-600 hover:text-orange-900 disabled:opacity-50 disabled:cursor-not-allowed",title:"Edit Role",children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>D(x),className:"text-purple-600 hover:text-purple-900",title:"Manage Permissions",children:"ðŸ” Permissions"}),e.jsx("button",{onClick:()=>M(x),disabled:x.isSystem,className:"text-red-600 hover:text-red-900 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete Role",children:"ðŸ—‘ï¸ Delete"})]})})]},x.id))})]})})})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Permissions"}),e.jsx("button",{onClick:()=>{l(!1),u([])},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name *"}),e.jsx("input",{type:"text",name:"name",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permissions"}),c.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500 border border-gray-300 rounded-md",children:e.jsx("p",{children:"Loading permissions..."})}):e.jsx("div",{className:"overflow-x-auto border border-gray-300 rounded-md max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Module"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"View"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Add"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Edit"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Delete"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(x=>{var R;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:((R=i.find(y=>y.value===x.module))==null?void 0:R.label)||x.module}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canView,onChange:y=>v(x.module,"canView",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded cursor-pointer"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canAdd,onChange:y=>v(x.module,"canAdd",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded cursor-pointer"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canEdit,onChange:y=>v(x.module,"canEdit",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded cursor-pointer"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canDelete,onChange:y=>v(x.module,"canDelete",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded cursor-pointer"})})]},x.module)})})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:A.isPending||c.length===0,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A.isPending?"Creating...":"Create Role"}),e.jsx("button",{type:"button",onClick:()=>{l(!1),u([])},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),o&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Edit Role"}),e.jsx("button",{onClick:()=>{d(!1),r(null),u([])},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name *"}),e.jsx("input",{type:"text",name:"name",defaultValue:a.name,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",rows:3,defaultValue:a.description||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),e.jsxs("select",{name:"isActive",defaultValue:a.isActive?"true":"false",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permissions"}),e.jsx("div",{className:"overflow-x-auto border border-gray-300 rounded-md",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Module"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"View"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Add"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Edit"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Delete"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(x=>{var R;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:((R=i.find(y=>y.value===x.module))==null?void 0:R.label)||x.module}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canView,onChange:y=>v(x.module,"canView",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canAdd,onChange:y=>v(x.module,"canAdd",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canEdit,onChange:y=>v(x.module,"canEdit",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canDelete,onChange:y=>v(x.module,"canDelete",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})})]},x.module)})})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:g.isPending,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-colors disabled:opacity-50",children:g.isPending?"Updating...":"Update Role"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),r(null),u([])},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}),p&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Manage Permissions - ",a.name]}),e.jsx("button",{onClick:()=>{b(!1),r(null),u([])},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-300 rounded-md mb-4",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Module"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"View"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Add"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Edit"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Delete"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(x=>{var R;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:((R=i.find(y=>y.value===x.module))==null?void 0:R.label)||x.module}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canView,onChange:y=>v(x.module,"canView",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canAdd,onChange:y=>v(x.module,"canAdd",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canEdit,onChange:y=>v(x.module,"canEdit",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:x.canDelete,onChange:y=>v(x.module,"canDelete",y.target.checked),className:"w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})})]},x.module)})})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:P,disabled:g.isPending,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-colors disabled:opacity-50",children:g.isPending?"Saving...":"Save Permissions"}),e.jsx("button",{onClick:()=>{b(!1),r(null),u([])},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})}),m&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Delete Role"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["Are you sure you want to delete ",e.jsx("strong",{children:a.name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{a&&w.mutate(a.id)},disabled:w.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors disabled:opacity-50",children:w.isPending?"Deleting...":"Delete"}),e.jsx("button",{onClick:()=>{f(!1),r(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})})]})},ne=({children:t})=>{const{isAuthenticated:s,loading:a}=re();return a?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):s?e.jsx(e.Fragment,{children:t}):e.jsx(Js,{to:"/login",replace:!0})};function nr(){return e.jsxs(Hs,{children:[e.jsx(ae,{path:"/login",element:e.jsx(An,{})}),e.jsx(ae,{path:"/",element:e.jsx(ne,{children:e.jsx(Xt,{})})}),e.jsx(ae,{path:"/dashboard",element:e.jsx(ne,{children:e.jsx(Xt,{})})}),e.jsx(ae,{path:"/software-completions",element:e.jsx(ne,{children:e.jsx(Pn,{})})}),e.jsx(ae,{path:"/batch-extensions",element:e.jsx(ne,{children:e.jsx(Rn,{})})}),e.jsx(ae,{path:"/batches",element:e.jsx(ne,{children:e.jsx(Mn,{})})}),e.jsx(ae,{path:"/batches/create",element:e.jsx(ne,{children:e.jsx(Ln,{})})}),e.jsx(ae,{path:"/students",element:e.jsx(ne,{children:e.jsx(Un,{})})}),e.jsx(ae,{path:"/students/enroll",element:e.jsx(ne,{children:e.jsx($n,{})})}),e.jsx(ae,{path:"/students/:id/edit",element:e.jsx(ne,{children:e.jsx(Vn,{})})}),e.jsx(ae,{path:"/faculty",element:e.jsx(ne,{children:e.jsx(Tn,{})})}),e.jsx(ae,{path:"/faculty/:id/edit",element:e.jsx(ne,{children:e.jsx(Bn,{})})}),e.jsx(ae,{path:"/faculty/register",element:e.jsx(ne,{children:e.jsx(Qn,{})})}),e.jsx(ae,{path:"/employees",element:e.jsx(ne,{children:e.jsx(Kn,{})})}),e.jsx(ae,{path:"/employees/register",element:e.jsx(ne,{children:e.jsx(_n,{})})}),e.jsx(ae,{path:"/employees/:id/edit",element:e.jsx(ne,{children:e.jsx(zn,{})})}),e.jsx(ae,{path:"/sessions",element:e.jsx(ne,{children:e.jsx(Wn,{})})}),e.jsx(ae,{path:"/attendance",element:e.jsx(ne,{children:e.jsx(Hn,{})})}),e.jsx(ae,{path:"/student-attendance",element:e.jsx(ne,{children:e.jsx(Jn,{})})}),e.jsx(ae,{path:"/payments",element:e.jsx(ne,{children:e.jsx(Gn,{})})}),e.jsx(ae,{path:"/portfolios",element:e.jsx(ne,{children:e.jsx(Yn,{})})}),e.jsx(ae,{path:"/reports",element:e.jsx(ne,{children:e.jsx(Xn,{})})}),e.jsx(ae,{path:"/approvals",element:e.jsx(ne,{children:e.jsx(Zn,{})})}),e.jsx(ae,{path:"/leaves",element:e.jsx(ne,{children:e.jsx(Zt,{})})}),e.jsx(ae,{path:"/student-leaves",element:e.jsx(ne,{children:e.jsx(Zt,{})})}),e.jsx(ae,{path:"/users",element:e.jsx(ne,{children:e.jsx(sr,{})})}),e.jsx(ae,{path:"/roles",element:e.jsx(ne,{children:e.jsx(ar,{})})})]})}function rr(){return e.jsx(Cn,{children:e.jsx(Ws,{children:e.jsx(nr,{})})})}const lr=new Vs({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});vt.createRoot(document.getElementById("root")).render(e.jsx(Ie.StrictMode,{children:e.jsx(Ks,{client:lr,children:e.jsx(rr,{})})}));
